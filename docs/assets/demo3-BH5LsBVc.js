import{S as ne,F as ae,V as M,T as g,k as G,B as oe,n as x,p as se,e as y,m as F,q as re,l as ie,G as le,r as H,f as ce,s as de,g as pe,t as V,h as me,C as ue,u as he,A as we,a as ge,b as fe,P as Se,W as be,v as Me,i as ye}from"./three.module-Dp6ZLe64.js";import{O as ve}from"./OrbitControls---LevtVI.js";import{d as _e,r as Ce,o as Pe,c as xe,f as He}from"./index-D_RN05-O.js";const Fe=_e({__name:"demo3",setup(Ae){const A=Ce();let o,i,m,p=1400,v,u,f,B=[],z,S,b,T,_,L,k,R,E,D,O,d,l;const Z=()=>{const e=i/2/Math.tan(Math.PI/12);u=Math.floor(e-p/2),o=new ne,o.fog=new ae(0,0,1e4),j(),N(),_=-u-p/2,S=_,b=_*2,T=W(S),L=W(b),k=q([new M(-i/10,0,-p/2),new M(-i/4,m/8,0),new M(-i/4,0,u)],400,200),R=q([new M(i/8,m/8,-p/2),new M(i/8,m/8,u)],200,100),E=I(k,2e-4),D=I(R,8e-4,.001),O=J()},j=()=>{new g().load("/demo3/images/sky.png",e=>{e.colorSpace=G;const t=new oe(i,m,p),a=new x({map:e,side:se}),n=new y(t,a);o.add(n)}),new g().load("/demo3/images/ground.png",e=>{e.colorSpace=G;const t=new F(i,400),a=new x({map:e,transparent:!0}),n=new y(t,a);n.position.set(0,-200,0),o.add(n)})},N=()=>{new g().load("/demo3/images/earth_bg.png",e=>{const t=new re(50,64,32),a=new ie({map:e,blendDstAlpha:1}),n=new y(t,a);f=new le,f.position.set(-400,200,-200),f.add(n),o.add(f)})},W=(e,t=50)=>{z=[{color:[.6,1,.75],sprite:new g().load("/demo3/images/starflake1.png"),size:50},{color:[0,0,1],sprite:new g().load("/demo3/images/starflake2.png"),size:20}];const a=[];for(let r=0;r<t;r++){const C=H.randFloatSpread(i),P=Math.random()*m*.5,h=H.randFloatSpread(p*.5)+(u-p*.25);a.push(C,P,h)}const n=new ce;n.setAttribute("position",new de(a,3)),n.computeBoundingSphere();const c=[],s={x:H.randFloatSpread(.3),y:H.randFloatSpread(.3),z:H.randFloatSpread(.3)};return z.forEach(({color:r,sprite:C,size:P},h)=>{B[h]=new pe({size:P,map:C,blending:V,depthTest:!0,transparent:!0,alphaTest:.01}),B[h].color.setHSL(...r);const w=new me(n,B[h]);w.rotation.set(s.x,s.y,s.z),w.position.z=e,c.push(w),o.add(w)}),c},Y=()=>{const e=Date.now()*5e-5;S+=1,b+=1,S>=u+p/2&&(S=_),b>=u+p/2&&(b=_*2),T.forEach(t=>{t.position.setZ(S)}),L.forEach(t=>{t.position.setZ(b)}),B.forEach((t,a)=>{const[n,c,s]=z[a].color,r=(n+e)%1;t.color.setHSL(r,c,s)})},q=(e,t,a)=>{const n=new ue(e,!1),c=new he(n,100,2,50,!1),s=new x({opacity:0,transparent:!0}),r=new y(c,s);o.add(r);const C=new F(t,a),P=new g().load("/demo3/images/cloud.png"),h=new x({map:P,blending:V,depthTest:!1,transparent:!0}),w=new y(C,h);return o.add(w),{cloud:w,curve:n}},I=(e,t,a=6e-4,n=1,c=0)=>{let s=0;return()=>{if(c<n&&(c+=a,e.cloud.scale.setScalar(c)),s>1)s=0,c=0;else if(s+=t,e.curve){const r=e.curve.getPoint(s);r&&r.x&&e.cloud.position.set(r.x,r.y,r.z)}}},J=()=>{const e=new g().load("/demo3/images/login_human.png");e.colorSpace=G;const t=new F(154,190),a=new x({map:e,transparent:!0,alphaTest:.01}),n=new y(t,a);return n.position.set(150,150,0),o.add(n),()=>{const s=Date.now()*.001;n.position.y=Math.sin(s)*20+130}},K=()=>{const e=new we(16777215,1);o.add(e);const t=new ge(415229,5,0);t.position.set(0,100,-200),o.add(t);const a=new fe(t,20);a.visible=!1,o.add(a)},Q=()=>{v=new Se(15,i/m,1,3e4),v.position.set(0,0,u),v.lookAt(new M(0,0,0))},X=()=>{d=new be({antialias:!0,alpha:!0}),d.setSize(i,m),d.shadowMap.enabled=!0,d.shadowMap.type=Me,d.setPixelRatio(window.devicePixelRatio),d.setClearColor(0,.5),d.outputColorSpace=G,A.value.appendChild(d.domElement)},$=()=>{l=new ve(v,d.domElement),l.enableDamping=!0,l.dampingFactor=.05,l.screenSpacePanning=!1,l.maxPolarAngle=Math.PI,l.target.set(0,0,0),l.enabled=!1,l.update()},ee=()=>{const e=new ye(2e3);e.visible=!1,o.add(e)},te=()=>{$(),ee()},U=()=>{requestAnimationFrame(U),l!=null&&l.enableDamping&&l.update(),f&&f.rotateY(.001),Y(),E(),D(),O(),d.render(o,v)};return Pe(()=>{var e,t;i=(e=A.value)==null?void 0:e.clientWidth,m=(t=A.value)==null?void 0:t.clientHeight,Z(),K(),Q(),X(),te(),U(),document.title="登录 - Three.js"}),(e,t)=>(He(),xe("div",{ref_key:"container",ref:A,class:"container"},null,512))}});export{Fe as default};
