var Qd=Object.defineProperty;var Fd=(o,e,t)=>e in o?Qd(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var N=(o,e,t)=>Fd(o,typeof e!="symbol"?e+"":e,t);import{I as Ce,aW as Od,aX as El,ag as Ld,ah as Ua,ai as JA,O as wo,m as Pd,e as Ei,L as ns,aj as ys,y as Si,ab as Vi,Q as Te,al as VA,a as ka,D as KA,am as He,V as xe,an as Gd,ao as _n,ap as Ud,aq as hr,T as xo,ar as kd,d as Yn,as as Nd,at as Bl,au as Hd,av as zd,aw as Jd,ax as Pt,ay as es,R as nn,az as Vd,aA as Cr,g as or,aB as xn,aC as ur,aD as YA,ac as ar,n as gs,aE as Er,f as sn,aF as yl,aG as Na,aH as qA,aI as Kd,h as io,G as qn,P as rn,r as Mt,aJ as XA,aK as WA,aL as Ha,aM as Yd,aN as jA,aO as qd,aP as ts,aQ as za,aR as Ja,aS as Va,aT as ZA,aU as Xd,w as Wd,aV as jd,z as mn,aY as Mo,aZ as Zd,a_ as gt,a$ as ic,b0 as ms,b1 as lr,b2 as Jn,K as Ot,b3 as Ti,b4 as $d,b5 as ef,b6 as tf,b7 as nf,b8 as sf,b9 as rf,ba as of,bb as af,bc as lf,bd as cf,be as $A,bf as vs,bg as kn,bh as Af,bi as hf,bj as uf,bk as Oo,s as Nt,l as no,U as eh,H as Qt,J as Bi,j as uo,bl as th,ae as df,ad as ff,bm as Yt,bn as pf,M as gf,bo as mf,A as vf,bp as _f,bq as Cn,br as ih,bs as Cf,bt as Ef,bu as Bf,bv as yf,a7 as If,x as wf,S as fo,W as xf,bw as nh,bx as Mf,by as Sf,bz as Tf,aa as bf,k as St,bA as Df,bB as Rf,bC as Qf,bD as Xe,bE as So,bF as Ff,p as Nr,bG as Il,ak as Hn,bH as sh,N as Fs,a0 as Of,bI as Lf}from"./three.module-DmlE-t8v.js";import{d as Pf,o as Gf,c as Uf,g as kf,f as Nf}from"./index-BlX74vCs.js";var nc=class{constructor(e,t){N(this,"target");N(this,"name");N(this,"intersected");N(this,"wasIntersected",!1);N(this,"wasIntersectedOnMouseDown",!1);N(this,"distance");this.target=e,this.name=t,this.intersected=!1,this.distance=0}},zt=class{constructor(e,t=null){N(this,"type");N(this,"cancelBubble");N(this,"originalEvent");N(this,"coords",new Ce(0,0));N(this,"distance",0);N(this,"intersected",!1);N(this,"wasIntersected",!1);N(this,"wasIntersectedOnMouseDown",!1);this.cancelBubble=!1,this.type=e,this.originalEvent=t}stopPropagation(){this.cancelBubble=!0}},Hf=class{constructor(o,e,t,i){N(this,"renderer");N(this,"camera");N(this,"domElement");N(this,"bindEventsOnBodyElement");N(this,"autoAdd");N(this,"scene");N(this,"mouse");N(this,"supportsPointerEvents");N(this,"interactiveObjects");N(this,"closestObject");N(this,"raycaster");N(this,"treatTouchEventsAsMouseEvents");N(this,"dispose",()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)});N(this,"add",(o,e=[])=>{if(o&&!this.interactiveObjects.find(t=>t.target===o))if(e.length>0)e.forEach(t=>{let i=o.getObjectByName(t);if(i){let n=new nc(i,t);this.interactiveObjects.push(n)}});else{let t=new nc(o,o.name);this.interactiveObjects.push(t)}});N(this,"remove",(o,e=[])=>{!o||(e.length>0?e.forEach(t=>{let i=o.getObjectByName(t);i&&(this.interactiveObjects=this.interactiveObjects.filter(n=>n.target!==i))}):this.interactiveObjects=this.interactiveObjects.filter(t=>t.target!==o))});N(this,"update",()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(i=>{i.target&&this.checkIntersection(i)}),this.interactiveObjects.sort(function(i,n){return i.distance-n.distance});let o=this.interactiveObjects.find(i=>i.intersected)??null;if(o!=this.closestObject){if(this.closestObject){let i=new zt("mouseout");this.dispatch(this.closestObject,i)}if(o){let i=new zt("mouseover");this.dispatch(o,i)}this.closestObject=o}let e;this.interactiveObjects.forEach(i=>{!i.intersected&&i.wasIntersected&&(e||(e=new zt("mouseleave")),this.dispatch(i,e))});let t;this.interactiveObjects.forEach(i=>{i.intersected&&!i.wasIntersected&&(t||(t=new zt("mouseenter")),this.dispatch(i,t))})});N(this,"checkIntersection",o=>{let e=this.raycaster.intersectObjects([o.target],!0);if(o.wasIntersected=o.intersected,e.length>0){let t=e[0].distance;e.forEach(i=>{i.distance<t&&(t=i.distance)}),o.intersected=!0,o.distance=t}else o.intersected=!1});N(this,"onDocumentMouseMove",o=>{this.mapPositionToPoint(this.mouse,o.clientX,o.clientY);let e=new zt("mousemove",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"onDocumentPointerMove",o=>{this.mapPositionToPoint(this.mouse,o.clientX,o.clientY);let e=new zt("pointermove",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"onTouchMove",o=>{o.touches.length>0&&this.mapPositionToPoint(this.mouse,o.touches[0].clientX,o.touches[0].clientY);let e=new zt(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"onMouseClick",o=>{this.update();let e=new zt("click",o);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});N(this,"onMouseDown",o=>{this.mapPositionToPoint(this.mouse,o.clientX,o.clientY),this.update();let e=new zt("mousedown",o);this.interactiveObjects.forEach(t=>{t.intersected?(t.wasIntersectedOnMouseDown=!0,this.dispatch(t,e)):t.wasIntersectedOnMouseDown=!1})});N(this,"onPointerDown",o=>{this.mapPositionToPoint(this.mouse,o.clientX,o.clientY),this.update();let e=new zt("pointerdown",o);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});N(this,"onTouchStart",o=>{o.touches.length>0&&this.mapPositionToPoint(this.mouse,o.touches[0].clientX,o.touches[0].clientY),this.update();let e=new zt(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",o);this.interactiveObjects.forEach(t=>{t.intersected&&this.dispatch(t,e)})});N(this,"onMouseUp",o=>{let e=new zt("mouseup",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"onPointerUp",o=>{let e=new zt("pointerup",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"onTouchEnd",o=>{o.touches.length>0&&this.mapPositionToPoint(this.mouse,o.touches[0].clientX,o.touches[0].clientY),this.update();let e=new zt(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",o);this.interactiveObjects.forEach(t=>{this.dispatch(t,e)})});N(this,"dispatch",(o,e)=>{o.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=o.distance,e.intersected=o.intersected,e.wasIntersected=o.wasIntersected,e.wasIntersectedOnMouseDown=o.wasIntersectedOnMouseDown,o.target.dispatchEvent(e))});N(this,"mapPositionToPoint",(o,e,t)=>{let i=this.renderer.domElement.getBoundingClientRect();o.x=(e-i.left)/i.width*2-1,o.y=-((t-i.top)/i.height)*2+1});this.renderer=o,this.camera=e,this.domElement=t,this.bindEventsOnBodyElement=i&&typeof i.bindEventsOnBodyElement<"u"?i.bindEventsOnBodyElement:!0,this.scene=i&&typeof i.scene<"u"?i.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&this.scene!==null&&this.scene.traverse(n=>{this.add(n),n.addEventListener("removed",s=>{this.remove(s.target)})}),this.update()}),this.autoAdd=i&&typeof i.autoAdd<"u"?i.autoAdd:!1,this.autoAdd&&this.scene===null&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new Ce(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new Od,t.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):t.addEventListener("pointermove",this.onDocumentPointerMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?t.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):t.addEventListener("mousemove",this.onDocumentMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}};function rh(o){return{all:o=o||new Map,on:function(e,t){var i=o.get(e);i?i.push(t):o.set(e,[t])},off:function(e,t){var i=o.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):o.set(e,[]))},emit:function(e,t){var i=o.get(e);i&&i.slice().map(function(n){n(t)}),(i=o.get("*"))&&i.slice().map(function(n){n(e,t)})}}}class xt{constructor(e){N(this,"base");N(this,"emitter");N(this,"container");this.base=e,this.base.update(t=>this.update(t)),this.emitter=rh(),this.container=this.base.scene}addExisting(){}update(e){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}emit(e,t={}){this.emitter.emit(e,t)}}class zf{constructor(e,t={}){N(this,"base");N(this,"tasks");N(this,"autoRender");const{autoRender:i=!0}=t;this.autoRender=i,this.base=e,this.tasks=[]}add(e){this.tasks.push(e)}update(){this.base.renderer.setAnimationLoop(e=>{this.tick(e)})}tick(e=0){this.tasks.forEach(t=>{t(e)}),this.autoRender&&this.base.render()}}const oh=parseInt(El.replace(/\D+/g,""));function sc(o,e){if(e===Ld)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Ua||e===JA){let t=o.getIndex();if(t===null){const r=[],a=o.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)r.push(c);o.setIndex(r),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const i=t.count-2,n=[];if(t)if(e===Ua)for(let r=1;r<=i;r++)n.push(t.getX(0)),n.push(t.getX(r)),n.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(n.push(t.getX(r)),n.push(t.getX(r+1)),n.push(t.getX(r+2))):(n.push(t.getX(r+2)),n.push(t.getX(r+1)),n.push(t.getX(r)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=o.clone();return s.setIndex(n),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}var gi=Uint8Array,En=Uint16Array,Ka=Uint32Array,ah=new gi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lh=new gi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Jf=new gi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ch=function(o,e){for(var t=new En(31),i=0;i<31;++i)t[i]=e+=1<<o[i-1];for(var n=new Ka(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)n[s]=s-t[i]<<5|i;return[t,n]},Ah=ch(ah,2),hh=Ah[0],Vf=Ah[1];hh[28]=258,Vf[258]=28;var Kf=ch(lh,0),Yf=Kf[0],Ya=new En(32768);for(var it=0;it<32768;++it){var un=(it&43690)>>>1|(it&21845)<<1;un=(un&52428)>>>2|(un&13107)<<2,un=(un&61680)>>>4|(un&3855)<<4,Ya[it]=((un&65280)>>>8|(un&255)<<8)>>>1}var dr=function(o,e,t){for(var i=o.length,n=0,s=new En(e);n<i;++n)++s[o[n]-1];var r=new En(e);for(n=0;n<e;++n)r[n]=r[n-1]+s[n-1]<<1;var a;if(t){a=new En(1<<e);var c=15-e;for(n=0;n<i;++n)if(o[n])for(var h=n<<4|o[n],d=e-o[n],l=r[o[n]-1]++<<d,A=l|(1<<d)-1;l<=A;++l)a[Ya[l]>>>c]=h}else for(a=new En(i),n=0;n<i;++n)o[n]&&(a[n]=Ya[r[o[n]-1]++]>>>15-o[n]);return a},Rr=new gi(288);for(var it=0;it<144;++it)Rr[it]=8;for(var it=144;it<256;++it)Rr[it]=9;for(var it=256;it<280;++it)Rr[it]=7;for(var it=280;it<288;++it)Rr[it]=8;var uh=new gi(32);for(var it=0;it<32;++it)uh[it]=5;var qf=dr(Rr,9,1),Xf=dr(uh,5,1),Lo=function(o){for(var e=o[0],t=1;t<o.length;++t)o[t]>e&&(e=o[t]);return e},yi=function(o,e,t){var i=e/8|0;return(o[i]|o[i+1]<<8)>>(e&7)&t},Po=function(o,e){var t=e/8|0;return(o[t]|o[t+1]<<8|o[t+2]<<16)>>(e&7)},Wf=function(o){return(o/8|0)+(o&7&&1)},jf=function(o,e,t){(t==null||t>o.length)&&(t=o.length);var i=new(o instanceof En?En:o instanceof Ka?Ka:gi)(t-e);return i.set(o.subarray(e,t)),i},Zf=function(o,e,t){var i=o.length;if(!i||t&&!t.l&&i<5)return e||new gi(0);var n=!e||t,s=!t||t.i;t||(t={}),e||(e=new gi(i*3));var r=function(G){var F=e.length;if(G>F){var R=new gi(Math.max(F*2,G));R.set(e),e=R}},a=t.f||0,c=t.p||0,h=t.b||0,d=t.l,l=t.d,A=t.m,u=t.n,f=i*8;do{if(!d){t.f=a=yi(o,c,1);var p=yi(o,c+1,3);if(c+=3,p)if(p==1)d=qf,l=Xf,A=9,u=5;else if(p==2){var C=yi(o,c,31)+257,E=yi(o,c+10,15)+4,_=C+yi(o,c+5,31)+1;c+=14;for(var B=new gi(_),y=new gi(19),x=0;x<E;++x)y[Jf[x]]=yi(o,c+x*3,7);c+=E*3;for(var w=Lo(y),b=(1<<w)-1,P=dr(y,w,1),x=0;x<_;){var O=P[yi(o,c,b)];c+=O&15;var m=O>>>4;if(m<16)B[x++]=m;else{var S=0,D=0;for(m==16?(D=3+yi(o,c,3),c+=2,S=B[x-1]):m==17?(D=3+yi(o,c,7),c+=3):m==18&&(D=11+yi(o,c,127),c+=7);D--;)B[x++]=S}}var Q=B.subarray(0,C),k=B.subarray(C);A=Lo(Q),u=Lo(k),d=dr(Q,A,1),l=dr(k,u,1)}else throw"invalid block type";else{var m=Wf(c)+4,g=o[m-4]|o[m-3]<<8,v=m+g;if(v>i){if(s)throw"unexpected EOF";break}n&&r(h+g),e.set(o.subarray(m,v),h),t.b=h+=g,t.p=c=v*8;continue}if(c>f){if(s)throw"unexpected EOF";break}}n&&r(h+131072);for(var te=(1<<A)-1,W=(1<<u)-1,J=c;;J=c){var S=d[Po(o,c)&te],ee=S>>>4;if(c+=S&15,c>f){if(s)throw"unexpected EOF";break}if(!S)throw"invalid length/literal";if(ee<256)e[h++]=ee;else if(ee==256){J=c,d=null;break}else{var ae=ee-254;if(ee>264){var x=ee-257,j=ah[x];ae=yi(o,c,(1<<j)-1)+hh[x],c+=j}var Ee=l[Po(o,c)&W],Be=Ee>>>4;if(!Ee)throw"invalid distance";c+=Ee&15;var k=Yf[Be];if(Be>3){var j=lh[Be];k+=Po(o,c)&(1<<j)-1,c+=j}if(c>f){if(s)throw"unexpected EOF";break}n&&r(h+131072);for(var H=h+ae;h<H;h+=4)e[h]=e[h-k],e[h+1]=e[h+1-k],e[h+2]=e[h+2-k],e[h+3]=e[h+3-k];h=H}}t.l=d,t.p=J,t.b=h,d&&(a=1,t.m=A,t.d=l,t.n=u)}while(!a);return h==e.length?e:jf(e,0,h)},$f=new gi(0),ep=function(o){if((o[0]&15)!=8||o[0]>>>4>7||(o[0]<<8|o[1])%31)throw"invalid zlib data";if(o[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Hr(o,e){return Zf((ep(o),o.subarray(2,-4)),e)}var tp=typeof TextDecoder<"u"&&new TextDecoder,ip=0;try{tp.decode($f,{stream:!0}),ip=1}catch{}var np=Object.defineProperty,sp=(o,e,t)=>e in o?np(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,Go=(o,e,t)=>(sp(o,typeof e!="symbol"?e+"":e,t),t);class qa{constructor(e){Go(this,"camera",new wo(-1,1,1,-1,0,1)),Go(this,"geometry",new Pd(2,2)),Go(this,"mesh"),this.mesh=new Ei(this.geometry,e)}get material(){return this.mesh.material}set material(e){this.mesh.material=e}dispose(){this.mesh.geometry.dispose()}render(e){e.render(this.mesh,this.camera)}}const rp={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`
    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`
    uniform float opacity;

    uniform sampler2D tDiffuse;

    varying vec2 vUv;

    void main() {

    	vec4 texel = texture2D( tDiffuse, vUv );
    	gl_FragColor = opacity * texel;

    }
  `};function po(o){if(typeof TextDecoder<"u")return new TextDecoder().decode(o);let e="";for(let t=0,i=o.length;t<i;t++)e+=String.fromCharCode(o[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Vn="srgb",on="srgb-linear",rc=3001,op=3e3;class ap extends ns{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new up(t)}),this.register(function(t){return new dp(t)}),this.register(function(t){return new Bp(t)}),this.register(function(t){return new yp(t)}),this.register(function(t){return new Ip(t)}),this.register(function(t){return new pp(t)}),this.register(function(t){return new gp(t)}),this.register(function(t){return new mp(t)}),this.register(function(t){return new vp(t)}),this.register(function(t){return new hp(t)}),this.register(function(t){return new _p(t)}),this.register(function(t){return new fp(t)}),this.register(function(t){return new Ep(t)}),this.register(function(t){return new Cp(t)}),this.register(function(t){return new cp(t)}),this.register(function(t){return new wp(t)}),this.register(function(t){return new xp(t)})}load(e,t,i,n){const s=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const h=ys.extractUrlBase(e);r=ys.resolveURL(h,this.path)}else r=ys.extractUrlBase(e);this.manager.itemStart(e);const a=function(h){n?n(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},c=new Si(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){try{s.parse(h,r,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let s;const r={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(po(new Uint8Array(e.slice(0,4)))===dh){try{r[Qe.KHR_BINARY_GLTF]=new Mp(e)}catch(d){n&&n(d);return}s=JSON.parse(r[Qe.KHR_BINARY_GLTF].content)}else s=JSON.parse(po(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new kp(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const d=this.pluginCallbacks[h](c);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,r[d.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const d=s.extensionsUsed[h],l=s.extensionsRequired||[];switch(d){case Qe.KHR_MATERIALS_UNLIT:r[d]=new Ap;break;case Qe.KHR_DRACO_MESH_COMPRESSION:r[d]=new Sp(s,this.dracoLoader);break;case Qe.KHR_TEXTURE_TRANSFORM:r[d]=new Tp;break;case Qe.KHR_MESH_QUANTIZATION:r[d]=new bp;break;default:l.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(r),c.setPlugins(a),c.parse(i,n)}parseAsync(e,t){const i=this;return new Promise(function(n,s){i.parse(e,t,n,s)})}}function lp(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const Qe={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class cp{constructor(e){this.parser=e,this.name=Qe.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let n=t.cache.get(i);if(n)return n;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const d=new Te(16777215);c.color!==void 0&&d.setRGB(c.color[0],c.color[1],c.color[2],on);const l=c.range!==void 0?c.range:0;switch(c.type){case"directional":h=new KA(d),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new ka(d),h.distance=l;break;case"spot":h=new VA(d),h.distance=l,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,h.angle=c.spot.outerConeAngle,h.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return h.position.set(0,0,0),h.decay=2,$i(h,c),c.intensity!==void 0&&(h.intensity=c.intensity),h.name=t.createUniqueName(c.name||"light_"+e),n=Promise.resolve(h),t.cache.add(i,n),n}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class Ap{constructor(){this.name=Qe.KHR_MATERIALS_UNLIT}getMaterialType(){return gs}extendParams(e,t,i){const n=[];e.color=new Te(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const r=s.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],on),e.opacity=r[3]}s.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",s.baseColorTexture,Vn))}return Promise.all(n)}}class hp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class up{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ce(a,a)}return Promise.all(s)}}class dp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class fp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(s)}}class pp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Te(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=n.extensions[this.name];if(r.sheenColorFactor!==void 0){const a=r.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],on)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,Vn)),r.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(s)}}class gp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(s)}}class mp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new Te().setRGB(a[0],a[1],a[2],on),Promise.all(s)}}class vp{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class _p{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new Te().setRGB(a[0],a[1],a[2],on),r.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,Vn)),Promise.all(s)}}class Cp{constructor(e){this.parser=e,this.name=Qe.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(s)}}class Ep{constructor(e){this.parser=e,this.name=Qe.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Vi}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(s)}}class Bp{constructor(e){this.parser=e,this.name=Qe.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,r)}}class yp{constructor(e){this.parser=e,this.name=Qe.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const r=s.extensions[t],a=n.images[r.source];let c=i.textureLoader;if(a.uri){const h=i.options.manager.getHandler(a.uri);h!==null&&(c=h)}return this.detectSupport().then(function(h){if(h)return i.loadTextureImage(e,r.source,c);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Ip{constructor(e){this.parser=e,this.name=Qe.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const r=s.extensions[t],a=n.images[r.source];let c=i.textureLoader;if(a.uri){const h=i.options.manager.getHandler(a.uri);h!==null&&(c=h)}return this.detectSupport().then(function(h){if(h)return i.loadTextureImage(e,r.source,c);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class wp{constructor(e){this.name=Qe.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const n=i.extensions[this.name],s=this.parser.getDependency("buffer",n.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const c=n.byteOffset||0,h=n.byteLength||0,d=n.count,l=n.byteStride,A=new Uint8Array(a,c,h);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(d,l,A,n.mode,n.filter).then(function(u){return u.buffer}):r.ready.then(function(){const u=new ArrayBuffer(d*l);return r.decodeGltfBuffer(new Uint8Array(u),d,l,A,n.mode,n.filter),u})})}else return null}}class xp{constructor(e){this.name=Qe.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const n=t.meshes[i.mesh];for(const h of n.primitives)if(h.mode!==fi.TRIANGLES&&h.mode!==fi.TRIANGLE_STRIP&&h.mode!==fi.TRIANGLE_FAN&&h.mode!==void 0)return null;const r=i.extensions[this.name].attributes,a=[],c={};for(const h in r)a.push(this.parser.getDependency("accessor",r[h]).then(d=>(c[h]=d,c[h])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(h=>{const d=h.pop(),l=d.isGroup?d.children:[d],A=h[0].count,u=[];for(const f of l){const p=new He,m=new xe,g=new _n,v=new xe(1,1,1),C=new Gd(f.geometry,f.material,A);for(let E=0;E<A;E++)c.TRANSLATION&&m.fromBufferAttribute(c.TRANSLATION,E),c.ROTATION&&g.fromBufferAttribute(c.ROTATION,E),c.SCALE&&v.fromBufferAttribute(c.SCALE,E),C.setMatrixAt(E,p.compose(m,g,v));for(const E in c)if(E==="_COLOR_0"){const _=c[E];C.instanceColor=new Ud(_.array,_.itemSize,_.normalized)}else E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&f.geometry.setAttribute(E,c[E]);hr.prototype.copy.call(C,f),this.parser.assignFinalMaterial(C),u.push(C)}return d.isGroup?(d.clear(),d.add(...u),d):u[0]}))}}const dh="glTF",Ns=12,oc={JSON:1313821514,BIN:5130562};class Mp{constructor(e){this.name=Qe.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Ns);if(this.header={magic:po(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==dh)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-Ns,n=new DataView(e,Ns);let s=0;for(;s<i;){const r=n.getUint32(s,!0);s+=4;const a=n.getUint32(s,!0);if(s+=4,a===oc.JSON){const c=new Uint8Array(e,Ns+s,r);this.content=po(c)}else if(a===oc.BIN){const c=Ns+s;this.body=e.slice(c,c+r)}s+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Sp{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Qe.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},c={},h={};for(const d in r){const l=Xa[d]||d.toLowerCase();a[l]=r[d]}for(const d in e.attributes){const l=Xa[d]||d.toLowerCase();if(r[d]!==void 0){const A=i.accessors[e.attributes[d]],u=Is[A.componentType];h[l]=u.name,c[l]=A.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(l,A){n.decodeDracoFile(d,function(u){for(const f in u.attributes){const p=u.attributes[f],m=c[f];m!==void 0&&(p.normalized=m)}l(u)},a,h,on,A)})})}}class Tp{constructor(){this.name=Qe.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class bp{constructor(){this.name=Qe.KHR_MESH_QUANTIZATION}}class fh extends Xd{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let r=0;r!==n;r++)t[r]=i[s+r];return t}interpolate_(e,t,i,n){const s=this.resultBuffer,r=this.sampleValues,a=this.valueSize,c=a*2,h=a*3,d=n-t,l=(i-t)/d,A=l*l,u=A*l,f=e*h,p=f-h,m=-2*u+3*A,g=u-A,v=1-m,C=g-A+l;for(let E=0;E!==a;E++){const _=r[p+E+a],B=r[p+E+c]*d,y=r[f+E+a],x=r[f+E]*d;s[E]=v*_+C*B+m*y+g*x}return s}}const Dp=new _n;class Rp extends fh{interpolate_(e,t,i,n){const s=super.interpolate_(e,t,i,n);return Dp.fromArray(s).normalize().toArray(s),s}}const fi={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Is={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ac={9728:es,9729:Pt,9984:Jd,9985:zd,9986:Hd,9987:Bl},lc={33071:Cr,33648:Vd,10497:nn},Uo={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Xa={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...oh>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},dn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Qp={CUBICSPLINE:void 0,LINEAR:jA,STEP:Yd},ko={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Fp(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new YA({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ZA})),o.DefaultMaterial}function Fn(o,e,t){for(const i in t.extensions)o[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function $i(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Op(o,e,t){let i=!1,n=!1,s=!1;for(let h=0,d=e.length;h<d;h++){const l=e[h];if(l.POSITION!==void 0&&(i=!0),l.NORMAL!==void 0&&(n=!0),l.COLOR_0!==void 0&&(s=!0),i&&n&&s)break}if(!i&&!n&&!s)return Promise.resolve(o);const r=[],a=[],c=[];for(let h=0,d=e.length;h<d;h++){const l=e[h];if(i){const A=l.POSITION!==void 0?t.getDependency("accessor",l.POSITION):o.attributes.position;r.push(A)}if(n){const A=l.NORMAL!==void 0?t.getDependency("accessor",l.NORMAL):o.attributes.normal;a.push(A)}if(s){const A=l.COLOR_0!==void 0?t.getDependency("accessor",l.COLOR_0):o.attributes.color;c.push(A)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(h){const d=h[0],l=h[1],A=h[2];return i&&(o.morphAttributes.position=d),n&&(o.morphAttributes.normal=l),s&&(o.morphAttributes.color=A),o.morphTargetsRelative=!0,o})}function Lp(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)o.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Pp(o){let e;const t=o.extensions&&o.extensions[Qe.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+No(t.attributes):e=o.indices+":"+No(o.attributes)+":"+o.mode,o.targets!==void 0)for(let i=0,n=o.targets.length;i<n;i++)e+=":"+No(o.targets[i]);return e}function No(o){let e="";const t=Object.keys(o).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+o[t[i]]+";";return e}function Wa(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Gp(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Up=new He;class kp{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new lp,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,s=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||n&&s<98?this.textureLoader=new xo(this.options.manager):this.textureLoader=new kd(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Si(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){const a={scene:r[0][n.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:n.asset,parser:i,userData:{}};return Fn(s,a,n),$i(a,n),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(const c of a.scenes)c.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n].joints;for(let a=0,c=r.length;a<c;a++)e[r[a]].isBone=!0}for(let n=0,s=e.length;n<s;n++){const r=e[n];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const n=i.clone(),s=(r,a)=>{const c=this.associations.get(r);c!=null&&this.associations.set(a,c);for(const[h,d]of r.children.entries())s(d,a.children[h])};return s(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let n=0;n<t.length;n++){const s=e(t[n]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":n=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(s,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Qe.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(s,r){i.load(ys.resolveURL(t.uri,n.path),s,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const n=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+n)})}loadAccessor(e){const t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){const r=Uo[n.type],a=Is[n.componentType],c=n.normalized===!0,h=new a(n.count*r);return Promise.resolve(new Yn(h,r,c))}const s=[];return n.bufferView!==void 0?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),n.sparse!==void 0&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(r){const a=r[0],c=Uo[n.type],h=Is[n.componentType],d=h.BYTES_PER_ELEMENT,l=d*c,A=n.byteOffset||0,u=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,f=n.normalized===!0;let p,m;if(u&&u!==l){const g=Math.floor(A/u),v="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count;let C=t.cache.get(v);C||(p=new h(a,g*u,n.count*u/d),C=new Nd(p,u/d),t.cache.add(v,C)),m=new qd(C,c,A%u/d,f)}else a===null?p=new h(n.count*c):p=new h(a,A,n.count*c),m=new Yn(p,c,f);if(n.sparse!==void 0){const g=Uo.SCALAR,v=Is[n.sparse.indices.componentType],C=n.sparse.indices.byteOffset||0,E=n.sparse.values.byteOffset||0,_=new v(r[1],C,n.sparse.count*g),B=new h(r[2],E,n.sparse.count*c);a!==null&&(m=new Yn(m.array.slice(),m.itemSize,m.normalized));for(let y=0,x=_.length;y<x;y++){const w=_[y];if(m.setX(w,B[y*c]),c>=2&&m.setY(w,B[y*c+1]),c>=3&&m.setZ(w,B[y*c+2]),c>=4&&m.setW(w,B[y*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,r=t.images[s];let a=this.textureLoader;if(r.uri){const c=i.manager.getHandler(r.uri);c!==null&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const n=this,s=this.json,r=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[c])return this.textureCache[c];const h=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=r.name||a.name||"",d.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(d.name=a.uri);const A=(s.samplers||{})[r.sampler]||{};return d.magFilter=ac[A.magFilter]||Pt,d.minFilter=ac[A.minFilter]||Bl,d.wrapS=lc[A.wrapS]||nn,d.wrapT=lc[A.wrapT]||nn,n.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[c]=h,h}loadImageSource(e,t){const i=this,n=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(l=>l.clone());const r=n.images[e],a=self.URL||self.webkitURL;let c=r.uri||"",h=!1;if(r.bufferView!==void 0)c=i.getDependency("bufferView",r.bufferView).then(function(l){h=!0;const A=new Blob([l],{type:r.mimeType});return c=a.createObjectURL(A),c});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(c).then(function(l){return new Promise(function(A,u){let f=A;t.isImageBitmapLoader===!0&&(f=function(p){const m=new ts(p);m.needsUpdate=!0,A(m)}),t.load(ys.resolveURL(l,s.path),f,void 0,u)})}).then(function(l){return h===!0&&a.revokeObjectURL(c),$i(l,r),l.userData.mimeType=r.mimeType||Gp(r.uri),l}).catch(function(l){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),l});return this.sourceCache[e]=d,d}assignTexture(e,t,i,n){const s=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),s.extensions[Qe.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[Qe.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(r);r=s.extensions[Qe.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),s.associations.set(r,c)}}return n!==void 0&&(typeof n=="number"&&(n=n===rc?Vn:on),"colorSpace"in r?r.colorSpace=n:r.encoding=n===Vn?rc:op),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const n=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new or,xn.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new ur,xn.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(n||s||r){let a="ClonedMaterial:"+i.uuid+":";n&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),s&&(c.vertexColors=!0),r&&(c.flatShading=!0),n&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return YA}loadMaterial(e){const t=this,i=this.json,n=this.extensions,s=i.materials[e];let r;const a={},c=s.extensions||{},h=[];if(c[Qe.KHR_MATERIALS_UNLIT]){const l=n[Qe.KHR_MATERIALS_UNLIT];r=l.getMaterialType(),h.push(l.extendParams(a,s,t))}else{const l=s.pbrMetallicRoughness||{};if(a.color=new Te(1,1,1),a.opacity=1,Array.isArray(l.baseColorFactor)){const A=l.baseColorFactor;a.color.setRGB(A[0],A[1],A[2],on),a.opacity=A[3]}l.baseColorTexture!==void 0&&h.push(t.assignTexture(a,"map",l.baseColorTexture,Vn)),a.metalness=l.metallicFactor!==void 0?l.metallicFactor:1,a.roughness=l.roughnessFactor!==void 0?l.roughnessFactor:1,l.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(a,"metalnessMap",l.metallicRoughnessTexture)),h.push(t.assignTexture(a,"roughnessMap",l.metallicRoughnessTexture))),r=this._invokeOne(function(A){return A.getMaterialType&&A.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(A){return A.extendMaterialParams&&A.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=ar);const d=s.alphaMode||ko.OPAQUE;if(d===ko.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,d===ko.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&r!==gs&&(h.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ce(1,1),s.normalTexture.scale!==void 0)){const l=s.normalTexture.scale;a.normalScale.set(l,l)}if(s.occlusionTexture!==void 0&&r!==gs&&(h.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&r!==gs){const l=s.emissiveFactor;a.emissive=new Te().setRGB(l[0],l[1],l[2],on)}return s.emissiveTexture!==void 0&&r!==gs&&h.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Vn)),Promise.all(h).then(function(){const l=new r(a);return s.name&&(l.name=s.name),$i(l,s),t.associations.set(l,{materials:e}),s.extensions&&Fn(n,l,s),l})}createUniqueName(e){const t=Er.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,n=this.primitiveCache;function s(a){return i[Qe.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return cc(c,a,t)})}const r=[];for(let a=0,c=e.length;a<c;a++){const h=e[a],d=Pp(h),l=n[d];if(l)r.push(l.promise);else{let A;h.extensions&&h.extensions[Qe.KHR_DRACO_MESH_COMPRESSION]?A=s(h):A=cc(new sn,h,t),n[d]={primitive:h,promise:A},r.push(A)}}return Promise.all(r)}loadMesh(e){const t=this,i=this.json,n=this.extensions,s=i.meshes[e],r=s.primitives,a=[];for(let c=0,h=r.length;c<h;c++){const d=r[c].material===void 0?Fp(this.cache):this.getDependency("material",r[c].material);a.push(d)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(c){const h=c.slice(0,c.length-1),d=c[c.length-1],l=[];for(let u=0,f=d.length;u<f;u++){const p=d[u],m=r[u];let g;const v=h[u];if(m.mode===fi.TRIANGLES||m.mode===fi.TRIANGLE_STRIP||m.mode===fi.TRIANGLE_FAN||m.mode===void 0)g=s.isSkinnedMesh===!0?new yl(p,v):new Ei(p,v),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),m.mode===fi.TRIANGLE_STRIP?g.geometry=sc(g.geometry,JA):m.mode===fi.TRIANGLE_FAN&&(g.geometry=sc(g.geometry,Ua));else if(m.mode===fi.LINES)g=new Na(p,v);else if(m.mode===fi.LINE_STRIP)g=new qA(p,v);else if(m.mode===fi.LINE_LOOP)g=new Kd(p,v);else if(m.mode===fi.POINTS)g=new io(p,v);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(g.geometry.morphAttributes).length>0&&Lp(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),$i(g,s),m.extensions&&Fn(n,g,m),t.assignFinalMaterial(g),l.push(g)}for(let u=0,f=l.length;u<f;u++)t.associations.set(l[u],{meshes:e,primitives:u});if(l.length===1)return s.extensions&&Fn(n,l[0],s),l[0];const A=new qn;s.extensions&&Fn(n,A,s),t.associations.set(A,{meshes:e});for(let u=0,f=l.length;u<f;u++)A.add(l[u]);return A})}loadCamera(e){let t;const i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new rn(Mt.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new wo(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),$i(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let n=0,s=t.joints.length;n<s;n++)i.push(this._loadNodeShallow(t.joints[n]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(n){const s=n.pop(),r=n,a=[],c=[];for(let h=0,d=r.length;h<d;h++){const l=r[h];if(l){a.push(l);const A=new He;s!==null&&A.fromArray(s.array,h*16),c.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new XA(a,c)})}loadAnimation(e){const t=this.json,i=this,n=t.animations[e],s=n.name?n.name:"animation_"+e,r=[],a=[],c=[],h=[],d=[];for(let l=0,A=n.channels.length;l<A;l++){const u=n.channels[l],f=n.samplers[u.sampler],p=u.target,m=p.node,g=n.parameters!==void 0?n.parameters[f.input]:f.input,v=n.parameters!==void 0?n.parameters[f.output]:f.output;p.node!==void 0&&(r.push(this.getDependency("node",m)),a.push(this.getDependency("accessor",g)),c.push(this.getDependency("accessor",v)),h.push(f),d.push(p))}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c),Promise.all(h),Promise.all(d)]).then(function(l){const A=l[0],u=l[1],f=l[2],p=l[3],m=l[4],g=[];for(let v=0,C=A.length;v<C;v++){const E=A[v],_=u[v],B=f[v],y=p[v],x=m[v];if(E===void 0)continue;E.updateMatrix&&E.updateMatrix();const w=i._createAnimationTracks(E,_,B,y,x);if(w)for(let b=0;b<w.length;b++)g.push(w[b])}return new WA(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(s){const r=i._getNodeRef(i.meshCache,n.mesh,s);return n.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let c=0,h=n.weights.length;c<h;c++)a.morphTargetInfluences[c]=n.weights[c]}),r})}loadNode(e){const t=this.json,i=this,n=t.nodes[e],s=i._loadNodeShallow(e),r=[],a=n.children||[];for(let h=0,d=a.length;h<d;h++)r.push(i.getDependency("node",a[h]));const c=n.skin===void 0?Promise.resolve(null):i.getDependency("skin",n.skin);return Promise.all([s,Promise.all(r),c]).then(function(h){const d=h[0],l=h[1],A=h[2];A!==null&&d.traverse(function(u){u.isSkinnedMesh&&u.bind(A,Up)});for(let u=0,f=l.length;u<f;u++)d.add(l[u]);return d})}_loadNodeShallow(e){const t=this.json,i=this.extensions,n=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],r=s.name?n.createUniqueName(s.name):"",a=[],c=n._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return c&&a.push(c),s.camera!==void 0&&a.push(n.getDependency("camera",s.camera).then(function(h){return n._getNodeRef(n.cameraCache,s.camera,h)})),n._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)}),this.nodeCache[e]=Promise.all(a).then(function(h){let d;if(s.isBone===!0?d=new Ha:h.length>1?d=new qn:h.length===1?d=h[0]:d=new hr,d!==h[0])for(let l=0,A=h.length;l<A;l++)d.add(h[l]);if(s.name&&(d.userData.name=s.name,d.name=r),$i(d,s),s.extensions&&Fn(i,d,s),s.matrix!==void 0){const l=new He;l.fromArray(s.matrix),d.applyMatrix4(l)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return n.associations.has(d)||n.associations.set(d,{}),n.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],n=this,s=new qn;i.name&&(s.name=n.createUniqueName(i.name)),$i(s,i),i.extensions&&Fn(t,s,i);const r=i.nodes||[],a=[];for(let c=0,h=r.length;c<h;c++)a.push(n.getDependency("node",r[c]));return Promise.all(a).then(function(c){for(let d=0,l=c.length;d<l;d++)s.add(c[d]);const h=d=>{const l=new Map;for(const[A,u]of n.associations)(A instanceof xn||A instanceof ts)&&l.set(A,u);return d.traverse(A=>{const u=n.associations.get(A);u!=null&&l.set(A,u)}),l};return n.associations=h(s),s})}_createAnimationTracks(e,t,i,n,s){const r=[],a=e.name?e.name:e.uuid,c=[];dn[s.path]===dn.weights?e.traverse(function(A){A.morphTargetInfluences&&c.push(A.name?A.name:A.uuid)}):c.push(a);let h;switch(dn[s.path]){case dn.weights:h=Ja;break;case dn.rotation:h=Va;break;case dn.position:case dn.scale:h=za;break;default:switch(i.itemSize){case 1:h=Ja;break;case 2:case 3:default:h=za;break}break}const d=n.interpolation!==void 0?Qp[n.interpolation]:jA,l=this._getArrayFromAccessor(i);for(let A=0,u=c.length;A<u;A++){const f=new h(c[A]+"."+dn[s.path],t.array,l,d);n.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(f),r.push(f)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=Wa(t.constructor),n=new Float32Array(t.length);for(let s=0,r=t.length;s<r;s++)n[s]=t[s]*i;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const n=this instanceof Va?Rp:fh;return new n(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Np(o,e,t){const i=e.attributes,n=new Wd;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],c=a.min,h=a.max;if(c!==void 0&&h!==void 0){if(n.set(new xe(c[0],c[1],c[2]),new xe(h[0],h[1],h[2])),a.normalized){const d=Wa(Is[a.componentType]);n.min.multiplyScalar(d),n.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new xe,c=new xe;for(let h=0,d=s.length;h<d;h++){const l=s[h];if(l.POSITION!==void 0){const A=t.json.accessors[l.POSITION],u=A.min,f=A.max;if(u!==void 0&&f!==void 0){if(c.setX(Math.max(Math.abs(u[0]),Math.abs(f[0]))),c.setY(Math.max(Math.abs(u[1]),Math.abs(f[1]))),c.setZ(Math.max(Math.abs(u[2]),Math.abs(f[2]))),A.normalized){const p=Wa(Is[A.componentType]);c.multiplyScalar(p)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(a)}o.boundingBox=n;const r=new jd;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,o.boundingSphere=r}function cc(o,e,t){const i=e.attributes,n=[];function s(r,a){return t.getDependency("accessor",r).then(function(c){o.setAttribute(a,c)})}for(const r in i){const a=Xa[r]||r.toLowerCase();a in o.attributes||n.push(s(i[r],a))}if(e.indices!==void 0&&!o.index){const r=t.getDependency("accessor",e.indices).then(function(a){o.setIndex(a)});n.push(r)}return $i(o,e),Np(o,e,t),Promise.all(n).then(function(){return e.targets!==void 0?Op(o,e.targets,t):o})}var Hp=Object.defineProperty,zp=(o,e,t)=>e in o?Hp(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,Ho=(o,e,t)=>(zp(o,typeof e!="symbol"?e+"":e,t),t);class Jp extends ns{constructor(e){super(e)}load(e,t,i,n){const s=new Si(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,r=>{if(typeof r!="string")throw new Error("unsupported data type");const a=JSON.parse(r),c=this.parse(a);t&&t(c)},i,n)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new Vp(e)}}class Vp{constructor(e){Ho(this,"data"),Ho(this,"isFont",!0),Ho(this,"type","Font"),this.data=e}generateShapes(e,t=100,i){const n=[],s={letterSpacing:0,lineHeight:1,...i},r=Kp(e,t,this.data,s);for(let a=0,c=r.length;a<c;a++)Array.prototype.push.apply(n,r[a].toShapes(!1));return n}}function Kp(o,e,t,i){const n=Array.from(o),s=e/t.resolution,r=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*s,a=[];let c=0,h=0;for(let d=0;d<n.length;d++){const l=n[d];if(l===`
`)c=0,h-=r*i.lineHeight;else{const A=Yp(l,s,c,h,t);A&&(c+=A.offsetX+i.letterSpacing,a.push(A.path))}}return a}function Yp(o,e,t,i,n){const s=n.glyphs[o]||n.glyphs["?"];if(!s){console.error('THREE.Font: character "'+o+'" does not exists in font family '+n.familyName+".");return}const r=new mn;let a,c,h,d,l,A,u,f;if(s.o){const p=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let m=0,g=p.length;m<g;)switch(p[m++]){case"m":a=parseInt(p[m++])*e+t,c=parseInt(p[m++])*e+i,r.moveTo(a,c);break;case"l":a=parseInt(p[m++])*e+t,c=parseInt(p[m++])*e+i,r.lineTo(a,c);break;case"q":h=parseInt(p[m++])*e+t,d=parseInt(p[m++])*e+i,l=parseInt(p[m++])*e+t,A=parseInt(p[m++])*e+i,r.quadraticCurveTo(l,A,h,d);break;case"b":h=parseInt(p[m++])*e+t,d=parseInt(p[m++])*e+i,l=parseInt(p[m++])*e+t,A=parseInt(p[m++])*e+i,u=parseInt(p[m++])*e+t,f=parseInt(p[m++])*e+i,r.bezierCurveTo(l,A,u,f,h,d);break}}return{offsetX:s.ha*e,path:r}}class qp extends ts{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=es,this.minFilter=es,this.wrapR=Cr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Xp{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:n,msg:s,transfer:r}=this.queue.shift();this.workersResolve[e]=n,this.workers[e].postMessage(s,r)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const n=this._getIdleWorker();n!==-1?(this._initWorker(n),this.workerStatus|=1<<n,this.workersResolve[n]=i,this.workers[n].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const ph=0,Ac=2,Wp=0,jp=0,Zp=2,$p=0,eg=0,tg=1,ja=2,ig=0,gh=1,ng=10,sg=64,mh=0,vh=9,_h=15,Ch=16,Eh=22,Bh=37,yh=43,Ih=76,wh=83,xh=97,Mh=100,Sh=103,Th=109,bh=165,Dh=166;class rg{constructor(){this.vkFormat=mh,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=ph,this.levels=[],this.dataFormatDescriptor=[{vendorId:jp,descriptorType:Wp,descriptorBlockSize:0,versionNumber:Zp,colorModel:$p,colorPrimaries:gh,transferFunction:ja,flags:eg,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Hs{constructor(e,t,i,n){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=n,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian),t=this._dataView.getUint32(this._offset+4,this._littleEndian),i=e+2**32*t;return this._offset+=8,i}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t){t===void 0&&(t=0);const i=this._offset;let n=0;for(;this._dataView.getUint8(this._offset)!==t&&n<e;)n++,this._offset++;return n<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,n)}}const kt=[171,75,84,88,32,50,48,187,13,10,26,10];function hc(o){return typeof TextDecoder<"u"?new TextDecoder().decode(o):Buffer.from(o).toString("utf8")}function og(o){const e=new Uint8Array(o.buffer,o.byteOffset,kt.length);if(e[0]!==kt[0]||e[1]!==kt[1]||e[2]!==kt[2]||e[3]!==kt[3]||e[4]!==kt[4]||e[5]!==kt[5]||e[6]!==kt[6]||e[7]!==kt[7]||e[8]!==kt[8]||e[9]!==kt[9]||e[10]!==kt[10]||e[11]!==kt[11])throw new Error("Missing KTX 2.0 identifier.");const t=new rg,i=17*Uint32Array.BYTES_PER_ELEMENT,n=new Hs(o,kt.length,i,!0);t.vkFormat=n._nextUint32(),t.typeSize=n._nextUint32(),t.pixelWidth=n._nextUint32(),t.pixelHeight=n._nextUint32(),t.pixelDepth=n._nextUint32(),t.layerCount=n._nextUint32(),t.faceCount=n._nextUint32();const s=n._nextUint32();t.supercompressionScheme=n._nextUint32();const r=n._nextUint32(),a=n._nextUint32(),c=n._nextUint32(),h=n._nextUint32(),d=n._nextUint64(),l=n._nextUint64(),A=s*3*8,u=new Hs(o,kt.length+i,A,!0);for(let ee=0;ee<s;ee++)t.levels.push({levelData:new Uint8Array(o.buffer,o.byteOffset+u._nextUint64(),u._nextUint64()),uncompressedByteLength:u._nextUint64()});const f=new Hs(o,r,a,!0),p={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},v=(p.descriptorBlockSize/4-6)/4;for(let ee=0;ee<v;ee++){const ae={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};ae.channelType&sg?(ae.sampleLower=f._nextInt32(),ae.sampleUpper=f._nextInt32()):(ae.sampleLower=f._nextUint32(),ae.sampleUpper=f._nextUint32()),p.samples[ee]=ae}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(p);const C=new Hs(o,c,h,!0);for(;C._offset<h;){const ee=C._nextUint32(),ae=C._scan(ee),j=hc(ae);if(t.keyValue[j]=C._nextUint8Array(ee-ae.byteLength-1),j.match(/^ktx/i)){const Be=hc(t.keyValue[j]);t.keyValue[j]=Be.substring(0,Be.lastIndexOf("\0"))}const Ee=ee%4?4-ee%4:0;C._skip(Ee)}if(l<=0)return t;const E=new Hs(o,d,l,!0),_=E._nextUint16(),B=E._nextUint16(),y=E._nextUint32(),x=E._nextUint32(),w=E._nextUint32(),b=E._nextUint32(),P=[];for(let ee=0;ee<s;ee++)P.push({imageFlags:E._nextUint32(),rgbSliceByteOffset:E._nextUint32(),rgbSliceByteLength:E._nextUint32(),alphaSliceByteOffset:E._nextUint32(),alphaSliceByteLength:E._nextUint32()});const O=d+E._offset,S=O+y,D=S+x,Q=D+w,k=new Uint8Array(o.buffer,o.byteOffset+O,y),te=new Uint8Array(o.buffer,o.byteOffset+S,x),W=new Uint8Array(o.buffer,o.byteOffset+D,w),J=new Uint8Array(o.buffer,o.byteOffset+Q,b);return t.globalData={endpointCount:_,selectorCount:B,imageDescs:P,endpointsData:k,selectorsData:te,tablesData:W,extendedData:J},t}let zs,Zi,Za;const zo={env:{emscripten_notify_memory_growth:function(o){Za=new Uint8Array(Zi.exports.memory.buffer)}}};class ag{init(){return zs||(typeof fetch<"u"?zs=fetch("data:application/wasm;base64,"+uc).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,zo)).then(this._init):zs=WebAssembly.instantiate(Buffer.from(uc,"base64"),zo).then(this._init),zs)}_init(e){Zi=e.instance,zo.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Zi)throw new Error("ZSTDDecoder: Await .init() before decoding.");const i=e.byteLength,n=Zi.exports.malloc(i);Za.set(e,n),t=t||Number(Zi.exports.ZSTD_findDecompressedSize(n,i));const s=Zi.exports.malloc(t),r=Zi.exports.ZSTD_decompress(s,t,n,i),a=Za.slice(s,s+r);return Zi.exports.free(n),Zi.exports.free(s),a}}const uc="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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";class lg extends Mo{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,Zd),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class cg extends Mo{constructor(e,t,i,n,s,r){super(e,t,i,s,r),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=Cr}}var Ag=Object.defineProperty,hg=(o,e,t)=>e in o?Ag(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,zr=(o,e,t)=>(hg(o,typeof e!="symbol"?e+"":e,t),t);const Rh=3e3,Qh=3001,dc="",ug="display-p3",dg="display-p3-linear",fg="srgb-linear",wl="srgb",Jo=new WeakMap;let Vo=0,Ko;const pg=(()=>{const o=class extends ns{constructor(t){super(t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new Xp,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(t){return this.transcoderPath=t,this}setWorkerLimit(t){return this.workerPool.setWorkerLimit(t),this}detectSupport(t){return this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},t.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const t=new Si(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);const i=t.loadAsync("basis_transcoder.js"),n=new Si(this.manager);n.setPath(this.transcoderPath),n.setResponseType("arraybuffer"),n.setWithCredentials(this.withCredentials);const s=n.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([i,s]).then(([r,a])=>{const c=o.BasisWorker.toString(),h=["/* constants */","let _EngineFormat = "+JSON.stringify(o.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(o.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(o.BasisFormat),"/* basis_transcoder.js */",r,"/* worker */",c.substring(c.indexOf("{")+1,c.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([h])),this.transcoderBinary=a,this.workerPool.setWorkerCreator(()=>{const d=new Worker(this.workerSourceURL),l=this.transcoderBinary.slice(0);return d.postMessage({type:"init",config:this.workerConfig,transcoderBinary:l},[l]),d})}),Vo>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Vo++}return this.transcoderPending}load(t,i,n,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const r=new Si(this.manager);r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials),r.load(t,a=>{if(Jo.has(a))return Jo.get(a).promise.then(i).catch(s);this._createTexture(a).then(c=>i?i(c):null).catch(s)},n,s)}_createTextureFrom(t,i){const{faces:n,width:s,height:r,format:a,type:c,error:h,dfdFlags:d}=t;if(c==="error")return Promise.reject(h);let l;if(i.faceCount===6)l=new lg(n,a,gt);else{const u=n[0].mipmaps;l=i.layerCount>1?new cg(u,s,r,i.layerCount,a,gt):new Mo(u,s,r,a,gt)}l.minFilter=n[0].mipmaps.length===1?Pt:Bl,l.magFilter=Pt,l.generateMipmaps=!1,l.needsUpdate=!0;const A=Fh(i);return"colorSpace"in l?l.colorSpace=A:l.encoding=A===wl?Qh:Rh,l.premultiplyAlpha=!!(d&tg),l}async _createTexture(t,i={}){const n=og(new Uint8Array(t));if(n.vkFormat!==mh)return mg(n);const s=i,r=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:t,taskConfig:s},[t])).then(a=>this._createTextureFrom(a.data,n));return Jo.set(t,{promise:r}),r}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Vo--,this}};let e=o;return zr(e,"BasisFormat",{ETC1S:0,UASTC_4x4:1}),zr(e,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16}),zr(e,"EngineFormat",{RGBAFormat:Jn,RGBA_ASTC_4x4_Format:cf,RGBA_BPTC_Format:lf,RGBA_ETC2_EAC_Format:af,RGBA_PVRTC_4BPPV1_Format:of,RGBA_S3TC_DXT5_Format:rf,RGB_ETC1_Format:sf,RGB_ETC2_Format:nf,RGB_PVRTC_4BPPV1_Format:tf,RGB_S3TC_DXT1_Format:ef}),zr(e,"BasisWorker",function(){let t,i,n;const s=_EngineFormat,r=_TranscoderFormat,a=_BasisFormat;self.addEventListener("message",function(m){const g=m.data;switch(g.type){case"init":t=g.config,c(g.transcoderBinary);break;case"transcode":i.then(()=>{try{const{faces:v,buffers:C,width:E,height:_,hasAlpha:B,format:y,dfdFlags:x}=h(g.buffer);self.postMessage({type:"transcode",id:g.id,faces:v,width:E,height:_,hasAlpha:B,format:y,dfdFlags:x},C)}catch(v){console.error(v),self.postMessage({type:"error",id:g.id,error:v.message})}});break}});function c(m){i=new Promise(g=>{n={wasmBinary:m,onRuntimeInitialized:g},BASIS(n)}).then(()=>{n.initializeBasis(),n.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function h(m){const g=new n.KTX2File(new Uint8Array(m));function v(){g.close(),g.delete()}if(!g.isValid())throw v(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const C=g.isUASTC()?a.UASTC_4x4:a.ETC1S,E=g.getWidth(),_=g.getHeight(),B=g.getLayers()||1,y=g.getLevels(),x=g.getFaces(),w=g.getHasAlpha(),b=g.getDFDFlags(),{transcoderFormat:P,engineFormat:O}=u(C,E,_,w);if(!E||!_||!y)throw v(),new Error("THREE.KTX2Loader:	Invalid texture");if(!g.startTranscoding())throw v(),new Error("THREE.KTX2Loader: .startTranscoding failed");const S=[],D=[];for(let Q=0;Q<x;Q++){const k=[];for(let te=0;te<y;te++){const W=[];let J,ee;for(let j=0;j<B;j++){const Ee=g.getImageLevelInfo(te,j,Q);Q===0&&te===0&&j===0&&(Ee.origWidth%4!==0||Ee.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),y>1?(J=Ee.origWidth,ee=Ee.origHeight):(J=Ee.width,ee=Ee.height);const Be=new Uint8Array(g.getImageTranscodedSizeInBytes(te,j,0,P));if(!g.transcodeImage(Be,te,j,Q,P,0,-1,-1))throw v(),new Error("THREE.KTX2Loader: .transcodeImage failed.");W.push(Be)}const ae=p(W);k.push({data:ae,width:J,height:ee}),D.push(ae.buffer)}S.push({mipmaps:k,width:E,height:_,format:O})}return v(),{faces:S,buffers:D,width:E,height:_,hasAlpha:w,format:O,dfdFlags:b}}const d=[{if:"astcSupported",basisFormat:[a.UASTC_4x4],transcoderFormat:[r.ASTC_4x4,r.ASTC_4x4],engineFormat:[s.RGBA_ASTC_4x4_Format,s.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[r.BC7_M5,r.BC7_M5],engineFormat:[s.RGBA_BPTC_Format,s.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[r.BC1,r.BC3],engineFormat:[s.RGB_S3TC_DXT1_Format,s.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[r.ETC1,r.ETC2],engineFormat:[s.RGB_ETC2_Format,s.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[r.ETC1],engineFormat:[s.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[r.PVRTC1_4_RGB,r.PVRTC1_4_RGBA],engineFormat:[s.RGB_PVRTC_4BPPV1_Format,s.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],l=d.sort(function(m,g){return m.priorityETC1S-g.priorityETC1S}),A=d.sort(function(m,g){return m.priorityUASTC-g.priorityUASTC});function u(m,g,v,C){let E,_;const B=m===a.ETC1S?l:A;for(let y=0;y<B.length;y++){const x=B[y];if(t[x.if]&&x.basisFormat.includes(m)&&!(C&&x.transcoderFormat.length<2)&&!(x.needsPowerOfTwo&&!(f(g)&&f(v))))return E=x.transcoderFormat[C?1:0],_=x.engineFormat[C?1:0],{transcoderFormat:E,engineFormat:_}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),E=r.RGBA32,_=s.RGBAFormat,{transcoderFormat:E,engineFormat:_}}function f(m){return m<=2?!0:(m&m-1)===0&&m!==0}function p(m){if(m.length===1)return m[0];let g=0;for(let E=0;E<m.length;E++){const _=m[E];g+=_.byteLength}const v=new Uint8Array(g);let C=0;for(let E=0;E<m.length;E++){const _=m[E];v.set(_,C),C+=_.byteLength}return v}}),e})(),gg=new Set([Jn,lr,ms]),Yo={[Th]:Jn,[xh]:Jn,[Bh]:Jn,[yh]:Jn,[Sh]:lr,[wh]:lr,[Ch]:lr,[Eh]:lr,[Mh]:ms,[Ih]:ms,[_h]:ms,[vh]:ms,[Dh]:ic,[bh]:ic},qo={[Th]:Ti,[xh]:Ot,[Bh]:gt,[yh]:gt,[Sh]:Ti,[wh]:Ot,[Ch]:gt,[Eh]:gt,[Mh]:Ti,[Ih]:Ot,[_h]:gt,[vh]:gt,[Dh]:gt,[bh]:gt};async function mg(o){const{vkFormat:e}=o;if(Yo[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let t;o.supercompressionScheme===Ac&&(Ko||(Ko=new Promise(async r=>{const a=new ag;await a.init(),r(a)})),t=await Ko);const i=[];for(let r=0;r<o.levels.length;r++){const a=Math.max(1,o.pixelWidth>>r),c=Math.max(1,o.pixelHeight>>r),h=o.pixelDepth?Math.max(1,o.pixelDepth>>r):0,d=o.levels[r];let l;if(o.supercompressionScheme===ph)l=d.levelData;else if(o.supercompressionScheme===Ac)l=t.decode(d.levelData,d.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let A;qo[e]===Ti?A=new Float32Array(l.buffer,l.byteOffset,l.byteLength/Float32Array.BYTES_PER_ELEMENT):qo[e]===Ot?A=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/Uint16Array.BYTES_PER_ELEMENT):A=l,i.push({data:A,width:a,height:c,depth:h})}let n;if(gg.has(Yo[e]))n=o.pixelDepth===0?new $d(i[0].data,o.pixelWidth,o.pixelHeight):new qp(i[0].data,o.pixelWidth,o.pixelHeight,o.pixelDepth);else{if(o.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");n=new Mo(i,o.pixelWidth,o.pixelHeight)}n.mipmaps=i,n.type=qo[e],n.format=Yo[e],n.needsUpdate=!0;const s=Fh(o);return"colorSpace"in n?n.colorSpace=s:n.encoding=s===wl?Qh:Rh,Promise.resolve(n)}function Fh(o){const e=o.dataFormatDescriptor[0];return e.colorPrimaries===gh?e.transferFunction===ja?wl:fg:e.colorPrimaries===ng?e.transferFunction===ja?ug:dg:(e.colorPrimaries===ig||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${e.colorPrimaries}"`),dc)}class vg extends $A{constructor(e){super(e),this.type=Ot}parse(e){const r=function(x,w){switch(x){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(w||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(w||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(w||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(w||""))}},d=`
`,l=function(x,w,b){w=w||1024;let O=x.pos,S=-1,D=0,Q="",k=String.fromCharCode.apply(null,new Uint16Array(x.subarray(O,O+128)));for(;0>(S=k.indexOf(d))&&D<w&&O<x.byteLength;)Q+=k,D+=k.length,O+=128,k+=String.fromCharCode.apply(null,new Uint16Array(x.subarray(O,O+128)));return-1<S?(x.pos+=D+S+1,Q+k.slice(0,S)):!1},A=function(x){const w=/^#\?(\S+)/,b=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,P=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,O=/^\s*FORMAT=(\S+)\s*$/,S=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,D={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Q,k;for((x.pos>=x.byteLength||!(Q=l(x)))&&r(1,"no header found"),(k=Q.match(w))||r(3,"bad initial token"),D.valid|=1,D.programtype=k[1],D.string+=Q+`
`;Q=l(x),Q!==!1;){if(D.string+=Q+`
`,Q.charAt(0)==="#"){D.comments+=Q+`
`;continue}if((k=Q.match(b))&&(D.gamma=parseFloat(k[1])),(k=Q.match(P))&&(D.exposure=parseFloat(k[1])),(k=Q.match(O))&&(D.valid|=2,D.format=k[1]),(k=Q.match(S))&&(D.valid|=4,D.height=parseInt(k[1],10),D.width=parseInt(k[2],10)),D.valid&2&&D.valid&4)break}return D.valid&2||r(3,"missing format specifier"),D.valid&4||r(3,"missing image size specifier"),D},u=function(x,w,b){const P=w;if(P<8||P>32767||x[0]!==2||x[1]!==2||x[2]&128)return new Uint8Array(x);P!==(x[2]<<8|x[3])&&r(3,"wrong scanline width");const O=new Uint8Array(4*w*b);O.length||r(4,"unable to allocate buffer space");let S=0,D=0;const Q=4*P,k=new Uint8Array(4),te=new Uint8Array(Q);let W=b;for(;W>0&&D<x.byteLength;){D+4>x.byteLength&&r(1),k[0]=x[D++],k[1]=x[D++],k[2]=x[D++],k[3]=x[D++],(k[0]!=2||k[1]!=2||(k[2]<<8|k[3])!=P)&&r(3,"bad rgbe scanline format");let J=0,ee;for(;J<Q&&D<x.byteLength;){ee=x[D++];const j=ee>128;if(j&&(ee-=128),(ee===0||J+ee>Q)&&r(3,"bad scanline data"),j){const Ee=x[D++];for(let Be=0;Be<ee;Be++)te[J++]=Ee}else te.set(x.subarray(D,D+ee),J),J+=ee,D+=ee}const ae=P;for(let j=0;j<ae;j++){let Ee=0;O[S]=te[j+Ee],Ee+=P,O[S+1]=te[j+Ee],Ee+=P,O[S+2]=te[j+Ee],Ee+=P,O[S+3]=te[j+Ee],S+=4}W--}return O},f=function(x,w,b,P){const O=x[w+3],S=Math.pow(2,O-128)/255;b[P+0]=x[w+0]*S,b[P+1]=x[w+1]*S,b[P+2]=x[w+2]*S,b[P+3]=1},p=function(x,w,b,P){const O=x[w+3],S=Math.pow(2,O-128)/255;b[P+0]=vs.toHalfFloat(Math.min(x[w+0]*S,65504)),b[P+1]=vs.toHalfFloat(Math.min(x[w+1]*S,65504)),b[P+2]=vs.toHalfFloat(Math.min(x[w+2]*S,65504)),b[P+3]=vs.toHalfFloat(1)},m=new Uint8Array(e);m.pos=0;const g=A(m),v=g.width,C=g.height,E=u(m.subarray(m.pos),v,C);let _,B,y;switch(this.type){case Ti:y=E.length/4;const x=new Float32Array(y*4);for(let b=0;b<y;b++)f(E,b*4,x,b*4);_=x,B=Ti;break;case Ot:y=E.length/4;const w=new Uint16Array(y*4);for(let b=0;b<y;b++)p(E,b*4,w,b*4);_=w,B=Ot;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:v,height:C,data:_,header:g.string,gamma:g.gamma,exposure:g.exposure,type:B}}setDataType(e){return this.type=e,this}load(e,t,i,n){function s(r,a){switch(r.type){case Ti:case Ot:"colorSpace"in r?r.colorSpace="srgb-linear":r.encoding=3e3,r.minFilter=Pt,r.magFilter=Pt,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,a)}return super.load(e,s,i,n)}}const Js=oh>=152;class _g extends $A{constructor(e){super(e),this.type=Ot}parse(e){const w=Math.pow(2.7182818,2.2);function b(I,T){for(var U=0,K=0;K<65536;++K)(K==0||I[K>>3]&1<<(K&7))&&(T[U++]=K);for(var Y=U-1;U<65536;)T[U++]=0;return Y}function P(I){for(var T=0;T<16384;T++)I[T]={},I[T].len=0,I[T].lit=0,I[T].p=null}const O={l:0,c:0,lc:0};function S(I,T,U,K,Y){for(;U<I;)T=T<<8|Ur(K,Y),U+=8;U-=I,O.l=T>>U&(1<<I)-1,O.c=T,O.lc=U}const D=new Array(59);function Q(I){for(var T=0;T<=58;++T)D[T]=0;for(var T=0;T<65537;++T)D[I[T]]+=1;for(var U=0,T=58;T>0;--T){var K=U+D[T]>>1;D[T]=U,U=K}for(var T=0;T<65537;++T){var Y=I[T];Y>0&&(I[T]=Y|D[Y]++<<6)}}function k(I,T,U,K,Y,q,se){for(var ie=U,Ae=0,le=0;Y<=q;Y++){if(ie.value-U.value>K)return!1;S(6,Ae,le,I,ie);var he=O.l;if(Ae=O.c,le=O.lc,se[Y]=he,he==63){if(ie.value-U.value>K)throw"Something wrong with hufUnpackEncTable";S(8,Ae,le,I,ie);var oe=O.l+6;if(Ae=O.c,le=O.lc,Y+oe>q+1)throw"Something wrong with hufUnpackEncTable";for(;oe--;)se[Y++]=0;Y--}else if(he>=59){var oe=he-59+2;if(Y+oe>q+1)throw"Something wrong with hufUnpackEncTable";for(;oe--;)se[Y++]=0;Y--}}Q(se)}function te(I){return I&63}function W(I){return I>>6}function J(I,T,U,K){for(;T<=U;T++){var Y=W(I[T]),q=te(I[T]);if(Y>>q)throw"Invalid table entry";if(q>14){var se=K[Y>>q-14];if(se.len)throw"Invalid table entry";if(se.lit++,se.p){var ie=se.p;se.p=new Array(se.lit);for(var Ae=0;Ae<se.lit-1;++Ae)se.p[Ae]=ie[Ae]}else se.p=new Array(1);se.p[se.lit-1]=T}else if(q)for(var le=0,Ae=1<<14-q;Ae>0;Ae--){var se=K[(Y<<14-q)+le];if(se.len||se.p)throw"Invalid table entry";se.len=q,se.lit=T,le++}}return!0}const ee={c:0,lc:0};function ae(I,T,U,K){I=I<<8|Ur(U,K),T+=8,ee.c=I,ee.lc=T}const j={c:0,lc:0};function Ee(I,T,U,K,Y,q,se,ie,Ae,le){if(I==T){K<8&&(ae(U,K,Y,se),U=ee.c,K=ee.lc),K-=8;var he=U>>K,he=new Uint8Array([he])[0];if(Ae.value+he>le)return!1;for(var oe=ie[Ae.value-1];he-- >0;)ie[Ae.value++]=oe}else if(Ae.value<le)ie[Ae.value++]=I;else return!1;j.c=U,j.lc=K}function Be(I){return I&65535}function H(I){var T=Be(I);return T>32767?T-65536:T}const G={a:0,b:0};function F(I,T){var U=H(I),K=H(T),Y=K,q=U+(Y&1)+(Y>>1),se=q,ie=q-Y;G.a=se,G.b=ie}function R(I,T){var U=Be(I),K=Be(T),Y=U-(K>>1)&65535,q=K+Y-32768&65535;G.a=q,G.b=Y}function Z(I,T,U,K,Y,q,se){for(var ie=se<16384,Ae=U>Y?Y:U,le=1,he;le<=Ae;)le<<=1;for(le>>=1,he=le,le>>=1;le>=1;){for(var oe=0,ot=oe+q*(Y-he),ye=q*le,Ie=q*he,Me=K*le,be=K*he,Ve,We,Ct,Ut;oe<=ot;oe+=Ie){for(var je=oe,Ri=oe+K*(U-he);je<=Ri;je+=be){var et=je+Me,yt=je+ye,Yi=yt+Me;ie?(F(I[je+T],I[yt+T]),Ve=G.a,Ct=G.b,F(I[et+T],I[Yi+T]),We=G.a,Ut=G.b,F(Ve,We),I[je+T]=G.a,I[et+T]=G.b,F(Ct,Ut),I[yt+T]=G.a,I[Yi+T]=G.b):(R(I[je+T],I[yt+T]),Ve=G.a,Ct=G.b,R(I[et+T],I[Yi+T]),We=G.a,Ut=G.b,R(Ve,We),I[je+T]=G.a,I[et+T]=G.b,R(Ct,Ut),I[yt+T]=G.a,I[Yi+T]=G.b)}if(U&le){var yt=je+ye;ie?F(I[je+T],I[yt+T]):R(I[je+T],I[yt+T]),Ve=G.a,I[yt+T]=G.b,I[je+T]=Ve}}if(Y&le)for(var je=oe,Ri=oe+K*(U-he);je<=Ri;je+=be){var et=je+Me;ie?F(I[je+T],I[et+T]):R(I[je+T],I[et+T]),Ve=G.a,I[et+T]=G.b,I[je+T]=Ve}he=le,le>>=1}return oe}function ne(I,T,U,K,Y,q,se,ie,Ae,le){for(var he=0,oe=0,ot=ie,ye=Math.trunc(Y.value+(q+7)/8);Y.value<ye;)for(ae(he,oe,U,Y),he=ee.c,oe=ee.lc;oe>=14;){var Ie=he>>oe-14&16383,Me=T[Ie];if(Me.len)oe-=Me.len,Ee(Me.lit,se,he,oe,U,K,Y,Ae,le,ot),he=j.c,oe=j.lc;else{if(!Me.p)throw"hufDecode issues";var be;for(be=0;be<Me.lit;be++){for(var Ve=te(I[Me.p[be]]);oe<Ve&&Y.value<ye;)ae(he,oe,U,Y),he=ee.c,oe=ee.lc;if(oe>=Ve&&W(I[Me.p[be]])==(he>>oe-Ve&(1<<Ve)-1)){oe-=Ve,Ee(Me.p[be],se,he,oe,U,K,Y,Ae,le,ot),he=j.c,oe=j.lc;break}}if(be==Me.lit)throw"hufDecode issues"}}var We=8-q&7;for(he>>=We,oe-=We;oe>0;){var Me=T[he<<14-oe&16383];if(Me.len)oe-=Me.len,Ee(Me.lit,se,he,oe,U,K,Y,Ae,le,ot),he=j.c,oe=j.lc;else throw"hufDecode issues"}return!0}function X(I,T,U,K,Y,q){var se={value:0},ie=U.value,Ae=bt(T,U),le=bt(T,U);U.value+=4;var he=bt(T,U);if(U.value+=4,Ae<0||Ae>=65537||le<0||le>=65537)throw"Something wrong with HUF_ENCSIZE";var oe=new Array(65537),ot=new Array(16384);P(ot);var ye=K-(U.value-ie);if(k(I,T,U,ye,Ae,le,oe),he>8*(K-(U.value-ie)))throw"Something wrong with hufUncompress";J(oe,Ae,le,ot),ne(oe,ot,I,T,U,he,le,q,Y,se)}function ue(I,T,U){for(var K=0;K<U;++K)T[K]=I[T[K]]}function de(I){for(var T=1;T<I.length;T++){var U=I[T-1]+I[T]-128;I[T]=U}}function pe(I,T){for(var U=0,K=Math.floor((I.length+1)/2),Y=0,q=I.length-1;!(Y>q||(T[Y++]=I[U++],Y>q));)T[Y++]=I[K++]}function $(I){for(var T=I.byteLength,U=new Array,K=0,Y=new DataView(I);T>0;){var q=Y.getInt8(K++);if(q<0){var se=-q;T-=se+1;for(var ie=0;ie<se;ie++)U.push(Y.getUint8(K++))}else{var se=q;T-=2;for(var Ae=Y.getUint8(K++),ie=0;ie<se+1;ie++)U.push(Ae)}}return U}function re(I,T,U,K,Y,q){var et=new DataView(q.buffer),se=U[I.idx[0]].width,ie=U[I.idx[0]].height,Ae=3,le=Math.floor(se/8),he=Math.ceil(se/8),oe=Math.ceil(ie/8),ot=se-(he-1)*8,ye=ie-(oe-1)*8,Ie={value:0},Me=new Array(Ae),be=new Array(Ae),Ve=new Array(Ae),We=new Array(Ae),Ct=new Array(Ae);for(let Ke=0;Ke<Ae;++Ke)Ct[Ke]=T[I.idx[Ke]],Me[Ke]=Ke<1?0:Me[Ke-1]+he*oe,be[Ke]=new Float32Array(64),Ve[Ke]=new Uint16Array(64),We[Ke]=new Uint16Array(he*64);for(let Ke=0;Ke<oe;++Ke){var Ut=8;Ke==oe-1&&(Ut=ye);var je=8;for(let st=0;st<he;++st){st==he-1&&(je=ot);for(let ze=0;ze<Ae;++ze)Ve[ze].fill(0),Ve[ze][0]=Y[Me[ze]++],_e(Ie,K,Ve[ze]),ce(Ve[ze],be[ze]),z(be[ze]);L(be);for(let ze=0;ze<Ae;++ze)ge(be[ze],We[ze],st*64)}let Rt=0;for(let st=0;st<Ae;++st){const ze=U[I.idx[st]].type;for(let Ai=8*Ke;Ai<8*Ke+Ut;++Ai){Rt=Ct[st][Ai];for(let Qn=0;Qn<le;++Qn){const $t=Qn*64+(Ai&7)*8;et.setUint16(Rt+0*2*ze,We[st][$t+0],!0),et.setUint16(Rt+1*2*ze,We[st][$t+1],!0),et.setUint16(Rt+2*2*ze,We[st][$t+2],!0),et.setUint16(Rt+3*2*ze,We[st][$t+3],!0),et.setUint16(Rt+4*2*ze,We[st][$t+4],!0),et.setUint16(Rt+5*2*ze,We[st][$t+5],!0),et.setUint16(Rt+6*2*ze,We[st][$t+6],!0),et.setUint16(Rt+7*2*ze,We[st][$t+7],!0),Rt+=8*2*ze}}if(le!=he)for(let Ai=8*Ke;Ai<8*Ke+Ut;++Ai){const Qn=Ct[st][Ai]+8*le*2*ze,$t=le*64+(Ai&7)*8;for(let hn=0;hn<je;++hn)et.setUint16(Qn+hn*2*ze,We[st][$t+hn],!0)}}}for(var Ri=new Uint16Array(se),et=new DataView(q.buffer),yt=0;yt<Ae;++yt){U[I.idx[yt]].decoded=!0;var Yi=U[I.idx[yt]].type;if(U[yt].type==2)for(var ks=0;ks<ie;++ks){const Ke=Ct[yt][ks];for(var ci=0;ci<se;++ci)Ri[ci]=et.getUint16(Ke+ci*2*Yi,!0);for(var ci=0;ci<se;++ci)et.setFloat32(Ke+ci*2*Yi,fe(Ri[ci]),!0)}}}function _e(I,T,U){for(var K,Y=1;Y<64;)K=T[I.value],K==65280?Y=64:K>>8==255?Y+=K&255:(U[Y]=K,Y++),I.value++}function ce(I,T){T[0]=fe(I[0]),T[1]=fe(I[1]),T[2]=fe(I[5]),T[3]=fe(I[6]),T[4]=fe(I[14]),T[5]=fe(I[15]),T[6]=fe(I[27]),T[7]=fe(I[28]),T[8]=fe(I[2]),T[9]=fe(I[4]),T[10]=fe(I[7]),T[11]=fe(I[13]),T[12]=fe(I[16]),T[13]=fe(I[26]),T[14]=fe(I[29]),T[15]=fe(I[42]),T[16]=fe(I[3]),T[17]=fe(I[8]),T[18]=fe(I[12]),T[19]=fe(I[17]),T[20]=fe(I[25]),T[21]=fe(I[30]),T[22]=fe(I[41]),T[23]=fe(I[43]),T[24]=fe(I[9]),T[25]=fe(I[11]),T[26]=fe(I[18]),T[27]=fe(I[24]),T[28]=fe(I[31]),T[29]=fe(I[40]),T[30]=fe(I[44]),T[31]=fe(I[53]),T[32]=fe(I[10]),T[33]=fe(I[19]),T[34]=fe(I[23]),T[35]=fe(I[32]),T[36]=fe(I[39]),T[37]=fe(I[45]),T[38]=fe(I[52]),T[39]=fe(I[54]),T[40]=fe(I[20]),T[41]=fe(I[22]),T[42]=fe(I[33]),T[43]=fe(I[38]),T[44]=fe(I[46]),T[45]=fe(I[51]),T[46]=fe(I[55]),T[47]=fe(I[60]),T[48]=fe(I[21]),T[49]=fe(I[34]),T[50]=fe(I[37]),T[51]=fe(I[47]),T[52]=fe(I[50]),T[53]=fe(I[56]),T[54]=fe(I[59]),T[55]=fe(I[61]),T[56]=fe(I[35]),T[57]=fe(I[36]),T[58]=fe(I[48]),T[59]=fe(I[49]),T[60]=fe(I[57]),T[61]=fe(I[58]),T[62]=fe(I[62]),T[63]=fe(I[63])}function z(I){const T=.5*Math.cos(.7853975),U=.5*Math.cos(3.14159/16),K=.5*Math.cos(3.14159/8),Y=.5*Math.cos(3*3.14159/16),q=.5*Math.cos(5*3.14159/16),se=.5*Math.cos(3*3.14159/8),ie=.5*Math.cos(7*3.14159/16);for(var Ae=new Array(4),le=new Array(4),he=new Array(4),oe=new Array(4),ot=0;ot<8;++ot){var ye=ot*8;Ae[0]=K*I[ye+2],Ae[1]=se*I[ye+2],Ae[2]=K*I[ye+6],Ae[3]=se*I[ye+6],le[0]=U*I[ye+1]+Y*I[ye+3]+q*I[ye+5]+ie*I[ye+7],le[1]=Y*I[ye+1]-ie*I[ye+3]-U*I[ye+5]-q*I[ye+7],le[2]=q*I[ye+1]-U*I[ye+3]+ie*I[ye+5]+Y*I[ye+7],le[3]=ie*I[ye+1]-q*I[ye+3]+Y*I[ye+5]-U*I[ye+7],he[0]=T*(I[ye+0]+I[ye+4]),he[3]=T*(I[ye+0]-I[ye+4]),he[1]=Ae[0]+Ae[3],he[2]=Ae[1]-Ae[2],oe[0]=he[0]+he[1],oe[1]=he[3]+he[2],oe[2]=he[3]-he[2],oe[3]=he[0]-he[1],I[ye+0]=oe[0]+le[0],I[ye+1]=oe[1]+le[1],I[ye+2]=oe[2]+le[2],I[ye+3]=oe[3]+le[3],I[ye+4]=oe[3]-le[3],I[ye+5]=oe[2]-le[2],I[ye+6]=oe[1]-le[1],I[ye+7]=oe[0]-le[0]}for(var Ie=0;Ie<8;++Ie)Ae[0]=K*I[16+Ie],Ae[1]=se*I[16+Ie],Ae[2]=K*I[48+Ie],Ae[3]=se*I[48+Ie],le[0]=U*I[8+Ie]+Y*I[24+Ie]+q*I[40+Ie]+ie*I[56+Ie],le[1]=Y*I[8+Ie]-ie*I[24+Ie]-U*I[40+Ie]-q*I[56+Ie],le[2]=q*I[8+Ie]-U*I[24+Ie]+ie*I[40+Ie]+Y*I[56+Ie],le[3]=ie*I[8+Ie]-q*I[24+Ie]+Y*I[40+Ie]-U*I[56+Ie],he[0]=T*(I[Ie]+I[32+Ie]),he[3]=T*(I[Ie]-I[32+Ie]),he[1]=Ae[0]+Ae[3],he[2]=Ae[1]-Ae[2],oe[0]=he[0]+he[1],oe[1]=he[3]+he[2],oe[2]=he[3]-he[2],oe[3]=he[0]-he[1],I[0+Ie]=oe[0]+le[0],I[8+Ie]=oe[1]+le[1],I[16+Ie]=oe[2]+le[2],I[24+Ie]=oe[3]+le[3],I[32+Ie]=oe[3]-le[3],I[40+Ie]=oe[2]-le[2],I[48+Ie]=oe[1]-le[1],I[56+Ie]=oe[0]-le[0]}function L(I){for(var T=0;T<64;++T){var U=I[0][T],K=I[1][T],Y=I[2][T];I[0][T]=U+1.5747*Y,I[1][T]=U-.1873*K-.4682*Y,I[2][T]=U+1.8556*K}}function ge(I,T,U){for(var K=0;K<64;++K)T[U+K]=vs.toHalfFloat(Fe(I[K]))}function Fe(I){return I<=1?Math.sign(I)*Math.pow(Math.abs(I),2.2):Math.sign(I)*Math.pow(w,Math.abs(I)-1)}function Gt(I){return new DataView(I.array.buffer,I.offset.value,I.size)}function ai(I){var T=I.viewer.buffer.slice(I.offset.value,I.offset.value+I.size),U=new Uint8Array($(T)),K=new Uint8Array(U.length);return de(U),pe(U,K),new DataView(K.buffer)}function ht(I){var T=I.array.slice(I.offset.value,I.offset.value+I.size),U=Hr(T),K=new Uint8Array(U.length);return de(U),pe(U,K),new DataView(K.buffer)}function Di(I){for(var T=I.viewer,U={value:I.offset.value},K=new Uint16Array(I.width*I.scanlineBlockSize*(I.channels*I.type)),Y=new Uint8Array(8192),q=0,se=new Array(I.channels),ie=0;ie<I.channels;ie++)se[ie]={},se[ie].start=q,se[ie].end=se[ie].start,se[ie].nx=I.width,se[ie].ny=I.lines,se[ie].size=I.type,q+=se[ie].nx*se[ie].ny*se[ie].size;var Ae=Ps(T,U),le=Ps(T,U);if(le>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Ae<=le)for(var ie=0;ie<le-Ae+1;ie++)Y[ie+Ae]=as(T,U);var he=new Uint16Array(65536),oe=b(Y,he),ot=bt(T,U);X(I.array,T,U,ot,K,q);for(var ie=0;ie<I.channels;++ie)for(var ye=se[ie],Ie=0;Ie<se[ie].size;++Ie)Z(K,ye.start+Ie,ye.nx,ye.size,ye.ny,ye.nx*ye.size,oe);ue(he,K,q);for(var Me=0,be=new Uint8Array(K.buffer.byteLength),Ve=0;Ve<I.lines;Ve++)for(var We=0;We<I.channels;We++){var ye=se[We],Ct=ye.nx*ye.size,Ut=new Uint8Array(K.buffer,ye.end*2,Ct*2);be.set(Ut,Me),Me+=Ct*2,ye.end+=Ct}return new DataView(be.buffer)}function rs(I){var T=I.array.slice(I.offset.value,I.offset.value+I.size),U=Hr(T);const K=I.lines*I.channels*I.width,Y=I.type==1?new Uint16Array(K):new Uint32Array(K);let q=0,se=0;const ie=new Array(4);for(let Ae=0;Ae<I.lines;Ae++)for(let le=0;le<I.channels;le++){let he=0;switch(I.type){case 1:ie[0]=q,ie[1]=ie[0]+I.width,q=ie[1]+I.width;for(let oe=0;oe<I.width;++oe){const ot=U[ie[0]++]<<8|U[ie[1]++];he+=ot,Y[se]=he,se++}break;case 2:ie[0]=q,ie[1]=ie[0]+I.width,ie[2]=ie[1]+I.width,q=ie[2]+I.width;for(let oe=0;oe<I.width;++oe){const ot=U[ie[0]++]<<24|U[ie[1]++]<<16|U[ie[2]++]<<8;he+=ot,Y[se]=he,se++}break}}return new DataView(Y.buffer)}function Os(I){var T=I.viewer,U={value:I.offset.value},K=new Uint8Array(I.width*I.lines*(I.channels*I.type*2)),Y={version:li(T,U),unknownUncompressedSize:li(T,U),unknownCompressedSize:li(T,U),acCompressedSize:li(T,U),dcCompressedSize:li(T,U),rleCompressedSize:li(T,U),rleUncompressedSize:li(T,U),rleRawSize:li(T,U),totalAcUncompressedCount:li(T,U),totalDcUncompressedCount:li(T,U),acCompression:li(T,U)};if(Y.version<2)throw"EXRLoader.parse: "+Us.compression+" version "+Y.version+" is unsupported";for(var q=new Array,se=Ps(T,U)-2;se>0;){var ie=Ki(T.buffer,U),Ae=as(T,U),le=Ae>>2&3,he=(Ae>>4)-1,oe=new Int8Array([he])[0],ot=as(T,U);q.push({name:ie,index:oe,type:ot,compression:le}),se-=ie.length+3}for(var ye=Us.channels,Ie=new Array(I.channels),Me=0;Me<I.channels;++Me){var be=Ie[Me]={},Ve=ye[Me];be.name=Ve.name,be.compression=0,be.decoded=!1,be.type=Ve.pixelType,be.pLinear=Ve.pLinear,be.width=I.width,be.height=I.lines}for(var We={idx:new Array(3)},Ct=0;Ct<I.channels;++Ct)for(var be=Ie[Ct],Me=0;Me<q.length;++Me){var Ut=q[Me];be.name==Ut.name&&(be.compression=Ut.compression,Ut.index>=0&&(We.idx[Ut.index]=Ct),be.offset=Ct)}if(Y.acCompressedSize>0)switch(Y.acCompression){case 0:var et=new Uint16Array(Y.totalAcUncompressedCount);X(I.array,T,U,Y.acCompressedSize,et,Y.totalAcUncompressedCount);break;case 1:var je=I.array.slice(U.value,U.value+Y.totalAcUncompressedCount),Ri=Hr(je),et=new Uint16Array(Ri.buffer);U.value+=Y.totalAcUncompressedCount;break}if(Y.dcCompressedSize>0){var yt={array:I.array,offset:U,size:Y.dcCompressedSize},Yi=new Uint16Array(ht(yt).buffer);U.value+=Y.dcCompressedSize}if(Y.rleRawSize>0){var je=I.array.slice(U.value,U.value+Y.rleCompressedSize),Ri=Hr(je),ks=$(Ri.buffer);U.value+=Y.rleCompressedSize}for(var ci=0,Ke=new Array(Ie.length),Me=0;Me<Ke.length;++Me)Ke[Me]=new Array;for(var Rt=0;Rt<I.lines;++Rt)for(var st=0;st<Ie.length;++st)Ke[st].push(ci),ci+=Ie[st].width*I.type*2;re(We,Ke,Ie,et,Yi,K);for(var Me=0;Me<Ie.length;++Me){var be=Ie[Me];if(!be.decoded)switch(be.compression){case 2:for(var ze=0,Ai=0,Rt=0;Rt<I.lines;++Rt){for(var Qn=Ke[Me][ze],$t=0;$t<be.width;++$t){for(var hn=0;hn<2*be.type;++hn)K[Qn++]=ks[Ai+hn*be.width*be.height];Ai++}ze++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(K.buffer)}function Ki(I,T){for(var U=new Uint8Array(I),K=0;U[T.value+K]!=0;)K+=1;var Y=new TextDecoder().decode(U.slice(T.value,T.value+K));return T.value=T.value+K+1,Y}function Ls(I,T,U){var K=new TextDecoder().decode(new Uint8Array(I).slice(T.value,T.value+U));return T.value=T.value+U,K}function os(I,T){var U=An(I,T),K=bt(I,T);return[U,K]}function Gr(I,T){var U=bt(I,T),K=bt(I,T);return[U,K]}function An(I,T){var U=I.getInt32(T.value,!0);return T.value=T.value+4,U}function bt(I,T){var U=I.getUint32(T.value,!0);return T.value=T.value+4,U}function Ur(I,T){var U=I[T.value];return T.value=T.value+1,U}function as(I,T){var U=I.getUint8(T.value);return T.value=T.value+1,U}const li=function(I,T){let U;return"getBigInt64"in DataView.prototype?U=Number(I.getBigInt64(T.value,!0)):U=I.getUint32(T.value+4,!0)+Number(I.getUint32(T.value,!0)<<32),T.value+=8,U};function Dt(I,T){var U=I.getFloat32(T.value,!0);return T.value+=4,U}function _d(I,T){return vs.toHalfFloat(Dt(I,T))}function fe(I){var T=(I&31744)>>10,U=I&1023;return(I>>15?-1:1)*(T?T===31?U?NaN:1/0:Math.pow(2,T-15)*(1+U/1024):6103515625e-14*(U/1024))}function Ps(I,T){var U=I.getUint16(T.value,!0);return T.value+=2,U}function Cd(I,T){return fe(Ps(I,T))}function Ed(I,T,U,K){for(var Y=U.value,q=[];U.value<Y+K-1;){var se=Ki(T,U),ie=An(I,U),Ae=as(I,U);U.value+=3;var le=An(I,U),he=An(I,U);q.push({name:se,pixelType:ie,pLinear:Ae,xSampling:le,ySampling:he})}return U.value+=1,q}function Bd(I,T){var U=Dt(I,T),K=Dt(I,T),Y=Dt(I,T),q=Dt(I,T),se=Dt(I,T),ie=Dt(I,T),Ae=Dt(I,T),le=Dt(I,T);return{redX:U,redY:K,greenX:Y,greenY:q,blueX:se,blueY:ie,whiteX:Ae,whiteY:le}}function yd(I,T){var U=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],K=as(I,T);return U[K]}function Id(I,T){var U=bt(I,T),K=bt(I,T),Y=bt(I,T),q=bt(I,T);return{xMin:U,yMin:K,xMax:Y,yMax:q}}function wd(I,T){var U=["INCREASING_Y"],K=as(I,T);return U[K]}function xd(I,T){var U=Dt(I,T),K=Dt(I,T);return[U,K]}function Md(I,T){var U=Dt(I,T),K=Dt(I,T),Y=Dt(I,T);return[U,K,Y]}function Sd(I,T,U,K,Y){if(K==="string"||K==="stringvector"||K==="iccProfile")return Ls(T,U,Y);if(K==="chlist")return Ed(I,T,U,Y);if(K==="chromaticities")return Bd(I,U);if(K==="compression")return yd(I,U);if(K==="box2i")return Id(I,U);if(K==="lineOrder")return wd(I,U);if(K==="float")return Dt(I,U);if(K==="v2f")return xd(I,U);if(K==="v3f")return Md(I,U);if(K==="int")return An(I,U);if(K==="rational")return os(I,U);if(K==="timecode")return Gr(I,U);if(K==="preview")return U.value+=Y,"skipped";U.value+=Y}function Td(I,T,U){const K={};if(I.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";K.version=I.getUint8(4);const Y=I.getUint8(5);K.spec={singleTile:!!(Y&2),longName:!!(Y&4),deepFormat:!!(Y&8),multiPart:!!(Y&16)},U.value=8;for(var q=!0;q;){var se=Ki(T,U);if(se==0)q=!1;else{var ie=Ki(T,U),Ae=bt(I,U),le=Sd(I,T,U,ie,Ae);le===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ie}'.`):K[se]=le}}if((Y&-5)!=0)throw console.error("EXRHeader:",K),"THREE.EXRLoader: provided file is currently unsupported.";return K}function bd(I,T,U,K,Y){const q={size:0,viewer:T,array:U,offset:K,width:I.dataWindow.xMax-I.dataWindow.xMin+1,height:I.dataWindow.yMax-I.dataWindow.yMin+1,channels:I.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:I.channels[0].pixelType,uncompress:null,getter:null,format:null,[Js?"colorSpace":"encoding"]:null};switch(I.compression){case"NO_COMPRESSION":q.lines=1,q.uncompress=Gt;break;case"RLE_COMPRESSION":q.lines=1,q.uncompress=ai;break;case"ZIPS_COMPRESSION":q.lines=1,q.uncompress=ht;break;case"ZIP_COMPRESSION":q.lines=16,q.uncompress=ht;break;case"PIZ_COMPRESSION":q.lines=32,q.uncompress=Di;break;case"PXR24_COMPRESSION":q.lines=16,q.uncompress=rs;break;case"DWAA_COMPRESSION":q.lines=32,q.uncompress=Os;break;case"DWAB_COMPRESSION":q.lines=256,q.uncompress=Os;break;default:throw"EXRLoader.parse: "+I.compression+" is unsupported"}if(q.scanlineBlockSize=q.lines,q.type==1)switch(Y){case Ti:q.getter=Cd,q.inputSize=2;break;case Ot:q.getter=Ps,q.inputSize=2;break}else if(q.type==2)switch(Y){case Ti:q.getter=Dt,q.inputSize=4;break;case Ot:q.getter=_d,q.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+q.type+" for "+I.compression+".";q.blockCount=(I.dataWindow.yMax+1)/q.scanlineBlockSize;for(var se=0;se<q.blockCount;se++)li(T,K);q.outputChannels=q.channels==3?4:q.channels;const ie=q.width*q.height*q.outputChannels;switch(Y){case Ti:q.byteArray=new Float32Array(ie),q.channels<q.outputChannels&&q.byteArray.fill(1,0,ie);break;case Ot:q.byteArray=new Uint16Array(ie),q.channels<q.outputChannels&&q.byteArray.fill(15360,0,ie);break;default:console.error("THREE.EXRLoader: unsupported type: ",Y);break}return q.bytesPerLine=q.width*q.inputSize*q.channels,q.outputChannels==4?q.format=Jn:q.format=ms,Js?q.colorSpace="srgb-linear":q.encoding=3e3,q}const kr=new DataView(e),Dd=new Uint8Array(e),Gs={value:0},Us=Td(kr,e,Gs),Oe=bd(Us,kr,Dd,Gs,this.type),tc={value:0},Rd={R:0,G:1,B:2,A:3,Y:0};for(let I=0;I<Oe.height/Oe.scanlineBlockSize;I++){const T=bt(kr,Gs);Oe.size=bt(kr,Gs),Oe.lines=T+Oe.scanlineBlockSize>Oe.height?Oe.height-T:Oe.scanlineBlockSize;const K=Oe.size<Oe.lines*Oe.bytesPerLine?Oe.uncompress(Oe):Gt(Oe);Gs.value+=Oe.size;for(let Y=0;Y<Oe.scanlineBlockSize;Y++){const q=Y+I*Oe.scanlineBlockSize;if(q>=Oe.height)break;for(let se=0;se<Oe.channels;se++){const ie=Rd[Us.channels[se].name];for(let Ae=0;Ae<Oe.width;Ae++){tc.value=(Y*(Oe.channels*Oe.width)+se*Oe.width+Ae)*Oe.inputSize;const le=(Oe.height-1-q)*(Oe.width*Oe.outputChannels)+Ae*Oe.outputChannels+ie;Oe.byteArray[le]=Oe.getter(K,tc)}}}}return{header:Us,width:Oe.width,height:Oe.height,data:Oe.byteArray,format:Oe.format,[Js?"colorSpace":"encoding"]:Oe[Js?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,i,n){function s(r,a){Js?r.colorSpace=a.colorSpace:r.encoding=a.encoding,r.minFilter=Pt,r.magFilter=Pt,r.generateMipmaps=!1,r.flipY=!1,t&&t(r,a)}return super.load(e,s,i,n)}}const Cg="srgb",Eg=(()=>{class o extends ns{constructor(t){super(t),this.defaultDPI=90,this.defaultUnit="px"}load(t,i,n,s){const r=this,a=new Si(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.setWithCredentials(r.withCredentials),a.load(t,function(c){try{i(r.parse(c))}catch(h){s?s(h):console.error(h),r.manager.itemError(t)}},n,s)}parse(t){const i=this;function n(H,G){if(H.nodeType!==1)return;const F=_(H);let R=!1,Z=null;switch(H.nodeName){case"svg":G=p(H,G);break;case"style":r(H);break;case"g":G=p(H,G);break;case"path":G=p(H,G),H.hasAttribute("d")&&(Z=s(H));break;case"rect":G=p(H,G),Z=h(H);break;case"polygon":G=p(H,G),Z=d(H);break;case"polyline":G=p(H,G),Z=l(H);break;case"circle":G=p(H,G),Z=A(H);break;case"ellipse":G=p(H,G),Z=u(H);break;case"line":G=p(H,G),Z=f(H);break;case"defs":R=!0;break;case"use":G=p(H,G);const ue=(H.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),de=H.viewportElement.getElementById(ue);de?n(de,G):console.warn("SVGLoader: 'use node' references non-existent node id: "+ue);break}Z&&(G.fill!==void 0&&G.fill!=="none"&&Z.color.setStyle(G.fill,Cg),y(Z,j),S.push(Z),Z.userData={node:H,style:G});const ne=H.childNodes;for(let X=0;X<ne.length;X++){const ue=ne[X];R&&ue.nodeName!=="style"&&ue.nodeName!=="defs"||n(ue,G)}F&&(Q.pop(),Q.length>0?j.copy(Q[Q.length-1]):j.identity())}function s(H){const G=new mn,F=new Ce,R=new Ce,Z=new Ce;let ne=!0,X=!1;const ue=H.getAttribute("d");if(ue===""||ue==="none")return null;const de=ue.match(/[a-df-z][^a-df-z]*/gi);for(let pe=0,$=de.length;pe<$;pe++){const re=de[pe],_e=re.charAt(0),ce=re.slice(1).trim();ne===!0&&(X=!0,ne=!1);let z;switch(_e){case"M":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2)F.x=z[L+0],F.y=z[L+1],R.x=F.x,R.y=F.y,L===0?G.moveTo(F.x,F.y):G.lineTo(F.x,F.y),L===0&&Z.copy(F);break;case"H":z=g(ce);for(let L=0,ge=z.length;L<ge;L++)F.x=z[L],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"V":z=g(ce);for(let L=0,ge=z.length;L<ge;L++)F.y=z[L],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"L":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2)F.x=z[L+0],F.y=z[L+1],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"C":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=6)G.bezierCurveTo(z[L+0],z[L+1],z[L+2],z[L+3],z[L+4],z[L+5]),R.x=z[L+2],R.y=z[L+3],F.x=z[L+4],F.y=z[L+5],L===0&&X===!0&&Z.copy(F);break;case"S":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=4)G.bezierCurveTo(m(F.x,R.x),m(F.y,R.y),z[L+0],z[L+1],z[L+2],z[L+3]),R.x=z[L+0],R.y=z[L+1],F.x=z[L+2],F.y=z[L+3],L===0&&X===!0&&Z.copy(F);break;case"Q":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=4)G.quadraticCurveTo(z[L+0],z[L+1],z[L+2],z[L+3]),R.x=z[L+0],R.y=z[L+1],F.x=z[L+2],F.y=z[L+3],L===0&&X===!0&&Z.copy(F);break;case"T":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2){const Fe=m(F.x,R.x),Gt=m(F.y,R.y);G.quadraticCurveTo(Fe,Gt,z[L+0],z[L+1]),R.x=Fe,R.y=Gt,F.x=z[L+0],F.y=z[L+1],L===0&&X===!0&&Z.copy(F)}break;case"A":z=g(ce,[3,4],7);for(let L=0,ge=z.length;L<ge;L+=7){if(z[L+5]==F.x&&z[L+6]==F.y)continue;const Fe=F.clone();F.x=z[L+5],F.y=z[L+6],R.x=F.x,R.y=F.y,a(G,z[L],z[L+1],z[L+2],z[L+3],z[L+4],Fe,F),L===0&&X===!0&&Z.copy(F)}break;case"m":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2)F.x+=z[L+0],F.y+=z[L+1],R.x=F.x,R.y=F.y,L===0?G.moveTo(F.x,F.y):G.lineTo(F.x,F.y),L===0&&Z.copy(F);break;case"h":z=g(ce);for(let L=0,ge=z.length;L<ge;L++)F.x+=z[L],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"v":z=g(ce);for(let L=0,ge=z.length;L<ge;L++)F.y+=z[L],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"l":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2)F.x+=z[L+0],F.y+=z[L+1],R.x=F.x,R.y=F.y,G.lineTo(F.x,F.y),L===0&&X===!0&&Z.copy(F);break;case"c":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=6)G.bezierCurveTo(F.x+z[L+0],F.y+z[L+1],F.x+z[L+2],F.y+z[L+3],F.x+z[L+4],F.y+z[L+5]),R.x=F.x+z[L+2],R.y=F.y+z[L+3],F.x+=z[L+4],F.y+=z[L+5],L===0&&X===!0&&Z.copy(F);break;case"s":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=4)G.bezierCurveTo(m(F.x,R.x),m(F.y,R.y),F.x+z[L+0],F.y+z[L+1],F.x+z[L+2],F.y+z[L+3]),R.x=F.x+z[L+0],R.y=F.y+z[L+1],F.x+=z[L+2],F.y+=z[L+3],L===0&&X===!0&&Z.copy(F);break;case"q":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=4)G.quadraticCurveTo(F.x+z[L+0],F.y+z[L+1],F.x+z[L+2],F.y+z[L+3]),R.x=F.x+z[L+0],R.y=F.y+z[L+1],F.x+=z[L+2],F.y+=z[L+3],L===0&&X===!0&&Z.copy(F);break;case"t":z=g(ce);for(let L=0,ge=z.length;L<ge;L+=2){const Fe=m(F.x,R.x),Gt=m(F.y,R.y);G.quadraticCurveTo(Fe,Gt,F.x+z[L+0],F.y+z[L+1]),R.x=Fe,R.y=Gt,F.x=F.x+z[L+0],F.y=F.y+z[L+1],L===0&&X===!0&&Z.copy(F)}break;case"a":z=g(ce,[3,4],7);for(let L=0,ge=z.length;L<ge;L+=7){if(z[L+5]==0&&z[L+6]==0)continue;const Fe=F.clone();F.x+=z[L+5],F.y+=z[L+6],R.x=F.x,R.y=F.y,a(G,z[L],z[L+1],z[L+2],z[L+3],z[L+4],Fe,F),L===0&&X===!0&&Z.copy(F)}break;case"Z":case"z":G.currentPath.autoClose=!0,G.currentPath.curves.length>0&&(F.copy(Z),G.currentPath.currentPoint.copy(F),ne=!0);break;default:console.warn(re)}X=!1}return G}function r(H){if(!(!H.sheet||!H.sheet.cssRules||!H.sheet.cssRules.length))for(let G=0;G<H.sheet.cssRules.length;G++){const F=H.sheet.cssRules[G];if(F.type!==1)continue;const R=F.selectorText.split(/,/gm).filter(Boolean).map(Z=>Z.trim());for(let Z=0;Z<R.length;Z++){const ne=Object.fromEntries(Object.entries(F.style).filter(([,X])=>X!==""));D[R[Z]]=Object.assign(D[R[Z]]||{},ne)}}}function a(H,G,F,R,Z,ne,X,ue){if(G==0||F==0){H.lineTo(ue.x,ue.y);return}R=R*Math.PI/180,G=Math.abs(G),F=Math.abs(F);const de=(X.x-ue.x)/2,pe=(X.y-ue.y)/2,$=Math.cos(R)*de+Math.sin(R)*pe,re=-Math.sin(R)*de+Math.cos(R)*pe;let _e=G*G,ce=F*F;const z=$*$,L=re*re,ge=z/_e+L/ce;if(ge>1){const os=Math.sqrt(ge);G=os*G,F=os*F,_e=G*G,ce=F*F}const Fe=_e*L+ce*z,Gt=(_e*ce-Fe)/Fe;let ai=Math.sqrt(Math.max(0,Gt));Z===ne&&(ai=-ai);const ht=ai*G*re/F,Di=-ai*F*$/G,rs=Math.cos(R)*ht-Math.sin(R)*Di+(X.x+ue.x)/2,Os=Math.sin(R)*ht+Math.cos(R)*Di+(X.y+ue.y)/2,Ki=c(1,0,($-ht)/G,(re-Di)/F),Ls=c(($-ht)/G,(re-Di)/F,(-$-ht)/G,(-re-Di)/F)%(Math.PI*2);H.currentPath.absellipse(rs,Os,G,F,Ki,Ki+Ls,ne===0,R)}function c(H,G,F,R){const Z=H*F+G*R,ne=Math.sqrt(H*H+G*G)*Math.sqrt(F*F+R*R);let X=Math.acos(Math.max(-1,Math.min(1,Z/ne)));return H*R-G*F<0&&(X=-X),X}function h(H){const G=E(H.getAttribute("x")||0),F=E(H.getAttribute("y")||0),R=E(H.getAttribute("rx")||H.getAttribute("ry")||0),Z=E(H.getAttribute("ry")||H.getAttribute("rx")||0),ne=E(H.getAttribute("width")),X=E(H.getAttribute("height")),ue=1-.551915024494,de=new mn;return de.moveTo(G+R,F),de.lineTo(G+ne-R,F),(R!==0||Z!==0)&&de.bezierCurveTo(G+ne-R*ue,F,G+ne,F+Z*ue,G+ne,F+Z),de.lineTo(G+ne,F+X-Z),(R!==0||Z!==0)&&de.bezierCurveTo(G+ne,F+X-Z*ue,G+ne-R*ue,F+X,G+ne-R,F+X),de.lineTo(G+R,F+X),(R!==0||Z!==0)&&de.bezierCurveTo(G+R*ue,F+X,G,F+X-Z*ue,G,F+X-Z),de.lineTo(G,F+Z),(R!==0||Z!==0)&&de.bezierCurveTo(G,F+Z*ue,G+R*ue,F,G+R,F),de}function d(H){function G(ne,X,ue){const de=E(X),pe=E(ue);Z===0?R.moveTo(de,pe):R.lineTo(de,pe),Z++}const F=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,R=new mn;let Z=0;return H.getAttribute("points").replace(F,G),R.currentPath.autoClose=!0,R}function l(H){function G(ne,X,ue){const de=E(X),pe=E(ue);Z===0?R.moveTo(de,pe):R.lineTo(de,pe),Z++}const F=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,R=new mn;let Z=0;return H.getAttribute("points").replace(F,G),R.currentPath.autoClose=!1,R}function A(H){const G=E(H.getAttribute("cx")||0),F=E(H.getAttribute("cy")||0),R=E(H.getAttribute("r")||0),Z=new Oo;Z.absarc(G,F,R,0,Math.PI*2);const ne=new mn;return ne.subPaths.push(Z),ne}function u(H){const G=E(H.getAttribute("cx")||0),F=E(H.getAttribute("cy")||0),R=E(H.getAttribute("rx")||0),Z=E(H.getAttribute("ry")||0),ne=new Oo;ne.absellipse(G,F,R,Z,0,Math.PI*2);const X=new mn;return X.subPaths.push(ne),X}function f(H){const G=E(H.getAttribute("x1")||0),F=E(H.getAttribute("y1")||0),R=E(H.getAttribute("x2")||0),Z=E(H.getAttribute("y2")||0),ne=new mn;return ne.moveTo(G,F),ne.lineTo(R,Z),ne.currentPath.autoClose=!1,ne}function p(H,G){G=Object.assign({},G);let F={};if(H.hasAttribute("class")){const X=H.getAttribute("class").split(/\s/).filter(Boolean).map(ue=>ue.trim());for(let ue=0;ue<X.length;ue++)F=Object.assign(F,D["."+X[ue]])}H.hasAttribute("id")&&(F=Object.assign(F,D["#"+H.getAttribute("id")]));function R(X,ue,de){de===void 0&&(de=function($){return $.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),$}),H.hasAttribute(X)&&(G[ue]=de(H.getAttribute(X))),F[X]&&(G[ue]=de(F[X])),H.style&&H.style[X]!==""&&(G[ue]=de(H.style[X]))}function Z(X){return Math.max(0,Math.min(1,E(X)))}function ne(X){return Math.max(0,E(X))}return R("fill","fill"),R("fill-opacity","fillOpacity",Z),R("fill-rule","fillRule"),R("opacity","opacity",Z),R("stroke","stroke"),R("stroke-opacity","strokeOpacity",Z),R("stroke-width","strokeWidth",ne),R("stroke-linejoin","strokeLineJoin"),R("stroke-linecap","strokeLineCap"),R("stroke-miterlimit","strokeMiterLimit",ne),R("visibility","visibility"),G}function m(H,G){return H-(G-H)}function g(H,G,F){if(typeof H!="string")throw new TypeError("Invalid input: "+typeof H);const R={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},Z=0,ne=1,X=2,ue=3;let de=Z,pe=!0,$="",re="";const _e=[];function ce(Fe,Gt,ai){const ht=new SyntaxError('Unexpected character "'+Fe+'" at index '+Gt+".");throw ht.partial=ai,ht}function z(){$!==""&&(re===""?_e.push(Number($)):_e.push(Number($)*Math.pow(10,Number(re)))),$="",re=""}let L;const ge=H.length;for(let Fe=0;Fe<ge;Fe++){if(L=H[Fe],Array.isArray(G)&&G.includes(_e.length%F)&&R.FLAGS.test(L)){de=ne,$=L,z();continue}if(de===Z){if(R.WHITESPACE.test(L))continue;if(R.DIGIT.test(L)||R.SIGN.test(L)){de=ne,$=L;continue}if(R.POINT.test(L)){de=X,$=L;continue}R.COMMA.test(L)&&(pe&&ce(L,Fe,_e),pe=!0)}if(de===ne){if(R.DIGIT.test(L)){$+=L;continue}if(R.POINT.test(L)){$+=L,de=X;continue}if(R.EXP.test(L)){de=ue;continue}R.SIGN.test(L)&&$.length===1&&R.SIGN.test($[0])&&ce(L,Fe,_e)}if(de===X){if(R.DIGIT.test(L)){$+=L;continue}if(R.EXP.test(L)){de=ue;continue}R.POINT.test(L)&&$[$.length-1]==="."&&ce(L,Fe,_e)}if(de===ue){if(R.DIGIT.test(L)){re+=L;continue}if(R.SIGN.test(L)){if(re===""){re+=L;continue}re.length===1&&R.SIGN.test(re)&&ce(L,Fe,_e)}}R.WHITESPACE.test(L)?(z(),de=Z,pe=!1):R.COMMA.test(L)?(z(),de=Z,pe=!0):R.SIGN.test(L)?(z(),de=ne,$=L):R.POINT.test(L)?(z(),de=X,$=L):ce(L,Fe,_e)}return z(),_e}const v=["mm","cm","in","pt","pc","px"],C={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function E(H){let G="px";if(typeof H=="string"||H instanceof String)for(let R=0,Z=v.length;R<Z;R++){const ne=v[R];if(H.endsWith(ne)){G=ne,H=H.substring(0,H.length-ne.length);break}}let F;return G==="px"&&i.defaultUnit!=="px"?F=C.in[i.defaultUnit]/i.defaultDPI:(F=C[G][i.defaultUnit],F<0&&(F=C[G].in*i.defaultDPI)),F*parseFloat(H)}function _(H){if(!(H.hasAttribute("transform")||H.nodeName==="use"&&(H.hasAttribute("x")||H.hasAttribute("y"))))return null;const G=B(H);return Q.length>0&&G.premultiply(Q[Q.length-1]),j.copy(G),Q.push(G),G}function B(H){const G=new kn,F=k;if(H.nodeName==="use"&&(H.hasAttribute("x")||H.hasAttribute("y"))){const R=E(H.getAttribute("x")),Z=E(H.getAttribute("y"));G.translate(R,Z)}if(H.hasAttribute("transform")){const R=H.getAttribute("transform").split(")");for(let Z=R.length-1;Z>=0;Z--){const ne=R[Z].trim();if(ne==="")continue;const X=ne.indexOf("("),ue=ne.length;if(X>0&&X<ue){const de=ne.slice(0,X),pe=g(ne.slice(X+1));switch(F.identity(),de){case"translate":if(pe.length>=1){const $=pe[0];let re=0;pe.length>=2&&(re=pe[1]),F.translate($,re)}break;case"rotate":if(pe.length>=1){let $=0,re=0,_e=0;$=pe[0]*Math.PI/180,pe.length>=3&&(re=pe[1],_e=pe[2]),te.makeTranslation(-re,-_e),W.makeRotation($),J.multiplyMatrices(W,te),te.makeTranslation(re,_e),F.multiplyMatrices(te,J)}break;case"scale":if(pe.length>=1){const $=pe[0];let re=$;pe.length>=2&&(re=pe[1]),F.scale($,re)}break;case"skewX":pe.length===1&&F.set(1,Math.tan(pe[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":pe.length===1&&F.set(1,0,0,Math.tan(pe[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":pe.length===6&&F.set(pe[0],pe[2],pe[4],pe[1],pe[3],pe[5],0,0,1);break}}G.premultiply(F)}}return G}function y(H,G){function F(X){ae.set(X.x,X.y,1).applyMatrix3(G),X.set(ae.x,ae.y)}function R(X){const ue=X.xRadius,de=X.yRadius,pe=Math.cos(X.aRotation),$=Math.sin(X.aRotation),re=new xe(ue*pe,ue*$,0),_e=new xe(-de*$,de*pe,0),ce=re.applyMatrix3(G),z=_e.applyMatrix3(G),L=k.set(ce.x,z.x,0,ce.y,z.y,0,0,0,1),ge=te.copy(L).invert(),ai=W.copy(ge).transpose().multiply(ge).elements,ht=O(ai[0],ai[1],ai[4]),Di=Math.sqrt(ht.rt1),rs=Math.sqrt(ht.rt2);if(X.xRadius=1/Di,X.yRadius=1/rs,X.aRotation=Math.atan2(ht.sn,ht.cs),!((X.aEndAngle-X.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const Ki=te.set(Di,0,0,0,rs,0,0,0,1),Ls=W.set(ht.cs,ht.sn,0,-ht.sn,ht.cs,0,0,0,1),os=Ki.multiply(Ls).multiply(L),Gr=An=>{const{x:bt,y:Ur}=new xe(Math.cos(An),Math.sin(An),0).applyMatrix3(os);return Math.atan2(Ur,bt)};X.aStartAngle=Gr(X.aStartAngle),X.aEndAngle=Gr(X.aEndAngle),x(G)&&(X.aClockwise=!X.aClockwise)}}function Z(X){const ue=b(G),de=P(G);X.xRadius*=ue,X.yRadius*=de;const pe=ue>Number.EPSILON?Math.atan2(G.elements[1],G.elements[0]):Math.atan2(-G.elements[3],G.elements[4]);X.aRotation+=pe,x(G)&&(X.aStartAngle*=-1,X.aEndAngle*=-1,X.aClockwise=!X.aClockwise)}const ne=H.subPaths;for(let X=0,ue=ne.length;X<ue;X++){const pe=ne[X].curves;for(let $=0;$<pe.length;$++){const re=pe[$];re.isLineCurve?(F(re.v1),F(re.v2)):re.isCubicBezierCurve?(F(re.v0),F(re.v1),F(re.v2),F(re.v3)):re.isQuadraticBezierCurve?(F(re.v0),F(re.v1),F(re.v2)):re.isEllipseCurve&&(ee.set(re.aX,re.aY),F(ee),re.aX=ee.x,re.aY=ee.y,w(G)?R(re):Z(re))}}}function x(H){const G=H.elements;return G[0]*G[4]-G[1]*G[3]<0}function w(H){const G=H.elements,F=G[0]*G[3]+G[1]*G[4];if(F===0)return!1;const R=b(H),Z=P(H);return Math.abs(F/(R*Z))>Number.EPSILON}function b(H){const G=H.elements;return Math.sqrt(G[0]*G[0]+G[1]*G[1])}function P(H){const G=H.elements;return Math.sqrt(G[3]*G[3]+G[4]*G[4])}function O(H,G,F){let R,Z,ne,X,ue;const de=H+F,pe=H-F,$=Math.sqrt(pe*pe+4*G*G);return de>0?(R=.5*(de+$),ue=1/R,Z=H*ue*F-G*ue*G):de<0?Z=.5*(de-$):(R=.5*$,Z=-.5*$),pe>0?ne=pe+$:ne=pe-$,Math.abs(ne)>2*Math.abs(G)?(ue=-2*G/ne,X=1/Math.sqrt(1+ue*ue),ne=ue*X):Math.abs(G)===0?(ne=1,X=0):(ue=-.5*ne/G,ne=1/Math.sqrt(1+ue*ue),X=ue*ne),pe>0&&(ue=ne,ne=-X,X=ue),{rt1:R,rt2:Z,cs:ne,sn:X}}const S=[],D={},Q=[],k=new kn,te=new kn,W=new kn,J=new kn,ee=new Ce,ae=new xe,j=new kn,Ee=new DOMParser().parseFromString(t,"image/svg+xml");return n(Ee.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:S,xml:Ee.documentElement}}static createShapes(t){const n={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},s={loc:n.ORIGIN,t:0};function r(m,g,v,C){const E=m.x,_=g.x,B=v.x,y=C.x,x=m.y,w=g.y,b=v.y,P=C.y,O=(y-B)*(x-b)-(P-b)*(E-B),S=(_-E)*(x-b)-(w-x)*(E-B),D=(P-b)*(_-E)-(y-B)*(w-x),Q=O/D,k=S/D;if(D===0&&O!==0||Q<=0||Q>=1||k<0||k>1)return null;if(O===0&&D===0){for(let te=0;te<2;te++)if(a(te===0?v:C,m,g),s.loc==n.ORIGIN){const W=te===0?v:C;return{x:W.x,y:W.y,t:s.t}}else if(s.loc==n.BETWEEN){const W=+(E+s.t*(_-E)).toPrecision(10),J=+(x+s.t*(w-x)).toPrecision(10);return{x:W,y:J,t:s.t}}return null}else{for(let J=0;J<2;J++)if(a(J===0?v:C,m,g),s.loc==n.ORIGIN){const ee=J===0?v:C;return{x:ee.x,y:ee.y,t:s.t}}const te=+(E+Q*(_-E)).toPrecision(10),W=+(x+Q*(w-x)).toPrecision(10);return{x:te,y:W,t:Q}}}function a(m,g,v){const C=v.x-g.x,E=v.y-g.y,_=m.x-g.x,B=m.y-g.y,y=C*B-_*E;if(m.x===g.x&&m.y===g.y){s.loc=n.ORIGIN,s.t=0;return}if(m.x===v.x&&m.y===v.y){s.loc=n.DESTINATION,s.t=1;return}if(y<-Number.EPSILON){s.loc=n.LEFT;return}if(y>Number.EPSILON){s.loc=n.RIGHT;return}if(C*_<0||E*B<0){s.loc=n.BEHIND;return}if(Math.sqrt(C*C+E*E)<Math.sqrt(_*_+B*B)){s.loc=n.BEYOND;return}let x;C!==0?x=_/C:x=B/E,s.loc=n.BETWEEN,s.t=x}function c(m,g){const v=[],C=[];for(let E=1;E<m.length;E++){const _=m[E-1],B=m[E];for(let y=1;y<g.length;y++){const x=g[y-1],w=g[y],b=r(_,B,x,w);b!==null&&v.find(P=>P.t<=b.t+Number.EPSILON&&P.t>=b.t-Number.EPSILON)===void 0&&(v.push(b),C.push(new Ce(b.x,b.y)))}}return C}function h(m,g,v){const C=new Ce;g.getCenter(C);const E=[];return v.forEach(_=>{_.boundingBox.containsPoint(C)&&c(m,_.points).forEach(y=>{E.push({identifier:_.identifier,isCW:_.isCW,point:y})})}),E.sort((_,B)=>_.point.x-B.point.x),E}function d(m,g,v,C,E){(E==null||E==="")&&(E="nonzero");const _=new Ce;m.boundingBox.getCenter(_);const B=[new Ce(v,_.y),new Ce(C,_.y)],y=h(B,m.boundingBox,g);y.sort((S,D)=>S.point.x-D.point.x);const x=[],w=[];y.forEach(S=>{S.identifier===m.identifier?x.push(S):w.push(S)});const b=x[0].point.x,P=[];let O=0;for(;O<w.length&&w[O].point.x<b;)P.length>0&&P[P.length-1]===w[O].identifier?P.pop():P.push(w[O].identifier),O++;if(P.push(m.identifier),E==="evenodd"){const S=P.length%2===0,D=P[P.length-2];return{identifier:m.identifier,isHole:S,for:D}}else if(E==="nonzero"){let S=!0,D=null,Q=null;for(let k=0;k<P.length;k++){const te=P[k];S?(Q=g[te].isCW,S=!1,D=te):Q!==g[te].isCW&&(Q=g[te].isCW,S=!0)}return{identifier:m.identifier,isHole:S,for:D}}else console.warn('fill-rule: "'+E+'" is currently not implemented.')}let l=999999999,A=-999999999,u=t.subPaths.map(m=>{const g=m.getPoints();let v=-999999999,C=999999999,E=-999999999,_=999999999;for(let B=0;B<g.length;B++){const y=g[B];y.y>v&&(v=y.y),y.y<C&&(C=y.y),y.x>E&&(E=y.x),y.x<_&&(_=y.x)}return A<=E&&(A=E+1),l>=_&&(l=_-1),{curves:m.curves,points:g,isCW:hf.isClockWise(g),identifier:-1,boundingBox:new Af(new Ce(_,C),new Ce(E,v))}});u=u.filter(m=>m.points.length>1);for(let m=0;m<u.length;m++)u[m].identifier=m;const f=u.map(m=>d(m,u,l,A,t.userData?t.userData.style.fillRule:void 0)),p=[];return u.forEach(m=>{if(!f[m.identifier].isHole){const v=new uf;v.curves=m.curves,f.filter(E=>E.isHole&&E.for===m.identifier).forEach(E=>{const _=u[E.identifier],B=new Oo;B.curves=_.curves,v.holes.push(B)}),p.push(v)}}),p}static getStrokeStyle(t,i,n,s,r){return t=t!==void 0?t:1,i=i!==void 0?i:"#000",n=n!==void 0?n:"miter",s=s!==void 0?s:"butt",r=r!==void 0?r:4,{strokeColor:i,strokeWidth:t,strokeLineJoin:n,strokeLineCap:s,strokeMiterLimit:r}}static pointsToStroke(t,i,n,s){const r=[],a=[],c=[];if(o.pointsToStrokeWithBuffers(t,i,n,s,r,a,c)===0)return null;const h=new sn;return h.setAttribute("position",new Nt(r,3)),h.setAttribute("normal",new Nt(a,3)),h.setAttribute("uv",new Nt(c,2)),h}static pointsToStrokeWithBuffers(t,i,n,s,r,a,c,h){const d=new Ce,l=new Ce,A=new Ce,u=new Ce,f=new Ce,p=new Ce,m=new Ce,g=new Ce,v=new Ce,C=new Ce,E=new Ce,_=new Ce,B=new Ce,y=new Ce,x=new Ce,w=new Ce,b=new Ce;n=n!==void 0?n:12,s=s!==void 0?s:.001,h=h!==void 0?h:0,t=pe(t);const P=t.length;if(P<2)return 0;const O=t[0].equals(t[P-1]);let S,D=t[0],Q;const k=i.strokeWidth/2,te=1/(P-1);let W=0,J,ee,ae,j,Ee=!1,Be=0,H=h*3,G=h*2;F(t[0],t[1],d).multiplyScalar(k),g.copy(t[0]).sub(d),v.copy(t[0]).add(d),C.copy(g),E.copy(v);for(let $=1;$<P;$++){S=t[$],$===P-1?O?Q=t[1]:Q=void 0:Q=t[$+1];const re=d;if(F(D,S,re),A.copy(re).multiplyScalar(k),_.copy(S).sub(A),B.copy(S).add(A),J=W+te,ee=!1,Q!==void 0){F(S,Q,l),A.copy(l).multiplyScalar(k),y.copy(S).sub(A),x.copy(S).add(A),ae=!0,A.subVectors(Q,D),re.dot(A)<0&&(ae=!1),$===1&&(Ee=ae),A.subVectors(Q,S),A.normalize();const _e=Math.abs(re.dot(A));if(_e>Number.EPSILON){const ce=k/_e;A.multiplyScalar(-ce),u.subVectors(S,D),f.copy(u).setLength(ce).add(A),w.copy(f).negate();const z=f.length(),L=u.length();u.divideScalar(L),p.subVectors(Q,S);const ge=p.length();switch(p.divideScalar(ge),u.dot(w)<L&&p.dot(w)<ge&&(ee=!0),b.copy(f).add(S),w.add(S),j=!1,ee?ae?(x.copy(w),B.copy(w)):(y.copy(w),_.copy(w)):ne(),i.strokeLineJoin){case"bevel":X(ae,ee,J);break;case"round":ue(ae,ee),ae?Z(S,_,y,J,0):Z(S,x,B,J,1);break;case"miter":case"miter-clip":default:const Fe=k*i.strokeMiterLimit/z;if(Fe<1)if(i.strokeLineJoin!=="miter-clip"){X(ae,ee,J);break}else ue(ae,ee),ae?(p.subVectors(b,_).multiplyScalar(Fe).add(_),m.subVectors(b,y).multiplyScalar(Fe).add(y),R(_,J,0),R(p,J,0),R(S,J,.5),R(S,J,.5),R(p,J,0),R(m,J,0),R(S,J,.5),R(m,J,0),R(y,J,0)):(p.subVectors(b,B).multiplyScalar(Fe).add(B),m.subVectors(b,x).multiplyScalar(Fe).add(x),R(B,J,1),R(p,J,1),R(S,J,.5),R(S,J,.5),R(p,J,1),R(m,J,1),R(S,J,.5),R(m,J,1),R(x,J,1));else ee?(ae?(R(v,W,1),R(g,W,0),R(b,J,0),R(v,W,1),R(b,J,0),R(w,J,1)):(R(v,W,1),R(g,W,0),R(b,J,1),R(g,W,0),R(w,J,0),R(b,J,1)),ae?y.copy(b):x.copy(b)):ae?(R(_,J,0),R(b,J,0),R(S,J,.5),R(S,J,.5),R(b,J,0),R(y,J,0)):(R(B,J,1),R(b,J,1),R(S,J,.5),R(S,J,.5),R(b,J,1),R(x,J,1)),j=!0;break}}else ne()}else ne();!O&&$===P-1&&de(t[0],C,E,ae,!0,W),W=J,D=S,g.copy(y),v.copy(x)}if(!O)de(S,_,B,ae,!1,J);else if(ee&&r){let $=b,re=w;Ee!==ae&&($=w,re=b),ae?(j||Ee)&&(re.toArray(r,0*3),re.toArray(r,3*3),j&&$.toArray(r,1*3)):(j||!Ee)&&(re.toArray(r,1*3),re.toArray(r,3*3),j&&$.toArray(r,0*3))}return Be;function F($,re,_e){return _e.subVectors(re,$),_e.set(-_e.y,_e.x).normalize()}function R($,re,_e){r&&(r[H]=$.x,r[H+1]=$.y,r[H+2]=0,a&&(a[H]=0,a[H+1]=0,a[H+2]=1),H+=3,c&&(c[G]=re,c[G+1]=_e,G+=2)),Be+=3}function Z($,re,_e,ce,z){d.copy(re).sub($).normalize(),l.copy(_e).sub($).normalize();let L=Math.PI;const ge=d.dot(l);Math.abs(ge)<1&&(L=Math.abs(Math.acos(ge))),L/=n,A.copy(re);for(let Fe=0,Gt=n-1;Fe<Gt;Fe++)u.copy(A).rotateAround($,L),R(A,ce,z),R(u,ce,z),R($,ce,.5),A.copy(u);R(u,ce,z),R(_e,ce,z),R($,ce,.5)}function ne(){R(v,W,1),R(g,W,0),R(_,J,0),R(v,W,1),R(_,J,0),R(B,J,1)}function X($,re,_e){re?$?(R(v,W,1),R(g,W,0),R(_,J,0),R(v,W,1),R(_,J,0),R(w,J,1),R(_,_e,0),R(y,_e,0),R(w,_e,.5)):(R(v,W,1),R(g,W,0),R(B,J,1),R(g,W,0),R(w,J,0),R(B,J,1),R(B,_e,1),R(w,_e,0),R(x,_e,1)):$?(R(_,_e,0),R(y,_e,0),R(S,_e,.5)):(R(B,_e,1),R(x,_e,0),R(S,_e,.5))}function ue($,re){re&&($?(R(v,W,1),R(g,W,0),R(_,J,0),R(v,W,1),R(_,J,0),R(w,J,1),R(_,W,0),R(S,J,.5),R(w,J,1),R(S,J,.5),R(y,W,0),R(w,J,1)):(R(v,W,1),R(g,W,0),R(B,J,1),R(g,W,0),R(w,J,0),R(B,J,1),R(B,W,1),R(w,J,0),R(S,J,.5),R(S,J,.5),R(w,J,0),R(x,W,1)))}function de($,re,_e,ce,z,L){switch(i.strokeLineCap){case"round":z?Z($,_e,re,L,.5):Z($,re,_e,L,.5);break;case"square":if(z)d.subVectors(re,$),l.set(d.y,-d.x),A.addVectors(d,l).add($),u.subVectors(l,d).add($),ce?(A.toArray(r,1*3),u.toArray(r,0*3),u.toArray(r,3*3)):(A.toArray(r,1*3),c[3*2+1]===1?u.toArray(r,3*3):A.toArray(r,3*3),u.toArray(r,0*3));else{d.subVectors(_e,$),l.set(d.y,-d.x),A.addVectors(d,l).add($),u.subVectors(l,d).add($);const ge=r.length;ce?(A.toArray(r,ge-1*3),u.toArray(r,ge-2*3),u.toArray(r,ge-4*3)):(u.toArray(r,ge-2*3),A.toArray(r,ge-1*3),u.toArray(r,ge-4*3))}break}}function pe($){let re=!1;for(let ce=1,z=$.length-1;ce<z;ce++)if($[ce].distanceTo($[ce+1])<s){re=!0;break}if(!re)return $;const _e=[];_e.push($[0]);for(let ce=1,z=$.length-1;ce<z;ce++)$[ce].distanceTo($[ce+1])>=s&&_e.push($[ce]);return _e.push($[$.length-1]),_e}}}return o})(),Bg=/^[og]\s*(.+)?/,yg=/^mtllib /,Ig=/^usemtl /,wg=/^usemap /,fc=new xe,Xo=new xe,pc=new xe,gc=new xe,hi=new xe;function xg(){const o={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(n,s){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const a={index:this.materials.length,name:n||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(c){const h={index:typeof c=="number"?c:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return h.clone=this.clone.bind(h),h}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(n){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),n&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return n&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},i&&i.name&&typeof i.clone=="function"){const n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseNormalIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseUVIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/2)*2},addVertex:function(e,t,i){const n=this.vertices,s=this.object.geometry.vertices;s.push(n[e+0],n[e+1],n[e+2]),s.push(n[t+0],n[t+1],n[t+2]),s.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const n=this.normals,s=this.object.geometry.normals;s.push(n[e+0],n[e+1],n[e+2]),s.push(n[t+0],n[t+1],n[t+2]),s.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(e,t,i){const n=this.vertices,s=this.object.geometry.normals;fc.fromArray(n,e),Xo.fromArray(n,t),pc.fromArray(n,i),hi.subVectors(pc,Xo),gc.subVectors(fc,Xo),hi.cross(gc),hi.normalize(),s.push(hi.x,hi.y,hi.z),s.push(hi.x,hi.y,hi.z),s.push(hi.x,hi.y,hi.z)},addColor:function(e,t,i){const n=this.colors,s=this.object.geometry.colors;n[e]!==void 0&&s.push(n[e+0],n[e+1],n[e+2]),n[t]!==void 0&&s.push(n[t+0],n[t+1],n[t+2]),n[i]!==void 0&&s.push(n[i+0],n[i+1],n[i+2])},addUV:function(e,t,i){const n=this.uvs,s=this.object.geometry.uvs;s.push(n[e+0],n[e+1]),s.push(n[t+0],n[t+1]),s.push(n[i+0],n[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,n,s,r,a,c,h){const d=this.vertices.length;let l=this.parseVertexIndex(e,d),A=this.parseVertexIndex(t,d),u=this.parseVertexIndex(i,d);if(this.addVertex(l,A,u),this.addColor(l,A,u),a!==void 0&&a!==""){const f=this.normals.length;l=this.parseNormalIndex(a,f),A=this.parseNormalIndex(c,f),u=this.parseNormalIndex(h,f),this.addNormal(l,A,u)}else this.addFaceNormal(l,A,u);if(n!==void 0&&n!==""){const f=this.uvs.length;l=this.parseUVIndex(n,f),A=this.parseUVIndex(s,f),u=this.parseUVIndex(r,f),this.addUV(l,A,u),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,n=e.length;i<n;i++){const s=this.parseVertexIndex(e[i],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,n=this.uvs.length;for(let s=0,r=e.length;s<r;s++)this.addVertexLine(this.parseVertexIndex(e[s],i));for(let s=0,r=t.length;s<r;s++)this.addUVLine(this.parseUVIndex(t[s],n))}};return o.startObject("",!1),o}class Mg extends ns{constructor(e){super(e),this.materials=null}load(e,t,i,n){const s=this,r=new Si(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(a){try{t(s.parse(a))}catch(c){n?n(c):console.error(c),s.manager.itemError(e)}},i,n)}setMaterials(e){return this.materials=e,this}parse(e){const t=new xg;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const i=e.split(`
`);let n="",s="",r=0,a=[];const c=typeof"".trimLeft=="function";for(let l=0,A=i.length;l<A;l++)if(n=i[l],n=c?n.trimLeft():n.trim(),r=n.length,r!==0&&(s=n.charAt(0),s!=="#"))if(s==="v"){const u=n.split(/\s+/);switch(u[0]){case"v":t.vertices.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),u.length>=7?t.colors.push(parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));break;case"vt":t.uvs.push(parseFloat(u[1]),parseFloat(u[2]));break}}else if(s==="f"){const f=n.substr(1).trim().split(/\s+/),p=[];for(let g=0,v=f.length;g<v;g++){const C=f[g];if(C.length>0){const E=C.split("/");p.push(E)}}const m=p[0];for(let g=1,v=p.length-1;g<v;g++){const C=p[g],E=p[g+1];t.addFace(m[0],C[0],E[0],m[1],C[1],E[1],m[2],C[2],E[2])}}else if(s==="l"){const u=n.substring(1).trim().split(" ");let f=[];const p=[];if(n.indexOf("/")===-1)f=u;else for(let m=0,g=u.length;m<g;m++){const v=u[m].split("/");v[0]!==""&&f.push(v[0]),v[1]!==""&&p.push(v[1])}t.addLineGeometry(f,p)}else if(s==="p"){const f=n.substr(1).trim().split(" ");t.addPointGeometry(f)}else if((a=Bg.exec(n))!==null){const u=(" "+a[0].substr(1).trim()).substr(1);t.startObject(u)}else if(Ig.test(n))t.object.startMaterial(n.substring(7).trim(),t.materialLibraries);else if(yg.test(n))t.materialLibraries.push(n.substring(7).trim());else if(wg.test(n))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(s==="s"){if(a=n.split(" "),a.length>1){const f=a[1].trim().toLowerCase();t.object.smooth=f!=="0"&&f!=="off"}else t.object.smooth=!0;const u=t.object.currentMaterial();u&&(u.smooth=t.object.smooth)}else{if(n==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+n+'"')}t.finalize();const h=new qn;if(h.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let l=0,A=t.objects.length;l<A;l++){const u=t.objects[l],f=u.geometry,p=u.materials,m=f.type==="Line",g=f.type==="Points";let v=!1;if(f.vertices.length===0)continue;const C=new sn;C.setAttribute("position",new Nt(f.vertices,3)),f.normals.length>0&&C.setAttribute("normal",new Nt(f.normals,3)),f.colors.length>0&&(v=!0,C.setAttribute("color",new Nt(f.colors,3))),f.hasUVIndices===!0&&C.setAttribute("uv",new Nt(f.uvs,2));const E=[];for(let B=0,y=p.length;B<y;B++){const x=p[B],w=x.name+"_"+x.smooth+"_"+v;let b=t.materials[w];if(this.materials!==null){if(b=this.materials.create(x.name),m&&b&&!(b instanceof ur)){const P=new ur;xn.prototype.copy.call(P,b),P.color.copy(b.color),b=P}else if(g&&b&&!(b instanceof or)){const P=new or({size:10,sizeAttenuation:!1});xn.prototype.copy.call(P,b),P.color.copy(b.color),P.map=b.map,b=P}}b===void 0&&(m?b=new ur:g?b=new or({size:1,sizeAttenuation:!1}):b=new no,b.name=x.name,b.flatShading=!x.smooth,b.vertexColors=v,t.materials[w]=b),E.push(b)}let _;if(E.length>1){for(let B=0,y=p.length;B<y;B++){const x=p[B];C.addGroup(x.groupStart,x.groupCount,B)}m?_=new Na(C,E):g?_=new io(C,E):_=new Ei(C,E)}else m?_=new Na(C,E[0]):g?_=new io(C,E[0]):_=new Ei(C,E[0]);_.name=u.name,h.add(_)}else if(t.vertices.length>0){const l=new or({size:1,sizeAttenuation:!1}),A=new sn;A.setAttribute("position",new Nt(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(A.setAttribute("color",new Nt(t.colors,3)),l.vertexColors=!0);const u=new io(A,l);h.add(u)}return h}}const Wo=new WeakMap;class Sg extends ns{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,n){const s=new Si(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,r=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(r,a).then(t).catch(n)},i,n)}decodeDracoFile(e,t,i,n){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const c in t.attributeTypes){const h=t.attributeTypes[c];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=h.name)}const i=JSON.stringify(t);if(Wo.has(e)){const c=Wo.get(e);if(c.key===i)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const s=this.workerNextTaskID++,r=e.byteLength,a=this._getWorker(s,r).then(c=>(n=c,new Promise((h,d)=>{n._callbacks[s]={resolve:h,reject:d},n.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{n&&s&&this._releaseTask(n,s)}),Wo.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new sn;e.index&&t.setIndex(new Yn(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const n=e.attributes[i],s=n.name,r=n.array,a=n.itemSize;t.setAttribute(s,new Yn(r,a))}return t}_loadLibrary(e,t){const i=new Si(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((n,s)=>{i.load(e,n,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const n=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Tg.toString(),r=["/* draco decoder */",n,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(s){const r=s.data;switch(r.type){case"decode":n._callbacks[r.id].resolve(r);break;case"error":n._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,s){return n._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Tg(){let o,e;onmessage=function(r){const a=r.data;switch(a.type){case"init":o=a.decoderConfig,e=new Promise(function(d){o.onModuleLoaded=function(l){d({draco:l})},DracoDecoderModule(o)});break;case"decode":const c=a.buffer,h=a.taskConfig;e.then(d=>{const l=d.draco,A=new l.Decoder,u=new l.DecoderBuffer;u.Init(new Int8Array(c),c.byteLength);try{const f=t(l,A,u,h),p=f.attributes.map(m=>m.array.buffer);f.index&&p.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},p)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{l.destroy(u),l.destroy(A)}});break}};function t(r,a,c,h){const d=h.attributeIDs,l=h.attributeTypes;let A,u;const f=a.GetEncodedGeometryType(c);if(f===r.TRIANGULAR_MESH)A=new r.Mesh,u=a.DecodeBufferToMesh(c,A);else if(f===r.POINT_CLOUD)A=new r.PointCloud,u=a.DecodeBufferToPointCloud(c,A);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!u.ok()||A.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+u.error_msg());const p={index:null,attributes:[]};for(const m in d){const g=self[l[m]];let v,C;if(h.useUniqueIDs)C=d[m],v=a.GetAttributeByUniqueId(A,C);else{if(C=a.GetAttributeId(A,r[d[m]]),C===-1)continue;v=a.GetAttribute(A,C)}p.attributes.push(n(r,a,A,m,g,v))}return f===r.TRIANGULAR_MESH&&(p.index=i(r,a,A)),r.destroy(A),p}function i(r,a,c){const d=c.num_faces()*3,l=d*4,A=r._malloc(l);a.GetTrianglesUInt32Array(c,l,A);const u=new Uint32Array(r.HEAPF32.buffer,A,d).slice();return r._free(A),{array:u,itemSize:1}}function n(r,a,c,h,d,l){const A=l.num_components(),f=c.num_points()*A,p=f*d.BYTES_PER_ELEMENT,m=s(r,d),g=r._malloc(p);a.GetAttributeDataArrayForAllPoints(c,l,m,p,g);const v=new d(r.HEAPF32.buffer,g,f).slice();return r._free(g),{name:h,array:v,itemSize:A}}function s(r,a){switch(a){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}let Jr;const bg=()=>{if(Jr)return Jr;const o="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",e="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",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let n=o;WebAssembly.validate(t)&&(n=e);let s;const r=WebAssembly.instantiate(a(n),{}).then(l=>{s=l.instance,s.exports.__wasm_call_ctors()});function a(l){const A=new Uint8Array(l.length);for(let f=0;f<l.length;++f){const p=l.charCodeAt(f);A[f]=p>96?p-71:p>64?p-65:p>47?p+4:p>46?63:62}let u=0;for(let f=0;f<l.length;++f)A[u++]=A[f]<60?i[A[f]]:(A[f]-60)*64+A[++f];return A.buffer.slice(0,u)}function c(l,A,u,f,p,m){const g=s.exports.sbrk,v=u+3&-4,C=g(v*f),E=g(p.length),_=new Uint8Array(s.exports.memory.buffer);_.set(p,E);const B=l(C,u,f,E,p.length);if(B===0&&m&&m(C,v,f),A.set(_.subarray(C,C+u*f)),g(C-g(0)),B!==0)throw new Error(`Malformed buffer data: ${B}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},d={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Jr={ready:r,supported:!0,decodeVertexBuffer(l,A,u,f,p){c(s.exports.meshopt_decodeVertexBuffer,l,A,u,f,s.exports[h[p]])},decodeIndexBuffer(l,A,u,f){c(s.exports.meshopt_decodeIndexBuffer,l,A,u,f)},decodeIndexSequence(l,A,u,f){c(s.exports.meshopt_decodeIndexSequence,l,A,u,f)},decodeGltfBuffer(l,A,u,f,p,m){c(s.exports[d[p]],l,A,u,f,s.exports[h[m]])}},Jr},Dg=`

	// Without original size argument for power of two targets
	vec4 packedTexture2DLOD( sampler2D tex, vec2 uv, int level ) {

		// the fraction of the uv space used by the target mip
		float targetSubview = 1.0 / pow( 2.0, float( level ) );
		float widthRatio = 2.0 / 3.0;
		vec2 scaledDimensions = vec2( targetSubview * widthRatio, targetSubview );

		// all levels > 0 are on the right third of the texture
		// y is offset from the bottom
		vec2 offset = vec2(
			level > 0 ? widthRatio : 0.0,
			level > 0 ? targetSubview : 0.0
		);

		vec2 samplePoint = mix( offset, offset + scaledDimensions, uv );
		return texture2D( tex, samplePoint );

	}

	vec4 packedTexture2DLOD( sampler2D tex, vec2 uv, float level ) {

		float ratio = mod( level, 1.0 );
		int minLevel = int( floor( level ) );
		int maxLevel = int( ceil( level ) );

		vec4 minValue = packedTexture2DLOD( tex, uv, minLevel );
		vec4 maxValue = packedTexture2DLOD( tex, uv, maxLevel );

		return mix( minValue, maxValue, ratio );

	}

	// With original size argument
	vec4 packedTexture2DLOD( sampler2D tex, vec2 uv, int level, vec2 originalPixelSize ) {

		float floatLevel = float( level );
		vec2 atlasSize;
		atlasSize.x = floor( originalPixelSize.x * 1.5 );
		atlasSize.y = originalPixelSize.y;

		// we stop making mip maps when one dimension == 1
		float maxLevel = min( floor( log2( originalPixelSize.x ) ), floor( log2( originalPixelSize.y ) ) );
		floatLevel = min( floatLevel, maxLevel );

		// use inverse pow of 2 to simulate right bit shift operator
		vec2 currentPixelDimensions = floor( originalPixelSize / pow( 2.0, floatLevel ) );
		vec2 pixelOffset = vec2(
			floatLevel > 0.0 ? originalPixelSize.x : 0.0,
			floatLevel > 0.0 ? currentPixelDimensions.y : 0.0
		);

		// "minPixel / atlasSize" samples the top left piece of the first pixel
		// "maxPixel / atlasSize" samples the bottom right piece of the last pixel
		vec2 minPixel = pixelOffset;
		vec2 maxPixel = pixelOffset + currentPixelDimensions;
		vec2 samplePoint = mix( minPixel, maxPixel, uv );
		samplePoint /= atlasSize;

		vec2 halfPixelSize = 1.0 / ( 2.0 * atlasSize );
		samplePoint = min( samplePoint, maxPixel / atlasSize - halfPixelSize );
		samplePoint = max( samplePoint, minPixel / atlasSize + halfPixelSize );

		return texture2D( tex, samplePoint );

	}

	vec4 packedTexture2DLOD( sampler2D tex, vec2 uv, float level, vec2 originalPixelSize ) {

		float ratio = mod( level, 1.0 );
		int minLevel = int( floor( level ) );
		int maxLevel = int( ceil( level ) );

		vec4 minValue = packedTexture2DLOD( tex, uv, minLevel, originalPixelSize );
		vec4 maxValue = packedTexture2DLOD( tex, uv, maxLevel, originalPixelSize );

		return mix( minValue, maxValue, ratio );

	}

`;function Vs(o){const e={...o};return"defines"in o&&(e.defines={...o.defines}),"uniforms"in o&&(e.uniforms=eh.clone(o.uniforms)),e}const Rg={defines:{X_IS_EVEN:1,Y_IS_EVEN:1},uniforms:{map:{value:null},originalMapSize:{value:new Ce},parentMapSize:{value:new Ce},parentLevel:{value:0}},vertexShader:`
		varying vec2 vUv;
		void main() {

			#include <begin_vertex>
			#include <project_vertex>
			vUv = uv;

		}
	`,fragmentShader:`
		varying vec2 vUv;
		uniform sampler2D map;
		uniform int parentLevel;
		uniform vec2 parentMapSize;
		uniform vec2 originalMapSize;

		${Dg}

		#if X_IS_EVEN && Y_IS_EVEN

		#define SAMPLES 4
		#define WIDTH 2
		#define HEIGHT 2

		#elif X_IS_EVEN

		#define SAMPLES 6
		#define WIDTH 2
		#define HEIGHT 3

		#elif Y_IS_EVEN

		#define SAMPLES 6
		#define WIDTH 3
		#define HEIGHT 2

		#else

		#define SAMPLES 9
		#define WIDTH 3
		#define HEIGHT 3

		#endif

		vec4 sampleAt( vec2 uv ) {

			return packedTexture2DLOD( map, uv, parentLevel, originalMapSize );

		}

		void main() {

			vec2 childMapSize = parentMapSize / 2.0;
			// vec2 childPixelSize = 1.0 / childMapSize;
			// vec2 halfChildPixelSize = childPixelSize / 2.0;
			vec2 childPixelPos = floor( vUv * childMapSize );

			vec2 parentPixelSize = 1.0 / parentMapSize;
			vec2 halfParentPixelSize = parentPixelSize / 2.0;
			vec2 parentPixelPos = childPixelPos * 2.0;

			vec2 baseUv = ( parentPixelPos / parentMapSize ) + halfParentPixelSize;

			vec4 samples[ SAMPLES ];
			float weights[ SAMPLES ];

			#if X_IS_EVEN && Y_IS_EVEN

			samples[ 0 ] = sampleAt( baseUv );
			samples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );
			samples[ 2 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );
			samples[ 3 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );

			weights[ 0 ] = 0.25;
			weights[ 1 ] = 0.25;
			weights[ 2 ] = 0.25;
			weights[ 3 ] = 0.25;

			#elif X_IS_EVEN

			float wx0 = 0.5;
			float wx1 = 0.5;

			float yden = 2.0 * parentMapSize.y + 1.0;
			float wy0 = ( parentMapSize.y - parentPixelPos.y ) / yden;
			float wy1 = ( parentMapSize.y ) / yden;
			float wy2 = ( parentPixelPos.y + 1.0 ) / yden;

			samples[ 0 ] = sampleAt( baseUv );
			samples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );

			samples[ 2 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );
			samples[ 3 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );

			samples[ 4 ] = sampleAt( baseUv + vec2( 0.0, 2.0 * parentPixelSize.y ) );
			samples[ 5 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 2.0 * parentPixelSize.y ) );

			weights[ 0 ] = wx0 * wy0;
			weights[ 1 ] = wx1 * wy0;

			weights[ 2 ] = wx0 * wy1;
			weights[ 3 ] = wx1 * wy1;

			weights[ 4 ] = wx0 * wy2;
			weights[ 5 ] = wx1 * wy2;

			#elif Y_IS_EVEN

			float xden = 2.0 * parentMapSize.x + 1.0;
			float wx0 = ( parentMapSize.x - parentPixelPos.x ) / xden;
			float wx1 = ( parentMapSize.x ) / xden;
			float wx2 = ( parentPixelPos.x + 1.0 ) / xden;

			float wy0 = 0.5;
			float wy1 = 0.5;

			samples[ 0 ] = sampleAt( baseUv );
			samples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );
			samples[ 2 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 0.0 ) );

			samples[ 3 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );
			samples[ 4 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );
			samples[ 5 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, parentPixelSize.y ) );

			weights[ 0 ] = wx0 * wy0;
			weights[ 1 ] = wx1 * wy0;
			weights[ 2 ] = wx2 * wy0;

			weights[ 3 ] = wx0 * wy1;
			weights[ 4 ] = wx1 * wy1;
			weights[ 5 ] = wx2 * wy1;

			#else

			float xden = 2.0 * parentMapSize.x + 1.0;
			float wx0 = ( parentMapSize.x - parentPixelPos.x ) / xden;
			float wx1 = ( parentMapSize.x ) / xden;
			float wx2 = ( parentPixelPos.x + 1.0 ) / xden;

			float yden = 2.0 * parentMapSize.y + 1.0;
			float wy0 = ( parentMapSize.y - parentPixelPos.y ) / yden;
			float wy1 = ( parentMapSize.y ) / yden;
			float wy2 = ( parentPixelPos.y + 1.0 ) / yden;

			samples[ 0 ] = sampleAt( baseUv );
			samples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );
			samples[ 2 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 0.0 ) );

			samples[ 3 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );
			samples[ 4 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );
			samples[ 5 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, parentPixelSize.y ) );

			samples[ 6 ] = sampleAt( baseUv + vec2( 0.0, 2.0 * parentPixelSize.y ) );
			samples[ 7 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 2.0 * parentPixelSize.y ) );
			samples[ 8 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 2.0 * parentPixelSize.y ) );

			weights[ 0 ] = wx0 * wy0;
			weights[ 1 ] = wx1 * wy0;
			weights[ 2 ] = wx2 * wy0;

			weights[ 3 ] = wx0 * wy1;
			weights[ 4 ] = wx1 * wy1;
			weights[ 5 ] = wx2 * wy1;

			weights[ 6 ] = wx0 * wy2;
			weights[ 7 ] = wx1 * wy2;
			weights[ 8 ] = wx2 * wy2;

			#endif

			<mipmap_logic>

		}
	`},mc=new Te;class Qg{constructor(e=""){N(this,"_swapTarget");N(this,"_copyQuad");N(this,"_mipQuad");N(this,"_mipMaterials");e||(e=`

				#pragma unroll_loop
				for ( int i = 0; i < SAMPLES; i ++ ) {

					gl_FragColor += samples[ i ] * weights[ i ];

				}

			`);const t=Vs(Rg);t.fragmentShader=t.fragmentShader.replace(/<mipmap_logic>/g,e);const i=new Array(4);i[0]=new Qt(Vs(t)),i[0].defines.X_IS_EVEN=0,i[0].defines.Y_IS_EVEN=0,i[1]=new Qt(Vs(t)),i[1].defines.X_IS_EVEN=1,i[1].defines.Y_IS_EVEN=0,i[2]=new Qt(Vs(t)),i[2].defines.X_IS_EVEN=0,i[2].defines.Y_IS_EVEN=1,i[3]=new Qt(Vs(t)),i[3].defines.X_IS_EVEN=1,i[3].defines.Y_IS_EVEN=1;const n=new Bi;n.texture.minFilter=es,n.texture.magFilter=es,this._swapTarget=n,this._copyQuad=new qa(new Qt(rp)),this._mipQuad=new qa(null),this._mipMaterials=i}update(e,t,i,n=!1){e.isWebGLRenderTarget&&(e=e.texture);const s=i.autoClear,r=i.getClearAlpha(),a=i.getRenderTarget();i.getClearColor(mc);const c=this._copyQuad,h=this._mipQuad,d=this._swapTarget,l=this._mipMaterials;let A,u;n?(A=Mt.floorPowerOfTwo(e.image.width),u=Mt.floorPowerOfTwo(e.image.height)):(A=Math.floor(e.image.width),u=Math.floor(e.image.height));const f=Math.floor(A*1.5),p=Math.floor(u);t.setSize(f,p),d.texture.type!==t.texture.type?(d.dispose(),d.copy(t),d.texture.image={...d.texture.image}):d.setSize(f,p),i.autoClear=!1,i.setClearColor(0),i.setClearAlpha(),c.material.uniforms.tDiffuse.value=e,c.camera.setViewOffset(A,u,0,0,f,p),i.setRenderTarget(t),i.clear(),c.render(i),i.setRenderTarget(d),i.clear(),c.render(i);let m=A,g=u,v=0;for(;m>1&&g>1;){const _=(m%2===0?1:0)|(g%2===0?2:0),B=l[_];B.uniforms.map.value=d.texture,B.uniforms.parentLevel.value=v,B.uniforms.parentMapSize.value.set(m,g),B.uniforms.originalMapSize.value.set(A,u),h.material=B,m=Math.floor(m/2),g=Math.floor(g/2);const y=p-2*g;i.setRenderTarget(t),h.camera.setViewOffset(m,g,-A,-y,f,p),h.render(i),i.setRenderTarget(d),B.uniforms.map.value=t.texture,h.render(i),v++}return i.setRenderTarget(a),i.setClearAlpha(r),i.setClearColor(mc),i.autoClear=s,v+1}dispose(){this._swapTarget.dispose(),this._mipQuad.dispose(),this._copyQuad.dispose(),this._mipMaterials.forEach(e=>e.dispose())}}var Ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qr(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var so={exports:{}},Fg=so.exports,vc;function Og(){return vc||(vc=1,function(o){(function(e){function t(_,B){var y=(_&65535)+(B&65535),x=(_>>16)+(B>>16)+(y>>16);return x<<16|y&65535}function i(_,B){return _<<B|_>>>32-B}function n(_,B,y,x,w,b){return t(i(t(t(B,_),t(x,b)),w),y)}function s(_,B,y,x,w,b,P){return n(B&y|~B&x,_,B,w,b,P)}function r(_,B,y,x,w,b,P){return n(B&x|y&~x,_,B,w,b,P)}function a(_,B,y,x,w,b,P){return n(B^y^x,_,B,w,b,P)}function c(_,B,y,x,w,b,P){return n(y^(B|~x),_,B,w,b,P)}function h(_,B){_[B>>5]|=128<<B%32,_[(B+64>>>9<<4)+14]=B;var y,x,w,b,P,O=1732584193,S=-271733879,D=-1732584194,Q=271733878;for(y=0;y<_.length;y+=16)x=O,w=S,b=D,P=Q,O=s(O,S,D,Q,_[y],7,-680876936),Q=s(Q,O,S,D,_[y+1],12,-389564586),D=s(D,Q,O,S,_[y+2],17,606105819),S=s(S,D,Q,O,_[y+3],22,-1044525330),O=s(O,S,D,Q,_[y+4],7,-176418897),Q=s(Q,O,S,D,_[y+5],12,1200080426),D=s(D,Q,O,S,_[y+6],17,-1473231341),S=s(S,D,Q,O,_[y+7],22,-45705983),O=s(O,S,D,Q,_[y+8],7,1770035416),Q=s(Q,O,S,D,_[y+9],12,-1958414417),D=s(D,Q,O,S,_[y+10],17,-42063),S=s(S,D,Q,O,_[y+11],22,-1990404162),O=s(O,S,D,Q,_[y+12],7,1804603682),Q=s(Q,O,S,D,_[y+13],12,-40341101),D=s(D,Q,O,S,_[y+14],17,-1502002290),S=s(S,D,Q,O,_[y+15],22,1236535329),O=r(O,S,D,Q,_[y+1],5,-165796510),Q=r(Q,O,S,D,_[y+6],9,-1069501632),D=r(D,Q,O,S,_[y+11],14,643717713),S=r(S,D,Q,O,_[y],20,-373897302),O=r(O,S,D,Q,_[y+5],5,-701558691),Q=r(Q,O,S,D,_[y+10],9,38016083),D=r(D,Q,O,S,_[y+15],14,-660478335),S=r(S,D,Q,O,_[y+4],20,-405537848),O=r(O,S,D,Q,_[y+9],5,568446438),Q=r(Q,O,S,D,_[y+14],9,-1019803690),D=r(D,Q,O,S,_[y+3],14,-187363961),S=r(S,D,Q,O,_[y+8],20,1163531501),O=r(O,S,D,Q,_[y+13],5,-1444681467),Q=r(Q,O,S,D,_[y+2],9,-51403784),D=r(D,Q,O,S,_[y+7],14,1735328473),S=r(S,D,Q,O,_[y+12],20,-1926607734),O=a(O,S,D,Q,_[y+5],4,-378558),Q=a(Q,O,S,D,_[y+8],11,-2022574463),D=a(D,Q,O,S,_[y+11],16,1839030562),S=a(S,D,Q,O,_[y+14],23,-35309556),O=a(O,S,D,Q,_[y+1],4,-1530992060),Q=a(Q,O,S,D,_[y+4],11,1272893353),D=a(D,Q,O,S,_[y+7],16,-155497632),S=a(S,D,Q,O,_[y+10],23,-1094730640),O=a(O,S,D,Q,_[y+13],4,681279174),Q=a(Q,O,S,D,_[y],11,-358537222),D=a(D,Q,O,S,_[y+3],16,-722521979),S=a(S,D,Q,O,_[y+6],23,76029189),O=a(O,S,D,Q,_[y+9],4,-640364487),Q=a(Q,O,S,D,_[y+12],11,-421815835),D=a(D,Q,O,S,_[y+15],16,530742520),S=a(S,D,Q,O,_[y+2],23,-995338651),O=c(O,S,D,Q,_[y],6,-198630844),Q=c(Q,O,S,D,_[y+7],10,1126891415),D=c(D,Q,O,S,_[y+14],15,-1416354905),S=c(S,D,Q,O,_[y+5],21,-57434055),O=c(O,S,D,Q,_[y+12],6,1700485571),Q=c(Q,O,S,D,_[y+3],10,-1894986606),D=c(D,Q,O,S,_[y+10],15,-1051523),S=c(S,D,Q,O,_[y+1],21,-2054922799),O=c(O,S,D,Q,_[y+8],6,1873313359),Q=c(Q,O,S,D,_[y+15],10,-30611744),D=c(D,Q,O,S,_[y+6],15,-1560198380),S=c(S,D,Q,O,_[y+13],21,1309151649),O=c(O,S,D,Q,_[y+4],6,-145523070),Q=c(Q,O,S,D,_[y+11],10,-1120210379),D=c(D,Q,O,S,_[y+2],15,718787259),S=c(S,D,Q,O,_[y+9],21,-343485551),O=t(O,x),S=t(S,w),D=t(D,b),Q=t(Q,P);return[O,S,D,Q]}function d(_){var B,y="",x=_.length*32;for(B=0;B<x;B+=8)y+=String.fromCharCode(_[B>>5]>>>B%32&255);return y}function l(_){var B,y=[];for(y[(_.length>>2)-1]=void 0,B=0;B<y.length;B+=1)y[B]=0;var x=_.length*8;for(B=0;B<x;B+=8)y[B>>5]|=(_.charCodeAt(B/8)&255)<<B%32;return y}function A(_){return d(h(l(_),_.length*8))}function u(_,B){var y,x=l(_),w=[],b=[],P;for(w[15]=b[15]=void 0,x.length>16&&(x=h(x,_.length*8)),y=0;y<16;y+=1)w[y]=x[y]^909522486,b[y]=x[y]^1549556828;return P=h(w.concat(l(B)),512+B.length*8),d(h(b.concat(P),640))}function f(_){var B="0123456789abcdef",y="",x,w;for(w=0;w<_.length;w+=1)x=_.charCodeAt(w),y+=B.charAt(x>>>4&15)+B.charAt(x&15);return y}function p(_){return unescape(encodeURIComponent(_))}function m(_){return A(p(_))}function g(_){return f(m(_))}function v(_,B){return u(p(_),p(B))}function C(_,B){return f(v(_,B))}function E(_,B,y){return B?y?v(B,_):C(B,_):y?m(_):g(_)}o.exports?o.exports=E:e.md5=E})(Fg)}(so)),so.exports}var Lg=Og();const Pg=Qr(Lg),$e={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive"},Gg={[`${$e.normal}`]:{"#include <beginnormal_vertex>":`
    vec3 objectNormal = ${$e.normal};
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `},[`${$e.position}`]:{"#include <begin_vertex>":`
    vec3 transformed = ${$e.position};
  `},[`${$e.positionRaw}`]:{"#include <begin_vertex>":`
    vec4 csm_positionUnprojected = ${$e.positionRaw};
    mat4x4 csm_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_unprojectMatrix = csm_unprojectMatrix * instanceMatrix;
    #endif
    csm_positionUnprojected = inverse(csm_unprojectMatrix) * csm_positionUnprojected;
    vec3 transformed = csm_positionUnprojected.xyz;
  `},[`${$e.pointSize}`]:{"gl_PointSize = size;":`
    gl_PointSize = ${$e.pointSize};
    `},[`${$e.diffuseColor}`]:{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = ${$e.diffuseColor};
  `},[`${$e.fragColor}`]:{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = ${$e.fragColor};
  `},[`${$e.emissive}`]:{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = ${$e.emissive};
    `},[`${$e.roughness}`]:{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = ${$e.roughness};
    `},[`${$e.metalness}`]:{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = ${$e.metalness};
    `}},Ug={[`${$e.position}`]:{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( ${$e.position}, 1.0 );
  `},[`${$e.positionRaw}`]:{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = ${$e.position};
  `},[`${$e.diffuseColor}`]:{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = ${$e.diffuseColor};
  `},[`${$e.fragColor}`]:{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = ${$e.fragColor};
  `}};var jo,_c;function Oh(){return _c||(_c=1,jo=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]),jo}var Zo,Cc;function kg(){return Cc||(Cc=1,Zo=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]),Zo}var $o,Ec;function Lh(){return Ec||(Ec=1,$o=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]),$o}var ea,Bc;function Ng(){if(Bc)return ea;Bc=1;var o=Oh();return ea=o.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),ea}var ta,yc;function Hg(){if(yc)return ta;yc=1;var o=Lh();return o=o.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),ta=o.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),ta}var ia,Ic;function zg(){if(Ic)return ia;Ic=1,ia=E;var o=Oh(),e=kg(),t=Lh(),i=Ng(),n=Hg(),s=999,r=9999,a=0,c=1,h=2,d=3,l=4,A=5,u=6,f=7,p=8,m=9,g=10,v=11,C=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function E(_){var B=0,y=0,x=s,w,b,P=[],O=[],S=1,D=0,Q=0,k=!1,te=!1,W="",J;_=_||{};var ee=t,ae=o;_.version==="300 es"&&(ee=n,ae=i);for(var j={},Ee={},B=0;B<ee.length;B++)j[ee[B]]=!0;for(var B=0;B<ae.length;B++)Ee[ae[B]]=!0;return function(ce){return O=[],ce!==null?H(ce):G()};function Be(ce){ce.length&&O.push({type:C[x],data:ce,position:Q,line:S,column:D})}function H(ce){B=0,ce.toString&&(ce=ce.toString()),W+=ce.replace(/\r\n/g,`
`),J=W.length;for(var z;w=W[B],B<J;){switch(z=B,x){case a:B=X();break;case c:B=ne();break;case h:B=Z();break;case d:B=ue();break;case l:B=$();break;case v:B=pe();break;case A:B=re();break;case r:B=_e();break;case m:B=R();break;case s:B=F();break}if(z!==B)switch(W[z]){case`
`:D=0,++S;break;default:++D;break}}return y+=B,W=W.slice(B),O}function G(ce){return P.length&&Be(P.join("")),x=g,Be("(eof)"),O}function F(){return P=P.length?[]:P,b==="/"&&w==="*"?(Q=y+B-1,x=a,b=w,B+1):b==="/"&&w==="/"?(Q=y+B-1,x=c,b=w,B+1):w==="#"?(x=h,Q=y+B,B):/\s/.test(w)?(x=m,Q=y+B,B):(k=/\d/.test(w),te=/[^\w_]/.test(w),Q=y+B,x=k?l:te?d:r,B)}function R(){return/[^\s]/g.test(w)?(Be(P.join("")),x=s,B):(P.push(w),b=w,B+1)}function Z(){return(w==="\r"||w===`
`)&&b!=="\\"?(Be(P.join("")),x=s,B):(P.push(w),b=w,B+1)}function ne(){return Z()}function X(){return w==="/"&&b==="*"?(P.push(w),Be(P.join("")),x=s,B+1):(P.push(w),b=w,B+1)}function ue(){if(b==="."&&/\d/.test(w))return x=A,B;if(b==="/"&&w==="*")return x=a,B;if(b==="/"&&w==="/")return x=c,B;if(w==="."&&P.length){for(;de(P););return x=A,B}if(w===";"||w===")"||w==="("){if(P.length)for(;de(P););return Be(w),x=s,B+1}var ce=P.length===2&&w!=="=";if(/[\w_\d\s]/.test(w)||ce){for(;de(P););return x=s,B}return P.push(w),b=w,B+1}function de(ce){var z=0,L,ge;do{if(L=e.indexOf(ce.slice(0,ce.length+z).join("")),ge=e[L],L===-1){if(z--+ce.length>0)continue;ge=ce.slice(0,1).join("")}return Be(ge),Q+=ge.length,P=P.slice(ge.length),P.length}while(!0)}function pe(){return/[^a-fA-F0-9]/.test(w)?(Be(P.join("")),x=s,B):(P.push(w),b=w,B+1)}function $(){return w==="."||/[eE]/.test(w)?(P.push(w),x=A,b=w,B+1):w==="x"&&P.length===1&&P[0]==="0"?(x=v,P.push(w),b=w,B+1):/[^\d]/.test(w)?(Be(P.join("")),x=s,B):(P.push(w),b=w,B+1)}function re(){return w==="f"&&(P.push(w),b=w,B+=1),/[eE]/.test(w)||(w==="-"||w==="+")&&/[eE]/.test(b)?(P.push(w),b=w,B+1):/[^\d]/.test(w)?(Be(P.join("")),x=s,B):(P.push(w),b=w,B+1)}function _e(){if(/[^\d\w_]/.test(w)){var ce=P.join("");return Ee[ce]?x=p:j[ce]?x=f:x=u,Be(P.join("")),x=s,B}return P.push(w),b=w,B+1}}return ia}var na,wc;function Jg(){if(wc)return na;wc=1;var o=zg();na=e;function e(t,i){var n=o(i),s=[];return s=s.concat(n(t)),s=s.concat(n(null)),s}return na}var Vg=Jg();const Kg=Qr(Vg);var sa,xc;function Yg(){if(xc)return sa;xc=1,sa=o;function o(e){for(var t=[],i=0;i<e.length;i++)e[i].type!=="eof"&&t.push(e[i].data);return t.join("")}return sa}var qg=Yg();const Mc=Qr(qg);var ra,Sc;function Xg(){if(Sc)return ra;Sc=1,ra=o;function o(i){var n=null,s=null,r=0,a=0,c=0,h=0,d=0,l=[],A,u,f;for(A=0,u;A<i.length;A++)if(f=i[A],f.data==="{"){if(r&&r++||(u=m(A,e(")"),e()),u<0)||(h=u,u=m(u,e("("),e(")")),u<0)||(d=u,u=m(u,t),u<0)||i[u].type!=="ident"||(s=i[u].data,u=m(u,t),u<0))continue;r=1,a=A,n=i[u].data,c=u;var p=m(u,t);switch(i[p]&&i[p].data){case"lowp":case"highp":case"mediump":c=p}}else if(r&&f.data==="}"){if(--r)continue;l.push({name:s,type:n,body:[a+1,A],args:[d,h+1],outer:[c,A+1]})}for(A=0;A<i.length;A++)if(f=i[A],f.data===";"){if(u=m(A,e(")"),e()),u<0||(h=u,u=m(u,e("("),e(")")),u<0)||(d=u,u=m(u,t),u<0)||i[u].type!=="ident"||(s=i[u].data,u=m(u,t),u<0)||i[u].type==="operator"||i[u].data==="return")continue;n=i[u].data,l.push({name:s,type:n,body:!1,args:[d,h+1],outer:[u,A+1]})}return l.sort(function(g,v){return g.outer[0]-v.outer[0]});function m(g,v,C){for(var E=g-1;E>=0;E--){if(v(i[E]))return E;if(C&&C(i[E]))return-1}return-1}}function e(i){return function(n){return n.type==="operator"&&(!i||n.data===i)}}function t(i){return i.type!=="whitespace"}return ra}var Wg=Xg();const jg=Qr(Wg),Zg=`

#ifdef IS_VERTEX
    vec3 csm_Position = position;
    vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);
    vec3 csm_Normal = normal;
#else
    #if defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL
        vec4 csm_DiffuseColor = vec4(1., 0., 1., 1.);
        vec4 csm_FragColor = vec4(1., 0., 1., 1.);
    #else
        #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL
            vec3 csm_Emissive = emissive;
            float csm_Roughness = roughness;
            float csm_Metalness = metalness;
        #endif
        
        #ifdef USE_MAP
            vec4 _csm_sampledDiffuseColor = texture2D(map, vUv);

            #ifdef DECODE_VIDEO_TEXTURE
            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)
            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);
            #endif

            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;
        #else
            vec4 csm_DiffuseColor = vec4(diffuse, opacity);
            vec4 csm_FragColor = vec4(diffuse, opacity);
        #endif
    #endif
#endif
`,$g=o=>Pg(JSON.stringify(o)),em=(o,e,t)=>o.split(e).join(t),tm=function(o){return o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},im=(o,e)=>new RegExp(`\\b${tm(e)}\\b`).test(o);function nm(o){try{new o}catch(e){if(e.message.indexOf("is not a constructor")>=0)return!1}return!0}class sm extends xn{constructor({baseMaterial:t,fragmentShader:i,vertexShader:n,uniforms:s,patchMap:r,cacheKey:a,...c}){let h;if(nm(t)?h=new t(c):(h=t,Object.assign(h,c)),h.type==="RawShaderMaterial")throw new Error("CustomShaderMaterial does not support RawShaderMaterial");super();N(this,"uniforms");N(this,"_customPatchMap");N(this,"_fs");N(this,"_vs");N(this,"_cacheKey");N(this,"_base");N(this,"_instanceID");N(this,"_type");this.uniforms=s||{},this._customPatchMap=r||{},this._fs=i||"",this._vs=n||"",this._cacheKey=a,this._base=t,this._type=h.type,this._instanceID=Mt.generateUUID();for(const d in h){let l=d;d.startsWith("_")&&(l=d.split("_")[1]),this[l]===void 0&&(this[l]=0),this[l]=h[l]}this.update({fragmentShader:i,vertexShader:n,uniforms:s,cacheKey:a})}update(t){var a;const i=(t==null?void 0:t.uniforms)||{},n=(t==null?void 0:t.fragmentShader)||this._fs,s=(t==null?void 0:t.vertexShader)||this._vs,r=Object.values(i).reduce((c,{value:h})=>c+JSON.stringify(h),"");this.uuid=((a=t==null?void 0:t.cacheKey)==null?void 0:a.call(t))||$g([n,s,r,this._instanceID]),this.generateMaterial({fragmentShader:n,vertexShader:s,uniforms:i})}clone(){const t=new this.constructor({baseMaterial:this._base,fragmentShader:this._fs,vertexShader:this._vs,patchMap:this._customPatchMap,uniforms:this.uniforms,cacheKey:this._cacheKey});for(const i in this)i!=="uuid"&&(t[i]=this[i]);return t}generateMaterial({fragmentShader:t,vertexShader:i,uniforms:n}){const s=this.parseShader(t),r=this.parseShader(i);this.uniforms=n||{},this.customProgramCacheKey=()=>this.uuid,this.onBeforeCompile=a=>{if(s){const c=this.patchShader(s,a.fragmentShader);a.fragmentShader=this.getMaterialDefine()+c}if(r){const c=this.patchShader(r,a.vertexShader);a.vertexShader=`#define IS_VERTEX;
`+c,a.vertexShader=this.getMaterialDefine()+a.vertexShader}a.uniforms={...a.uniforms,...this.uniforms},this.uniforms=a.uniforms},this.needsUpdate=!0}getMaterialDefine(){return`#define IS_${this._type.toUpperCase()};
`}getPatchMapForMaterial(){switch(this._type){case"ShaderMaterial":return Ug;default:return Gg}}patchShader(t,i){let n=i;const s={...this.getPatchMapForMaterial(),...this._customPatchMap};return Object.keys(s).forEach(r=>{Object.keys(s[r]).forEach(a=>{im(t.main,r)&&(n=em(n,a,s[r][a]))})}),n=n.replace("void main() {",`
          ${t.header}
          void main() {
            ${Zg}
            ${t.main}
          `),n=t.defines+n,n}parseShader(t){if(!t)return;const i=t.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),n=Kg(i),s=jg(n),r=s.map(h=>h.name).indexOf("main"),a=Mc(n.slice(0,r>=0?s[r].outer[0]:void 0)),c=r>=0?this.getShaderFromIndex(n,s[r].body):"";return{defines:"",header:a,main:c}}getShaderFromIndex(t,i){return Mc(t.slice(i[0],i[1]))}}const{ShaderChunk:_s,UniformsLib:rm,Vector2:om,Color:am,EventDispatcher:lm,TangentSpaceNormalMap:cm,MultiplyOperation:Am,Material:Ph,ShaderMaterial:Fr,RawShaderMaterial:hm}=uo;function um(o){return o&&o.isShaderMaterial}function dm(o){return o&&o.isMeshDepthMaterial||o===ff}const Je=rm;Je.clearcoatnormalmap={clearcoatNormalScale:{value:new om(1,1)}};const fm=["MeshDistanceMaterial","MeshMatcapMaterial","ShadowMaterial","SpriteMaterial","RawShaderMaterial","ShaderMaterial","PointsMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshPhongMaterial","MeshToonMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshDepthMaterial","MeshBasicMaterial","LineDashedMaterial","LineBasicMaterial","Material","MeshFaceMaterial","MultiMaterial","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial"];for(let o of fm)if(uo[o]!==void 0){const e=uo[o].prototype;e.type=o,e.customDepthMaterial=null,e.customDistanceMaterial=null,e.templates=[]}const Gh=Fr.prototype.clone;function xl(){const o=Gh.call(this);return o.templates=this.templates,o}function Uh(o){if(o&&o.uniforms)for(let e in o.uniforms)o.uniforms[e].linked&&(this.uniforms[e]=o.uniforms[e]);return this}function Ml(o){Ph.prototype.copy.call(this,o);for(let e of mm)o[e]&&(this[e]=o[e]);for(let e of pm)o[e]&&(this[e]=o[e]);return this.fragmentShader=o.fragmentShader,this.vertexShader=o.vertexShader,this.uniforms=Ue(o.uniforms),this.defines=Object.assign({},o.defines),this.wireframe=o.wireframe,this.wireframeLinewidth=o.wireframeLinewidth,this.lights=o.lights,this.clipping=o.clipping,this.skinning=o.skinning,this.morphTargets=o.morphTargets,this.morphNormals=o.morphNormals,this.extensions=o.extensions,o.customDepthMaterial&&(this.customDepthMaterial=o.customDepthMaterial.clone().link(this)),o.customDistanceMaterial&&(this.customDistanceMaterial=o.customDistanceMaterial.clone().link(this)),this}function kh(o){return this.uniforms[o]===void 0&&(this.uniforms[o]={value:null}),this.uniforms[o]}function Tn(o,e){e=e||{};let t={},i="",n="";const s=e.template||e.extends,r=e.class||(o.isMaterial&&o.constructor?o.constructor:null)||Sl,a=new r,c=e.material=e.material||{},h=Object.assign({},c.defines);a.templates=[e],o.templates instanceof Array&&(a.templates=o.templates.concat(a.templates));let d;if(o instanceof Function){d=o.prototype.type;const A=Tc[d];if(A===void 0)return console.error('THREE.extendMaterial: no mapping for material class "%s" found',d),a;c.lights=c.lights===void 0?!0:c.lights,t=Rc(A.name,t,e),i=_s[A.id+"_vert"],n=_s[A.id+"_frag"]}else if(um(o))d=o.type,t=Ue(o.uniforms,t),i=o.vertexShader,n=o.fragmentShader,a.copy(o,!1),o.defines&&Object.assign(h,o.defines);else{d=o.type;const A=Tc[d];if(A===void 0)return console.error('THREE.extendMaterial: no mapping for material class "%s" found',d),a;c.lights=c.lights===void 0?!0:c.lights,t=Rc(A.name,t,e),i=_s[A.id+"_vert"],n=_s[A.id+"_frag"];const u=th[A.name].uniforms;for(let f in u)t[f]===void 0&&o[f]!==void 0&&(o[f]!==null||e.explicit===!1)&&(t[f]=t[f]||{value:null},t[f].value=o[f])}e.defines&&Object.assign(h,e.defines);let l=(e.header||"")+`
`;if(e.vertex!==void 0&&(i=Br(i,e.vertex)),e.fragment!==void 0&&(n=Br(n,e.fragment)),c.defines=h,c.uniforms=t,c.vertexShader=l+(e.vertexHeader||"")+`
`+i,c.fragmentShader=l+(e.fragmentHeader||"")+`
`+n,e.vertexEnd&&(c.vertexShader=c.vertexShader.replace(/\}(?=[^.]*$)/g,e.vertexEnd+`
}`)),e.fragmentEnd&&(c.fragmentShader=c.fragmentShader.replace(/\}(?=[^.]*$)/g,e.fragmentEnd+`
}`)),e.override)for(let A in e.override){const u=e.override[A],f=t[A]=t[A]||{value:null};for(let p in u)f[p]=u[p];f.mixed&&(e.uniforms||(e.uniforms={}),e.uniforms[A]=f)}if(s&&s.templates&&s.templates.length){e.class=e.class||s.class;for(let A of s.templates)ym(c,A,Bm,h);for(let A in s.uniforms){const u=s.uniforms[A];u.linked&&(t[A]=u)}}if(Vh(a,e,c),a.setValues(c),a.isCustomMaterial)for(let A in t)Hh[A]&&t[A].value&&(a[A]=t[A].value);for(let A in h)h[A]===!1&&delete h[A];return dm(o)&&h.DEPTH_PACKING===void 0&&(h.DEPTH_PACKING=df),a}Object.assign(hm.prototype,{extend:Tn,uniform:kh,clone:xl,link:Uh,copy:Ml});Object.assign(Fr.prototype,{extend:Tn,uniform:kh,clone:xl,link:Uh,copy:Ml});if(Fr.prototype.customDepthMaterial!==void 0){const o={_customDepthMaterial:{enumerable:!0,value:void 0,writable:!0},_customDistanceMaterial:{enumerable:!0,value:void 0,writable:!0},customDepthMaterial:{get:function(){return this._customDepthMaterial||(this.material&&this.material.customDepthMaterial?this.material.customDepthMaterial:void 0)},set:function(e){this._customDepthMaterial=e}},customDistanceMaterial:{get:function(){return this._customDistanceMaterial||(this.material&&this.material.customDistanceMaterial?this.material.customDistanceMaterial:void 0)},set:function(e){this._customDistanceMaterial=e}}};Object.defineProperties(Ei.prototype,o),Object.defineProperties(yl.prototype,o)}Tn.CustomMaterial=function(e){Fr.call(this,e),this.type="CustomMaterial"};Object.assign(Tn.CustomMaterial.prototype,Ph.prototype,Fr.prototype,lm.prototype,{isShaderMaterial:!0,isCustomMaterial:!0,isMeshPhongMaterial:!1,isMeshDistanceMaterial:!1,isMeshMatcapMaterial:!1,isShadowMaterial:!1,isSpriteMaterial:!1,isRawShaderMaterial:!1,isPointsMaterial:!1,isMeshPhysicalMaterial:!1,isMeshStandardMaterial:!1,isMeshToonMaterial:!1,isMeshNormalMaterial:!1,isMeshLambertMaterial:!1,isMeshDepthMaterial:!1,isMeshBasicMaterial:!1,isLineDashedMaterial:!1,isLineBasicMaterial:!1,isMaterial:!1,isMeshFaceMaterial:!1,isMultiMaterial:!1,isPointCloudMaterial:!1,isParticleBasicMaterial:!1,isParticleSystemMaterial:!1,constructor:Tn.CustomMaterial,map:null,aoMap:null,envMap:null,bumpMap:null,normalMap:null,lightMap:null,emissiveMap:null,specularMap:null,roughnessMap:null,metalnessMap:null,alphaMap:null,displacementMap:null,clearcoatMap:null,clearcoatRoughnessMap:null,clearcoatNormalMap:null,normalMapType:cm,combine:Am,clone:function(o){const e=Gh.call(this);return this.map&&(e.map=this.map),this.aoMap&&(e.aoMap=this.aoMap),this.envMap&&(e.envMap=this.envMap),this.bumpMap&&(e.bumpMap=this.bumpMap),this.normalMap&&(e.normalMap=this.normalMap),this.lightMap&&(e.lightMap=this.lightMap),this.emissiveMap&&(e.emissiveMap=this.emissiveMap),this.specularMap&&(e.specularMap=this.specularMap),this.roughnessMap&&(e.roughnessMap=this.roughnessMap),this.metalnessMap&&(e.metalnessMap=this.metalnessMap),this.alphaMap&&(e.alphaMap=this.alphaMap),this.displacementMap&&(e.displacementMap=this.displacementMap),this.clearcoatMap&&(e.clearcoatMap=this.clearcoatMap),this.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap=this.clearcoatRoughnessMap),this.clearcoatNormalMap&&(e.clearcoatNormalMap=this.clearcoatNormalMap),e.templates=this.templates,e}});Object.defineProperties(Tn.CustomMaterial.prototype,{reflectivity:{get:function(){return this.uniforms.reflectivity?this.uniforms.reflectivity.value:0},set:function(o){this.uniforms.reflectivity.value=o}},specular:{get:function(){return this.uniforms.specular===void 0&&(this.uniforms.specular={value:new Te("white")}),this.uniforms.specular.value},set:function(o){this.uniforms.specular===void 0&&(this.uniforms.specular={value:o}),this.uniforms.specular.value=o}},shininess:{get:function(){return this.uniforms.shininess?this.uniforms.shininess.value:0},set:function(o){this.uniforms.shininess===void 0&&(this.uniforms.shininess={value:o}),this.uniforms.shininess.value=o}}});class Sl extends Qt{constructor(e){super(e),this.type="CustomMaterial"}get specular(){return this.uniforms.specular===void 0&&(this.uniforms.specular={value:new Te("white")}),this.uniforms.specular.value}set specular(e){this.uniforms.specular===void 0&&(this.uniforms.specular={value:e}),this.uniforms.specular.value=e}get shininess(){return this.uniforms.shininess?this.uniforms.shininess.value:0}set shininess(e){this.uniforms.shininess===void 0&&(this.uniforms.shininess={value:e}),this.uniforms.shininess.value=e}get reflectivity(){return this.uniforms.reflectivity?this.uniforms.reflectivity.value:0}set reflectivity(e){this.uniforms.reflectivity.value=e}}Object.assign(Sl,Tn.CustomMaterial);Object.assign(Sl.prototype,Tn.CustomMaterial.prototype,{copy:Ml,clone:xl});let Nh;const pm=["bumpScale","roughness","metalness","shininess","envMapIntensity","opacity","dashSize","totalSize"],gm={bumpScale:"bumpScale",roughness:"roughness",metalness:"metalness",shininess:"shininess",envMapIntensity:"envMapIntensity",opacity:"opacity",dashSize:"dashSize",totalSize:"totalSize"},mm=["map","aoMap","envMap","bumpMap","normalMap","lightMap","emissiveMap","specularMap","roughnessMap","metalnessMap","alphaMap","displacementMap"],Tc={MeshLambertMaterial:{id:"meshlambert",name:"lambert"},MeshBasicMaterial:{id:"meshbasic",name:"basic"},MeshStandardMaterial:{id:"meshphysical",name:"physical"},MeshPhongMaterial:{id:"meshphong",name:"phong"},MeshMatcapMaterial:{id:"meshmatcap",name:"matcap"},MeshToonMaterial:{id:"meshtoon",name:"toon"},PointsMaterial:{id:"points",name:"points"},LineDashedMaterial:{id:"dashed",name:"linedashed"},MeshDepthMaterial:{id:"depth",name:"depth"},MeshNormalMaterial:{id:"normal",name:"normal"},MeshDistanceMaterial:{id:"distanceRGBA",name:"distanceRGBA"},SpriteMaterial:{id:"sprite",name:"sprite"}},bc={lightsBegin:"?#include <lights_fragment_maps>",lightsEnd:"?#include <aomap_fragment>",colorBegin:"?#include <logdepthbuf_fragment>",colorEnd:"?#include <tonemapping_fragment>",transformBegin:"?#include <morphtarget_vertex>",transformEnd:"?#include <project_vertex>"},vm={alphaTest:{as:"ALPHATEST",not:0}},Ys={opacity:{value:1},specular:{value:new am(1118481)}},Dc={points:Je.points,sprite:Je.sprite,dashed:{scale:{value:1},dashSize:{value:1},totalSize:{value:2}},normal:{opacity:Ys.opacity},toon:{specular:Ys.specular,shininess:{value:30}},standard:{shininess:{value:30},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}},physical:{shininess:{value:30},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}},phong:{specular:Ys.specular,shininess:{value:30}},cube:{opacity:Ys.opacity},distanceRGBA:{nearDistance:{value:1},farDistance:{value:1e3}},shadow:{opacity:Ys.opacity}},Hh={map:"USE_MAP",aoMap:"USE_AOMAP",envMap:"USE_ENVMAP",bumpMap:"USE_BUMPMAP",normalMap:"USE_NORMALMAP",lightMap:"USE_LIGHTMAP",emissiveMap:"USE_EMISSIVEMAP",specularMap:"USE_SPECULARMAP",roughnessMap:"USE_ROUGHNESSMAP",metalnessMap:"USE_METALNESSMAP",alphaMap:"USE_ALPHAMAP",displacementMap:"USE_DISPLACEMENTMAP"};function _m(o,e){o&&(o.envMap&&Ue(Je.envmap,e),o.aoMap&&Ue(Je.aomap,e),o.lightMap&&Ue(Je.lightmap,e),o.bumpMap&&Ue(Je.bumpmap,e),o.normalMap&&Ue(Je.normalmap,e),o.displacementMap&&Ue(Je.displacementmap,e),o.clearcoatNormalMap&&Ue(Je.clearcoatnormalmap,e))}function Cm(o,e,t){_m(e.uniforms,t),e.common!==!1&&Ue(Je.common,t),Dc[o]!==void 0&&Ue(Dc[o],t);const i=e.fog||(e.material?e.material.fog||e.material.useFog:null),n=e.lights||(e.material?e.material.lights:null);if(i&&Ue(Je.fog,t),n)if(e.use){const s=e.use;s.indexOf("sharedLights")>-1;const r=s.indexOf("shadows")>-1;s.indexOf("PointLight")>-1&&(Ue(Je.lights.pointLights,t),r&&(Ue(Je.pointLightShadows,t),Ue(Je.pointShadowMap,t),Ue(Je.pointShadowMatrix,t))),s.indexOf("SpotLight")>-1&&(Ue(Je.lights.spotLights,t),r&&(Ue(Je.spotLightShadows,t),Ue(Je.spotShadowMap,t),Ue(Je.spotShadowMatrix,t))),s.indexOf("DirectionalLight")>-1&&(Ue(Je.lights.directionalLights,t),r&&(Ue(Je.directionalLightShadows,t),Ue(Je.directionalShadowMap,t),Ue(Je.directionalShadowMatrix,t))),s.indexOf("LightProbe")>-1&&Ue(Je.lights.lightProbe,t),s.indexOf("AmbientLight")>-1&&Ue(Je.lights.ambientLightColor,t),s.indexOf("ReactAreaLight")>-1&&Ue(Je.lights.rectAreaLights,t),s.indexOf("HemisphereLight")>-1&&Ue(Je.lights.hemisphereLights,t)}else Ue(Nh,t);return t}function zh(o,e={}){for(let t in o){const i=o[t];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[t]=i.clone():Array.isArray(i)?e[t]=i.slice():e[t]=i}return e}function Jh(o){return o&&o.value!==void 0?o:{value:o}}function Ue(o,e={},t=!1,i=!1,n=!1,s=!1){for(let r in o){const a=o[r];a&&(t&&(a.value===null||a.value===0)||(a.shared||a.linked&&s?e[r]=a:(e[r]=zh(a),i===!0&&(e[r].shared=!0),n===!0&&(e[r].mixed=!0))))}return e}function Br(o,e){for(let t in e){const i=e[t];if(bc[t]!==void 0&&(t=bc[t]),i instanceof Object)_s[t]===void 0?console.error('ShaderMaterial.extend: ShaderChunk "%s" not found',t):o=o.replace("#include <"+t+">",Br(_s[t],i));else if(t[0]==="@"){const n=t.substr(1);o=o.replace(n,i)}else if(t[0]==="?"){const n=t.substr(1);o=o.replace(n,i+`
`+n)}else o?o=o.replace(t,t+`
`+i):console.error("THREE.patchShader: chunk not found '%s'",t)}return o}function Em(o,e,t,i,n){e&&e.value&&gm[o]!==void 0&&(n[o]=e.value),Hh[o]!==void 0&&e&&e.value!==void 0&&(n[o]=e.value);const s=vm[o];s!==void 0&&(s.not===void 0||s.not!==e.value)&&(t[s.as]=e.value)}function Vh(o,e,t,i){if(!(!e.uniforms||!t))for(let n in e.uniforms){t.uniforms[n]||(t.uniforms[n]={});let s=Jh(e.uniforms[n]);t.uniforms[n]=s}}function Bm(o,e,t){if(o.uniforms)for(let i in o.uniforms){let n=o.uniforms[i];n&&(n=Jh(n),n.mixed&&e.uniforms[i]===void 0&&(e.uniforms[i]=n.shared?n:zh(n),t&&Em(i,n,t,o,o)))}}function Rc(o,e,t){return t.explicit===!1?Ue(th[o].uniforms,e):Cm(o,t,e)}function ym(o,e,t=Vh,i=null){let n=(e.header||"")+`
`,s=(e.vertexHeader||"")+`
`+o.vertexShader,r=(e.fragmentHeader||"")+`
`+o.fragmentShader;return e.vertexEnd&&(s=s.replace(/\}(?=[^.]*$)/g,e.vertexEnd+`
}`)),e.fragmentEnd&&(r=r.replace(/\}(?=[^.]*$)/g,e.fragmentEnd+`
}`)),e.vertex!==void 0&&(s=Br(s,e.vertex)),e.fragment!==void 0&&(r=Br(r,e.fragment)),o.vertexShader=n+s,o.fragmentShader=n+r,t instanceof Function&&t(e,o,i,i),o}Nh=Ue(Je.lights,{},!1,!0);/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var Qc=function(o){return URL.createObjectURL(new Blob([o],{type:"text/javascript"}))};try{URL.revokeObjectURL(Qc(""))}catch{Qc=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var mi=Uint8Array,Bn=Uint16Array,$a=Uint32Array,Kh=new mi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yh=new mi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Im=new mi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qh=function(o,e){for(var t=new Bn(31),i=0;i<31;++i)t[i]=e+=1<<o[i-1];for(var n=new $a(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)n[s]=s-t[i]<<5|i;return[t,n]},Xh=qh(Kh,2),Wh=Xh[0],wm=Xh[1];Wh[28]=258,wm[258]=28;var xm=qh(Yh,0),Mm=xm[0],el=new Bn(32768);for(var nt=0;nt<32768;++nt){var fn=(nt&43690)>>>1|(nt&21845)<<1;fn=(fn&52428)>>>2|(fn&13107)<<2,fn=(fn&61680)>>>4|(fn&3855)<<4,el[nt]=((fn&65280)>>>8|(fn&255)<<8)>>>1}var fr=function(o,e,t){for(var i=o.length,n=0,s=new Bn(e);n<i;++n)++s[o[n]-1];var r=new Bn(e);for(n=0;n<e;++n)r[n]=r[n-1]+s[n-1]<<1;var a;if(t){a=new Bn(1<<e);var c=15-e;for(n=0;n<i;++n)if(o[n])for(var h=n<<4|o[n],d=e-o[n],l=r[o[n]-1]++<<d,A=l|(1<<d)-1;l<=A;++l)a[el[l]>>>c]=h}else for(a=new Bn(i),n=0;n<i;++n)o[n]&&(a[n]=el[r[o[n]-1]++]>>>15-o[n]);return a},Or=new mi(288);for(var nt=0;nt<144;++nt)Or[nt]=8;for(var nt=144;nt<256;++nt)Or[nt]=9;for(var nt=256;nt<280;++nt)Or[nt]=7;for(var nt=280;nt<288;++nt)Or[nt]=8;var jh=new mi(32);for(var nt=0;nt<32;++nt)jh[nt]=5;var Sm=fr(Or,9,1),Tm=fr(jh,5,1),oa=function(o){for(var e=o[0],t=1;t<o.length;++t)o[t]>e&&(e=o[t]);return e},Ii=function(o,e,t){var i=e/8|0;return(o[i]|o[i+1]<<8)>>(e&7)&t},aa=function(o,e){var t=e/8|0;return(o[t]|o[t+1]<<8|o[t+2]<<16)>>(e&7)},bm=function(o){return(o/8|0)+(o&7&&1)},Dm=function(o,e,t){(t==null||t>o.length)&&(t=o.length);var i=new(o instanceof Bn?Bn:o instanceof $a?$a:mi)(t-e);return i.set(o.subarray(e,t)),i},Rm=function(o,e,t){var i=o.length;if(!i||t&&!t.l&&i<5)return e||new mi(0);var n=!e||t,s=!t||t.i;t||(t={}),e||(e=new mi(i*3));var r=function(G){var F=e.length;if(G>F){var R=new mi(Math.max(F*2,G));R.set(e),e=R}},a=t.f||0,c=t.p||0,h=t.b||0,d=t.l,l=t.d,A=t.m,u=t.n,f=i*8;do{if(!d){t.f=a=Ii(o,c,1);var p=Ii(o,c+1,3);if(c+=3,p)if(p==1)d=Sm,l=Tm,A=9,u=5;else if(p==2){var C=Ii(o,c,31)+257,E=Ii(o,c+10,15)+4,_=C+Ii(o,c+5,31)+1;c+=14;for(var B=new mi(_),y=new mi(19),x=0;x<E;++x)y[Im[x]]=Ii(o,c+x*3,7);c+=E*3;for(var w=oa(y),b=(1<<w)-1,P=fr(y,w,1),x=0;x<_;){var O=P[Ii(o,c,b)];c+=O&15;var m=O>>>4;if(m<16)B[x++]=m;else{var S=0,D=0;for(m==16?(D=3+Ii(o,c,3),c+=2,S=B[x-1]):m==17?(D=3+Ii(o,c,7),c+=3):m==18&&(D=11+Ii(o,c,127),c+=7);D--;)B[x++]=S}}var Q=B.subarray(0,C),k=B.subarray(C);A=oa(Q),u=oa(k),d=fr(Q,A,1),l=fr(k,u,1)}else throw"invalid block type";else{var m=bm(c)+4,g=o[m-4]|o[m-3]<<8,v=m+g;if(v>i){if(s)throw"unexpected EOF";break}n&&r(h+g),e.set(o.subarray(m,v),h),t.b=h+=g,t.p=c=v*8;continue}if(c>f){if(s)throw"unexpected EOF";break}}n&&r(h+131072);for(var te=(1<<A)-1,W=(1<<u)-1,J=c;;J=c){var S=d[aa(o,c)&te],ee=S>>>4;if(c+=S&15,c>f){if(s)throw"unexpected EOF";break}if(!S)throw"invalid length/literal";if(ee<256)e[h++]=ee;else if(ee==256){J=c,d=null;break}else{var ae=ee-254;if(ee>264){var x=ee-257,j=Kh[x];ae=Ii(o,c,(1<<j)-1)+Wh[x],c+=j}var Ee=l[aa(o,c)&W],Be=Ee>>>4;if(!Ee)throw"invalid distance";c+=Ee&15;var k=Mm[Be];if(Be>3){var j=Yh[Be];k+=aa(o,c)&(1<<j)-1,c+=j}if(c>f){if(s)throw"unexpected EOF";break}n&&r(h+131072);for(var H=h+ae;h<H;h+=4)e[h]=e[h-k],e[h+1]=e[h+1-k],e[h+2]=e[h+2-k],e[h+3]=e[h+3-k];h=H}}t.l=d,t.p=J,t.b=h,d&&(a=1,t.m=A,t.d=l,t.n=u)}while(!a);return h==e.length?e:Dm(e,0,h)},Qm=new mi(0),Fm=function(o){if((o[0]&15)!=8||o[0]>>>4>7||(o[0]<<8|o[1])%31)throw"invalid zlib data";if(o[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Om(o,e){return Rm((Fm(o),o.subarray(2,-4)),e)}var Lm=typeof TextDecoder<"u"&&new TextDecoder,Pm=0;try{Lm.decode(Qm,{stream:!0}),Pm=1}catch{}function Zh(o,e,t){const i=t.length-o-1;if(e>=t[i])return i-1;if(e<=t[o])return o;let n=o,s=i,r=Math.floor((n+s)/2);for(;e<t[r]||e>=t[r+1];)e<t[r]?s=r:n=r,r=Math.floor((n+s)/2);return r}function Gm(o,e,t,i){const n=[],s=[],r=[];n[0]=1;for(let a=1;a<=t;++a){s[a]=e-i[o+1-a],r[a]=i[o+a]-e;let c=0;for(let h=0;h<a;++h){const d=r[h+1],l=s[a-h],A=n[h]/(d+l);n[h]=c+d*A,c=l*A}n[a]=c}return n}function Um(o,e,t,i){const n=Zh(o,i,e),s=Gm(n,i,o,e),r=new Yt(0,0,0,0);for(let a=0;a<=o;++a){const c=t[n-o+a],h=s[a],d=c.w*h;r.x+=c.x*d,r.y+=c.y*d,r.z+=c.z*d,r.w+=c.w*h}return r}function km(o,e,t,i,n){const s=[];for(let l=0;l<=t;++l)s[l]=0;const r=[];for(let l=0;l<=i;++l)r[l]=s.slice(0);const a=[];for(let l=0;l<=t;++l)a[l]=s.slice(0);a[0][0]=1;const c=s.slice(0),h=s.slice(0);for(let l=1;l<=t;++l){c[l]=e-n[o+1-l],h[l]=n[o+l]-e;let A=0;for(let u=0;u<l;++u){const f=h[u+1],p=c[l-u];a[l][u]=f+p;const m=a[u][l-1]/a[l][u];a[u][l]=A+f*m,A=p*m}a[l][l]=A}for(let l=0;l<=t;++l)r[0][l]=a[l][t];for(let l=0;l<=t;++l){let A=0,u=1;const f=[];for(let p=0;p<=t;++p)f[p]=s.slice(0);f[0][0]=1;for(let p=1;p<=i;++p){let m=0;const g=l-p,v=t-p;l>=p&&(f[u][0]=f[A][0]/a[v+1][g],m=f[u][0]*a[g][v]);const C=g>=-1?1:-g,E=l-1<=v?p-1:t-l;for(let B=C;B<=E;++B)f[u][B]=(f[A][B]-f[A][B-1])/a[v+1][g+B],m+=f[u][B]*a[g+B][v];l<=v&&(f[u][p]=-f[A][p-1]/a[v+1][l],m+=f[u][p]*a[l][v]),r[p][l]=m;const _=A;A=u,u=_}}let d=t;for(let l=1;l<=i;++l){for(let A=0;A<=t;++A)r[l][A]*=d;d*=t-l}return r}function Nm(o,e,t,i,n){const s=n<o?n:o,r=[],a=Zh(o,i,e),c=km(a,i,o,s,e),h=[];for(let d=0;d<t.length;++d){const l=t[d].clone(),A=l.w;l.x*=A,l.y*=A,l.z*=A,h[d]=l}for(let d=0;d<=s;++d){const l=h[a-o].clone().multiplyScalar(c[d][0]);for(let A=1;A<=o;++A)l.add(h[a-o+A].clone().multiplyScalar(c[d][A]));r[d]=l}for(let d=s+1;d<=n+1;++d)r[d]=new Yt(0,0,0);return r}function Hm(o,e){let t=1;for(let n=2;n<=o;++n)t*=n;let i=1;for(let n=2;n<=e;++n)i*=n;for(let n=2;n<=o-e;++n)i*=n;return t/i}function zm(o){const e=o.length,t=[],i=[];for(let s=0;s<e;++s){const r=o[s];t[s]=new xe(r.x,r.y,r.z),i[s]=r.w}const n=[];for(let s=0;s<e;++s){const r=t[s].clone();for(let a=1;a<=s;++a)r.sub(n[s-a].clone().multiplyScalar(Hm(s,a)*i[a]));n[s]=r.divideScalar(i[0])}return n}function Jm(o,e,t,i,n){const s=Nm(o,e,t,i,n);return zm(s)}class Vm extends pf{constructor(e,t,i,n,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=s||this.knots.length-1;for(let r=0;r<i.length;++r){const a=i[r];this.controlPoints[r]=new Yt(a.x,a.y,a.z,a.w)}}getPoint(e,t=new xe){const i=t,n=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=Um(this.degree,this.knots,this.controlPoints,n);return s.w!==1&&s.divideScalar(s.w),i.set(s.x,s.y,s.z)}getTangent(e,t=new xe){const i=t,n=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=Jm(this.degree,this.knots,this.controlPoints,n,1);return i.copy(s[1]).normalize(),i}}let Re,ut,Kt;class Km extends ns{constructor(e){super(e)}load(e,t,i,n){const s=this,r=s.path===""?ys.extractUrlBase(e):s.path,a=new Si(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(c,r))}catch(h){n?n(h):console.error(h),s.manager.itemError(e)}},i,n)}parse(e,t){if(Zm(e))Re=new jm().parse(e);else{const n=iu(e);if(!$m(n))throw new Error("THREE.FBXLoader: Unknown format.");if(Oc(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Oc(n));Re=new Wm().parse(n)}const i=new xo(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Ym(i,this.manager).parse(Re)}}class Ym{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){ut=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),n=this.parseDeformers(),s=new qm().parse(n);return this.parseScene(n,s,i),Kt}parseConnections(){const e=new Map;return"Connections"in Re&&Re.Connections.connections.forEach(function(i){const n=i[0],s=i[1],r=i[2];e.has(n)||e.set(n,{parents:[],children:[]});const a={ID:s,relationship:r};e.get(n).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const c={ID:n,relationship:r};e.get(s).children.push(c)}),e}parseImages(){const e={},t={};if("Video"in Re.Objects){const i=Re.Objects.Video;for(const n in i){const s=i[n],r=parseInt(n);if(e[r]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,c=typeof s.Content=="string"&&s.Content!=="";if(a||c){const h=this.parseImage(i[n]);t[s.RelativeFilename||s.Filename]=h}}}}for(const i in e){const n=e[i];t[n]!==void 0?e[i]=t[n]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,n=i.slice(i.lastIndexOf(".")+1).toLowerCase();let s;switch(n){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),s="image/tga";break;default:console.warn('FBXLoader: Image type "'+n+'" is not supported.');return}if(typeof t=="string")return"data:"+s+";base64,"+t;{const r=new Uint8Array(t);return window.URL.createObjectURL(new Blob([r],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in Re.Objects){const i=Re.Objects.Texture;for(const n in i){const s=this.parseTexture(i[n],e);t.set(parseInt(n),s)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const n=e.WrapModeU,s=e.WrapModeV,r=n!==void 0?n.value:0,a=s!==void 0?s.value:0;if(i.wrapS=r===0?nn:Cr,i.wrapT=a===0?nn:Cr,"Scaling"in e){const c=e.Scaling.value;i.repeat.x=c[0],i.repeat.y=c[1]}if("Translation"in e){const c=e.Translation.value;i.offset.x=c[0],i.offset.y=c[1]}return i}loadTexture(e,t){let i;const n=this.textureLoader.path,s=ut.get(e.id).children;s!==void 0&&s.length>0&&t[s[0].ID]!==void 0&&(i=t[s[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let r;const a=e.FileName.slice(-3).toLowerCase();if(a==="tga"){const c=this.manager.getHandler(".tga");c===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),r=new ts):(c.setPath(this.textureLoader.path),r=c.load(i))}else a==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),r=new ts):r=this.textureLoader.load(i);return this.textureLoader.setPath(n),r}parseMaterials(e){const t=new Map;if("Material"in Re.Objects){const i=Re.Objects.Material;for(const n in i){const s=this.parseMaterial(i[n],e);s!==null&&t.set(parseInt(n),s)}}return t}parseMaterial(e,t){const i=e.id,n=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!ut.has(i))return null;const r=this.parseParameters(e,t,i);let a;switch(s.toLowerCase()){case"phong":a=new no;break;case"lambert":a=new gf;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new no;break}return a.setValues(r),a.name=n,a}parseParameters(e,t,i){const n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=new Te().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(n.color=new Te().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=new Te().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(n.emissive=new Te().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=new Te().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(n.specular=new Te().fromArray(e.SpecularColor.value));const s=this;return ut.get(i).children.forEach(function(r){const a=r.relationship;switch(a){case"Bump":n.bumpMap=s.getTexture(t,r.ID);break;case"Maya|TEX_ao_map":n.aoMap=s.getTexture(t,r.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=s.getTexture(t,r.ID),n.map!==void 0&&("colorSpace"in n.map?n.map.colorSpace="srgb":n.map.encoding=3001);break;case"DisplacementColor":n.displacementMap=s.getTexture(t,r.ID);break;case"EmissiveColor":n.emissiveMap=s.getTexture(t,r.ID),n.emissiveMap!==void 0&&("colorSpace"in n.emissiveMap?n.emissiveMap.colorSpace="srgb":n.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=s.getTexture(t,r.ID);break;case"ReflectionColor":n.envMap=s.getTexture(t,r.ID),n.envMap!==void 0&&(n.envMap.mapping=mf,"colorSpace"in n.envMap?n.envMap.colorSpace="srgb":n.envMap.encoding=3001);break;case"SpecularColor":n.specularMap=s.getTexture(t,r.ID),n.specularMap!==void 0&&("colorSpace"in n.specularMap?n.specularMap.colorSpace="srgb":n.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=s.getTexture(t,r.ID),n.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),n}getTexture(e,t){return"LayeredTexture"in Re.Objects&&t in Re.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=ut.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Re.Objects){const i=Re.Objects.Deformer;for(const n in i){const s=i[n],r=ut.get(parseInt(n));if(r){if(s.attrType==="Skin"){const a=this.parseSkeleton(r,i);a.ID=n,r.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=r.parents[0].ID,e[n]=a}else if(s.attrType==="BlendShape"){const a={id:n};a.rawTargets=this.parseMorphTargets(r,i),a.id=n,r.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=a}}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e==null||e.children.forEach(function(n){const s=t[n.ID];if(s.attrType!=="Cluster")return;const r={ID:n.ID,indices:[],weights:[],transformLink:new He().fromArray(s.TransformLink.a)};"Indexes"in s&&(r.indices=s.Indexes.a,r.weights=s.Weights.a),i.push(r)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let n=0;n<e.children.length;n++){const s=e.children[n],r=t[s.ID],a={name:r.attrName,initialWeight:r.DeformPercent,id:r.id,fullWeights:r.FullWeights.a};if(r.attrType!=="BlendShapeChannel")return;a.geoID=ut.get(parseInt(s.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,i.push(a)}return i}parseScene(e,t,i){Kt=new qn;const n=this.parseModels(e.skeletons,t,i),s=Re.Objects.Model,r=this;n.forEach(function(c){const h=s[c.ID];r.setLookAtProperties(c,h),ut.get(c.ID).parents.forEach(function(l){const A=n.get(l.ID);A!==void 0&&A.add(c)}),c.parent===null&&Kt.add(c)}),this.bindSkeleton(e.skeletons,t,n),this.createAmbientLight(),Kt.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const h=eu(c.userData.transformData);c.applyMatrix4(h),c.updateWorldMatrix()}});const a=new Xm().parse();Kt.children.length===1&&Kt.children[0].isGroup&&(Kt.children[0].animations=a,Kt=Kt.children[0]),Kt.animations=a}parseModels(e,t,i){const n=new Map,s=Re.Objects.Model;for(const r in s){const a=parseInt(r),c=s[r],h=ut.get(a);let d=this.buildSkeleton(h,e,a,c.attrName);if(!d){switch(c.attrType){case"Camera":d=this.createCamera(h);break;case"Light":d=this.createLight(h);break;case"Mesh":d=this.createMesh(h,t,i);break;case"NurbsCurve":d=this.createCurve(h,t);break;case"LimbNode":case"Root":d=new Ha;break;case"Null":default:d=new qn;break}d.name=c.attrName?Er.sanitizeNodeName(c.attrName):"",d.ID=a}this.getTransformData(d,c),n.set(a,d)}return n}buildSkeleton(e,t,i,n){let s=null;return e.parents.forEach(function(r){for(const a in t){const c=t[a];c.rawBones.forEach(function(h,d){if(h.ID===r.ID){const l=s;s=new Ha,s.matrixWorld.copy(h.transformLink),s.name=n?Er.sanitizeNodeName(n):"",s.ID=i,c.bones[d]=s,l!==null&&s.add(l)}})}}),s}createCamera(e){let t,i;if(e.children.forEach(function(n){const s=Re.Objects.NodeAttribute[n.ID];s!==void 0&&(i=s)}),i===void 0)t=new hr;else{let n=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(n=1);let s=1;i.NearPlane!==void 0&&(s=i.NearPlane.value/1e3);let r=1e3;i.FarPlane!==void 0&&(r=i.FarPlane.value/1e3);let a=window.innerWidth,c=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(a=i.AspectWidth.value,c=i.AspectHeight.value);const h=a/c;let d=45;i.FieldOfView!==void 0&&(d=i.FieldOfView.value);const l=i.FocalLength?i.FocalLength.value:null;switch(n){case 0:t=new rn(d,h,s,r),l!==null&&t.setFocalLength(l);break;case 1:t=new wo(-a/2,a/2,c/2,-c/2,s,r);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),t=new hr;break}}return t}createLight(e){let t,i;if(e.children.forEach(function(n){const s=Re.Objects.NodeAttribute[n.ID];s!==void 0&&(i=s)}),i===void 0)t=new hr;else{let n;i.LightType===void 0?n=0:n=i.LightType.value;let s=16777215;i.Color!==void 0&&(s=new Te().fromArray(i.Color.value).convertSRGBToLinear());let r=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(r=0);let a=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?a=0:a=i.FarAttenuationEnd.value);const c=1;switch(n){case 0:t=new ka(s,r,a,c);break;case 1:t=new KA(s,r);break;case 2:let h=Math.PI/3;i.InnerAngle!==void 0&&(h=Mt.degToRad(i.InnerAngle.value));let d=0;i.OuterAngle!==void 0&&(d=Mt.degToRad(i.OuterAngle.value),d=Math.max(d,1)),t=new VA(s,r,a,h,d,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new ka(s,r);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,i){let n,s=null,r=null;const a=[];return e.children.forEach(function(c){t.has(c.ID)&&(s=t.get(c.ID)),i.has(c.ID)&&a.push(i.get(c.ID))}),a.length>1?r=a:a.length>0?r=a[0]:(r=new no({color:13421772}),a.push(r)),"color"in s.attributes&&a.forEach(function(c){c.vertexColors=!0}),s.FBX_Deformer?(n=new yl(s,r),n.normalizeSkinWeights()):n=new Ei(s,r),n}createCurve(e,t){const i=e.children.reduce(function(s,r){return t.has(r.ID)&&(s=t.get(r.ID)),s},null),n=new ur({color:3342591,linewidth:1});return new qA(i,n)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?i.eulerOrder=tu(t.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&ut.get(e.ID).children.forEach(function(n){if(n.relationship==="LookAtProperty"){const s=Re.Objects.Model[n.ID];if("Lcl_Translation"in s){const r=s.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(r),Kt.add(e.target)):e.lookAt(new xe().fromArray(r))}}})}bindSkeleton(e,t,i){const n=this.parsePoseNodes();for(const s in e){const r=e[s];ut.get(parseInt(r.ID)).parents.forEach(function(c){if(t.has(c.ID)){const h=c.ID;ut.get(h).parents.forEach(function(l){i.has(l.ID)&&i.get(l.ID).bind(new XA(r.bones),n[l.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in Re.Objects){const t=Re.Objects.Pose;for(const i in t)if(t[i].attrType==="BindPose"&&t[i].NbPoseNodes>0){const n=t[i].PoseNode;Array.isArray(n)?n.forEach(function(s){e[s.Node]=new He().fromArray(s.Matrix.a)}):e[n.Node]=new He().fromArray(n.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in Re&&"AmbientColor"in Re.GlobalSettings){const e=Re.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],n=e[2];if(t!==0||i!==0||n!==0){const s=new Te(t,i,n).convertSRGBToLinear();Kt.add(new vf(s,1))}}}}class qm{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Re.Objects){const i=Re.Objects.Geometry;for(const n in i){const s=ut.get(parseInt(n)),r=this.parseGeometry(s,i[n],e);t.set(parseInt(n),r)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const n=i.skeletons,s=[],r=e.parents.map(function(l){return Re.Objects.Model[l.ID]});if(r.length===0)return;const a=e.children.reduce(function(l,A){return n[A.ID]!==void 0&&(l=n[A.ID]),l},null);e.children.forEach(function(l){i.morphTargets[l.ID]!==void 0&&s.push(i.morphTargets[l.ID])});const c=r[0],h={};"RotationOrder"in c&&(h.eulerOrder=tu(c.RotationOrder.value)),"InheritType"in c&&(h.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(h.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(h.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(h.scale=c.GeometricScaling.value);const d=eu(h);return this.genGeometry(t,a,s,d)}genGeometry(e,t,i,n){const s=new sn;e.attrName&&(s.name=e.attrName);const r=this.parseGeoNode(e,t),a=this.genBuffers(r),c=new Nt(a.vertex,3);if(c.applyMatrix4(n),s.setAttribute("position",c),a.colors.length>0&&s.setAttribute("color",new Nt(a.colors,3)),t&&(s.setAttribute("skinIndex",new _f(a.weightsIndices,4)),s.setAttribute("skinWeight",new Nt(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const h=new kn().getNormalMatrix(n),d=new Nt(a.normal,3);d.applyNormalMatrix(h),s.setAttribute("normal",d)}if(a.uvs.forEach(function(h,d){let l="uv"+(d+1).toString();d===0&&(l="uv"),s.setAttribute(l,new Nt(a.uvs[d],2))}),r.material&&r.material.mappingType!=="AllSame"){let h=a.materialIndex[0],d=0;if(a.materialIndex.forEach(function(l,A){l!==h&&(s.addGroup(d,A-d,h),h=l,d=A)}),s.groups.length>0){const l=s.groups[s.groups.length-1],A=l.start+l.count;A!==a.materialIndex.length&&s.addGroup(A,a.materialIndex.length-A,h)}s.groups.length===0&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,i,n),s}parseGeoNode(e,t){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let n=0;for(;e.LayerElementUV[n];)e.LayerElementUV[n].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return i.weightTable={},t!==null&&(i.skeleton=t,t.rawBones.forEach(function(n,s){n.indices.forEach(function(r,a){i.weightTable[r]===void 0&&(i.weightTable[r]=[]),i.weightTable[r].push({id:s,weight:n.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,n=0,s=!1,r=[],a=[],c=[],h=[],d=[],l=[];const A=this;return e.vertexIndices.forEach(function(u,f){let p,m=!1;u<0&&(u=u^-1,m=!0);let g=[],v=[];if(r.push(u*3,u*3+1,u*3+2),e.color){const C=Vr(f,i,u,e.color);c.push(C[0],C[1],C[2])}if(e.skeleton){if(e.weightTable[u]!==void 0&&e.weightTable[u].forEach(function(C){v.push(C.weight),g.push(C.id)}),v.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const C=[0,0,0,0],E=[0,0,0,0];v.forEach(function(_,B){let y=_,x=g[B];E.forEach(function(w,b,P){if(y>w){P[b]=y,y=w;const O=C[b];C[b]=x,x=O}})}),g=C,v=E}for(;v.length<4;)v.push(0),g.push(0);for(let C=0;C<4;++C)d.push(v[C]),l.push(g[C])}if(e.normal){const C=Vr(f,i,u,e.normal);a.push(C[0],C[1],C[2])}e.material&&e.material.mappingType!=="AllSame"&&(p=Vr(f,i,u,e.material)[0],p<0&&(A.negativeMaterialIndices=!0,p=0)),e.uv&&e.uv.forEach(function(C,E){const _=Vr(f,i,u,C);h[E]===void 0&&(h[E]=[]),h[E].push(_[0]),h[E].push(_[1])}),n++,m&&(n>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),A.genFace(t,e,r,p,a,c,h,d,l,n),i++,n=0,r=[],a=[],c=[],h=[],d=[],l=[])}),t}genFace(e,t,i,n,s,r,a,c,h,d){for(let l=2;l<d;l++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[(l-1)*3]]),e.vertex.push(t.vertexPositions[i[(l-1)*3+1]]),e.vertex.push(t.vertexPositions[i[(l-1)*3+2]]),e.vertex.push(t.vertexPositions[i[l*3]]),e.vertex.push(t.vertexPositions[i[l*3+1]]),e.vertex.push(t.vertexPositions[i[l*3+2]]),t.skeleton&&(e.vertexWeights.push(c[0]),e.vertexWeights.push(c[1]),e.vertexWeights.push(c[2]),e.vertexWeights.push(c[3]),e.vertexWeights.push(c[(l-1)*4]),e.vertexWeights.push(c[(l-1)*4+1]),e.vertexWeights.push(c[(l-1)*4+2]),e.vertexWeights.push(c[(l-1)*4+3]),e.vertexWeights.push(c[l*4]),e.vertexWeights.push(c[l*4+1]),e.vertexWeights.push(c[l*4+2]),e.vertexWeights.push(c[l*4+3]),e.weightsIndices.push(h[0]),e.weightsIndices.push(h[1]),e.weightsIndices.push(h[2]),e.weightsIndices.push(h[3]),e.weightsIndices.push(h[(l-1)*4]),e.weightsIndices.push(h[(l-1)*4+1]),e.weightsIndices.push(h[(l-1)*4+2]),e.weightsIndices.push(h[(l-1)*4+3]),e.weightsIndices.push(h[l*4]),e.weightsIndices.push(h[l*4+1]),e.weightsIndices.push(h[l*4+2]),e.weightsIndices.push(h[l*4+3])),t.color&&(e.colors.push(r[0]),e.colors.push(r[1]),e.colors.push(r[2]),e.colors.push(r[(l-1)*3]),e.colors.push(r[(l-1)*3+1]),e.colors.push(r[(l-1)*3+2]),e.colors.push(r[l*3]),e.colors.push(r[l*3+1]),e.colors.push(r[l*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[(l-1)*3]),e.normal.push(s[(l-1)*3+1]),e.normal.push(s[(l-1)*3+2]),e.normal.push(s[l*3]),e.normal.push(s[l*3+1]),e.normal.push(s[l*3+2])),t.uv&&t.uv.forEach(function(A,u){e.uvs[u]===void 0&&(e.uvs[u]=[]),e.uvs[u].push(a[u][0]),e.uvs[u].push(a[u][1]),e.uvs[u].push(a[u][(l-1)*2]),e.uvs[u].push(a[u][(l-1)*2+1]),e.uvs[u].push(a[u][l*2]),e.uvs[u].push(a[u][l*2+1])})}addMorphTargets(e,t,i,n){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;i.forEach(function(r){r.rawTargets.forEach(function(a){const c=Re.Objects.Geometry[a.geoID];c!==void 0&&s.genMorphGeometry(e,t,c,n,a.name)})})}genMorphGeometry(e,t,i,n,s){const r=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],a=i.Vertices!==void 0?i.Vertices.a:[],c=i.Indexes!==void 0?i.Indexes.a:[],h=e.attributes.position.count*3,d=new Float32Array(h);for(let f=0;f<c.length;f++){const p=c[f]*3;d[p]=a[f*3],d[p+1]=a[f*3+1],d[p+2]=a[f*3+2]}const l={vertexIndices:r,vertexPositions:d},A=this.genBuffers(l),u=new Nt(A.vertex,3);u.name=s||i.attrName,u.applyMatrix4(n),e.morphAttributes.position.push(u)}parseNormals(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.Normals.a;let s=[];return i==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:s,mappingType:t,referenceType:i}}parseUVs(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.UV.a;let s=[];return i==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:n,indices:s,mappingType:t,referenceType:i}}parseVertexColors(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.Colors.a;let s=[];i==="IndexToDirect"&&(s=e.ColorIndex.a);for(let r=0,a=new Te;r<n.length;r+=4)a.fromArray(n,r).convertSRGBToLinear().toArray(n,r);return{dataSize:4,buffer:n,indices:s,mappingType:t,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const n=e.Materials.a,s=[];for(let r=0;r<n.length;++r)s.push(r);return{dataSize:1,buffer:n,indices:s,mappingType:t,referenceType:i}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new sn;const i=t-1,n=e.KnotVector.a,s=[],r=e.Points.a;for(let l=0,A=r.length;l<A;l+=4)s.push(new Yt().fromArray(r,l));let a,c;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){a=i,c=n.length-1-a;for(let l=0;l<i;++l)s.push(s[l])}const d=new Vm(i,n,s,a,c).getPoints(s.length*12);return new sn().setFromPoints(d)}}class Xm{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const i in t){const n=t[i],s=this.addClip(n);e.push(s)}return e}parseClips(){if(Re.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Re.Objects.AnimationCurveNode,t=new Map;for(const i in e){const n=e[i];if(n.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:n.id,attr:n.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=Re.Objects.AnimationCurve;for(const i in t){const n={id:t[i].id,times:t[i].KeyTime.a.map(ev),values:t[i].KeyValueFloat.a},s=ut.get(n.id);if(s!==void 0){const r=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(r).curves.x=n:a.match(/Y/)?e.get(r).curves.y=n:a.match(/Z/)?e.get(r).curves.z=n:a.match(/d|DeformPercent/)&&e.has(r)&&(e.get(r).curves.morph=n)}}}parseAnimationLayers(e){const t=Re.Objects.AnimationLayer,i=new Map;for(const n in t){const s=[],r=ut.get(parseInt(n));r!==void 0&&(r.children.forEach(function(c,h){if(e.has(c.ID)){const d=e.get(c.ID);if(d.curves.x!==void 0||d.curves.y!==void 0||d.curves.z!==void 0){if(s[h]===void 0){const l=ut.get(c.ID).parents.filter(function(A){return A.relationship!==void 0})[0].ID;if(l!==void 0){const A=Re.Objects.Model[l.toString()];if(A===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",c);return}const u={modelName:A.attrName?Er.sanitizeNodeName(A.attrName):"",ID:A.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Kt.traverse(function(f){f.ID===A.id&&(u.transform=f.matrix,f.userData.transformData&&(u.eulerOrder=f.userData.transformData.eulerOrder))}),u.transform||(u.transform=new He),"PreRotation"in A&&(u.preRotation=A.PreRotation.value),"PostRotation"in A&&(u.postRotation=A.PostRotation.value),s[h]=u}}s[h]&&(s[h][d.attr]=d)}else if(d.curves.morph!==void 0){if(s[h]===void 0){const l=ut.get(c.ID).parents.filter(function(g){return g.relationship!==void 0})[0].ID,A=ut.get(l).parents[0].ID,u=ut.get(A).parents[0].ID,f=ut.get(u).parents[0].ID,p=Re.Objects.Model[f],m={modelName:p.attrName?Er.sanitizeNodeName(p.attrName):"",morphName:Re.Objects.Deformer[l].attrName};s[h]=m}s[h][d.attr]=d}}}),i.set(parseInt(n),s))}return i}parseAnimStacks(e){const t=Re.Objects.AnimationStack,i={};for(const n in t){const s=ut.get(parseInt(n)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const r=e.get(s[0].ID);i[n]={name:t[n].attrName,layer:r}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(n){t=t.concat(i.generateTracks(n))}),new WA(e.name,-1,t)}generateTracks(e){const t=[];let i=new xe,n=new _n,s=new xe;if(e.transform&&e.transform.decompose(i,n,s),i=i.toArray(),n=new Cn().setFromQuaternion(n,e.eulerOrder).toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");r!==void 0&&t.push(r)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const r=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);r!==void 0&&t.push(r)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");r!==void 0&&t.push(r)}if(e.DeformPercent!==void 0){const r=this.generateMorphTrack(e);r!==void 0&&t.push(r)}return t}generateVectorTrack(e,t,i,n){const s=this.getTimesForAllAxes(t),r=this.getKeyframeTrackValues(s,t,i);return new za(e+"."+n,s,r)}generateRotationTrack(e,t,i,n,s,r){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Mt.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Mt.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Mt.degToRad));const a=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(a,t,i);n!==void 0&&(n=n.map(Mt.degToRad),n.push(r),n=new Cn().fromArray(n),n=new _n().setFromEuler(n)),s!==void 0&&(s=s.map(Mt.degToRad),s.push(r),s=new Cn().fromArray(s),s=new _n().setFromEuler(s).invert());const h=new _n,d=new Cn,l=[];for(let A=0;A<c.length;A+=3)d.set(c[A],c[A+1],c[A+2],r),h.setFromEuler(d),n!==void 0&&h.premultiply(n),s!==void 0&&h.multiply(s),h.toArray(l,A/3*4);return new Va(e+".quaternion",a,l)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(s){return s/100}),n=Kt.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Ja(e.modelName+".morphTargetInfluences["+n+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(i,n){return i-n}),t.length>1){let i=1,n=t[0];for(let s=1;s<t.length;s++){const r=t[s];r!==n&&(t[i]=r,n=r,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const n=i,s=[];let r=-1,a=-1,c=-1;return e.forEach(function(h){if(t.x&&(r=t.x.times.indexOf(h)),t.y&&(a=t.y.times.indexOf(h)),t.z&&(c=t.z.times.indexOf(h)),r!==-1){const d=t.x.values[r];s.push(d),n[0]=d}else s.push(n[0]);if(a!==-1){const d=t.y.values[a];s.push(d),n[1]=d}else s.push(n[1]);if(c!==-1){const d=t.z.values[c];s.push(d),n[2]=d}else s.push(n[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const i=e.values[t-1],n=e.values[t]-i,s=Math.abs(n);if(s>=180){const r=s/180,a=n/r;let c=i+a;const h=e.times[t-1],l=(e.times[t]-h)/r;let A=h+l;const u=[],f=[];for(;A<e.times[t];)u.push(A),A+=l,f.push(c),c+=a;e.times=Lc(e.times,t,u),e.values=Lc(e.values,t,f)}}}}class Wm{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new $h,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(n,s){const r=n.match(/^[\s\t]*;/),a=n.match(/^[\s\t]*$/);if(r||a)return;const c=n.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),h=n.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),d=n.match("^\\t{"+(t.currentIndent-1)+"}}");c?t.parseNodeBegin(n,c):h?t.parseNodeProperty(n,h,i[++s]):d?t.popStack():n.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(n)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:i},r=this.parseNodeAttr(n),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,s):i in a?(i==="PoseNode"?a.PoseNode.push(s):a[i].id!==void 0&&(a[i]={},a[i][a[i].id]=a[i]),r.id!==""&&(a[i][r.id]=s)):typeof r.id=="number"?(a[i]={},a[i][r.id]=s):i!=="Properties70"&&(i==="PoseNode"?a[i]=[s]:a[i]=s),typeof r.id=="number"&&(s.id=r.id),r.name!==""&&(s.attrName=r.name),r.type!==""&&(s.attrType=r.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",n="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:i,type:n}}parseNodeProperty(e,t,i){let n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();n==="Content"&&s===","&&(s=i.replace(/"/g,"").replace(/,$/,"").trim());const r=this.getCurrentNode();if(r.name==="Properties70"){this.parseNodeSpecialProperty(e,n,s);return}if(n==="C"){const c=s.split(",").slice(1),h=parseInt(c[0]),d=parseInt(c[1]);let l=s.split(",").slice(3);l=l.map(function(A){return A.trim().replace(/^"/,"")}),n="connections",s=[h,d],iv(s,l),r[n]===void 0&&(r[n]=[])}n==="Node"&&(r.id=s),n in r&&Array.isArray(r[n])?r[n].push(s):n!=="a"?r[n]=s:r.a=s,this.setCurrentProp(r,n),n==="a"&&s.slice(-1)!==","&&(r.a=ca(s))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=ca(t.a))}parseNodeSpecialProperty(e,t,i){const n=i.split('",').map(function(d){return d.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=n[0],r=n[1],a=n[2],c=n[3];let h=n[4];switch(r){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=ca(h);break}this.getPrevNode()[s]={type:r,type2:a,flag:c,value:h},this.setCurrentProp(this.getPrevNode(),s)}}class jm{parse(e){const t=new Fc(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const n=new $h;for(;!this.endOfContent(t);){const s=this.parseNode(t,i);s!==null&&n.add(s.name,s)}return n}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},n=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const r=e.getUint8(),a=e.getString(r);if(n===0)return null;const c=[];for(let A=0;A<s;A++)c.push(this.parseProperty(e));const h=c.length>0?c[0]:"",d=c.length>1?c[1]:"",l=c.length>2?c[2]:"";for(i.singleProperty=s===1&&e.getOffset()===n;n>e.getOffset();){const A=this.parseNode(e,t);A!==null&&this.parseSubNode(a,i,A)}return i.propertyList=c,typeof h=="number"&&(i.id=h),d!==""&&(i.attrName=d),l!==""&&(i.attrType=l),a!==""&&(i.name=a),i}parseSubNode(e,t,i){if(i.singleProperty===!0){const n=i.propertyList[0];Array.isArray(n)?(t[i.name]=i,i.a=n):t[i.name]=n}else if(e==="Connections"&&i.name==="C"){const n=[];i.propertyList.forEach(function(s,r){r!==0&&n.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(n)}else if(i.name==="Properties70")Object.keys(i).forEach(function(s){t[s]=i[s]});else if(e==="Properties70"&&i.name==="P"){let n=i.propertyList[0],s=i.propertyList[1];const r=i.propertyList[2],a=i.propertyList[3];let c;n.indexOf("Lcl ")===0&&(n=n.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?c=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:c=i.propertyList[4],t[n]={type:s,type2:r,flag:a,value:c}}else t[i.name]===void 0?typeof i.id=="number"?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:i.name==="PoseNode"?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):t[i.name][i.id]===void 0&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const n=e.getUint32(),s=e.getUint32(),r=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}const a=Om(new Uint8Array(e.getArrayBuffer(r))),c=new Fc(a.buffer);switch(t){case"b":case"c":return c.getBooleanArray(n);case"d":return c.getFloat64Array(n);case"f":return c.getFloat32Array(n);case"i":return c.getInt32Array(n);case"l":return c.getInt64Array(n)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Fc{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let i=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const n=i.indexOf(0);return n>=0&&(i=new Uint8Array(this.dv.buffer,t,n)),this._textDecoder.decode(i)}}class $h{add(e,t){this[e]=t}}function Zm(o){const e="Kaydara FBX Binary  \0";return o.byteLength>=e.length&&e===iu(o,0,e.length)}function $m(o){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(n){const s=o[n-1];return o=o.slice(t+n),t++,s}for(let n=0;n<e.length;++n)if(i(1)===e[n])return!1;return!0}function Oc(o){const e=/FBXVersion: (\d+)/,t=o.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function ev(o){return o/46186158e3}const tv=[];function Vr(o,e,t,i){let n;switch(i.mappingType){case"ByPolygonVertex":n=o;break;case"ByPolygon":n=e;break;case"ByVertice":n=t;break;case"AllSame":n=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(n=i.indices[n]);const s=n*i.dataSize,r=s+i.dataSize;return nv(tv,i.buffer,s,r)}const la=new Cn,ls=new xe;function eu(o){const e=new He,t=new He,i=new He,n=new He,s=new He,r=new He,a=new He,c=new He,h=new He,d=new He,l=new He,A=new He,u=o.inheritType?o.inheritType:0;if(o.translation&&e.setPosition(ls.fromArray(o.translation)),o.preRotation){const b=o.preRotation.map(Mt.degToRad);b.push(o.eulerOrder||Cn.DEFAULT_ORDER),t.makeRotationFromEuler(la.fromArray(b))}if(o.rotation){const b=o.rotation.map(Mt.degToRad);b.push(o.eulerOrder||Cn.DEFAULT_ORDER),i.makeRotationFromEuler(la.fromArray(b))}if(o.postRotation){const b=o.postRotation.map(Mt.degToRad);b.push(o.eulerOrder||Cn.DEFAULT_ORDER),n.makeRotationFromEuler(la.fromArray(b)),n.invert()}o.scale&&s.scale(ls.fromArray(o.scale)),o.scalingOffset&&a.setPosition(ls.fromArray(o.scalingOffset)),o.scalingPivot&&r.setPosition(ls.fromArray(o.scalingPivot)),o.rotationOffset&&c.setPosition(ls.fromArray(o.rotationOffset)),o.rotationPivot&&h.setPosition(ls.fromArray(o.rotationPivot)),o.parentMatrixWorld&&(l.copy(o.parentMatrix),d.copy(o.parentMatrixWorld));const f=t.clone().multiply(i).multiply(n),p=new He;p.extractRotation(d);const m=new He;m.copyPosition(d);const g=m.clone().invert().multiply(d),v=p.clone().invert().multiply(g),C=s,E=new He;if(u===0)E.copy(p).multiply(f).multiply(v).multiply(C);else if(u===1)E.copy(p).multiply(v).multiply(f).multiply(C);else{const P=new He().scale(new xe().setFromMatrixScale(l)).clone().invert(),O=v.clone().multiply(P);E.copy(p).multiply(f).multiply(O).multiply(C)}const _=h.clone().invert(),B=r.clone().invert();let y=e.clone().multiply(c).multiply(h).multiply(t).multiply(i).multiply(n).multiply(_).multiply(a).multiply(r).multiply(s).multiply(B);const x=new He().copyPosition(y),w=d.clone().multiply(x);return A.copyPosition(w),y=A.clone().multiply(E),y.premultiply(d.invert()),y}function tu(o){o=o||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return o===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[o]}function ca(o){return o.split(",").map(function(t){return parseFloat(t)})}function iu(o,e,t){return e===void 0&&(e=0),t===void 0&&(t=o.byteLength),new TextDecoder().decode(new Uint8Array(o,e,t))}function iv(o,e){for(let t=0,i=o.length,n=e.length;t<n;t++,i++)o[i]=e[t]}function nv(o,e,t,i){for(let n=t,s=0;n<i;n++,s++)o[s]=e[n];return o}function Lc(o,e,t){return o.slice(0,e).concat(t).concat(o.slice(e))}class Tl extends Ei{constructor(t,i={}){super(t);N(this,"ignoreObjects");N(this,"isReflector");N(this,"camera");N(this,"material");N(this,"getRenderTarget");N(this,"dispose");const n=i.ignoreObjects||[];this.ignoreObjects=n,this.isReflector=!0,this.type="Reflector",this.camera=new rn;const s=this,r=i.color!==void 0?new Te(i.color):new Te(8355711),a=i.textureWidth||512,c=i.textureHeight||512,h=i.clipBias||0,d=i.shader||Tl.ReflectorShader,l=i.multisample!==void 0?i.multisample:4,A=new ih,u=new xe,f=new xe,p=new xe,m=new He,g=new xe(0,0,-1),v=new Yt,C=new xe,E=new xe,_=new Yt,B=new He,y=this.camera,x=new Bi(a,c,{samples:l,type:Ot}),w=new Qt({uniforms:eh.clone(d.uniforms),fragmentShader:d.fragmentShader,vertexShader:d.vertexShader});w.uniforms.tDiffuse.value=x.texture,w.uniforms.color.value=r,w.uniforms.textureMatrix.value=B,this.material=w,this.onBeforeRender=function(b,P,O){if(f.setFromMatrixPosition(s.matrixWorld),p.setFromMatrixPosition(O.matrixWorld),m.extractRotation(s.matrixWorld),u.set(0,0,1),u.applyMatrix4(m),C.subVectors(f,p),C.dot(u)>0)return;C.reflect(u).negate(),C.add(f),m.extractRotation(O.matrixWorld),g.set(0,0,-1),g.applyMatrix4(m),g.add(p),E.subVectors(f,g),E.reflect(u).negate(),E.add(f),y.position.copy(C),y.up.set(0,1,0),y.up.applyMatrix4(m),y.up.reflect(u),y.lookAt(E),y.far=O.far,y.updateMatrixWorld(),y.projectionMatrix.copy(O.projectionMatrix),B.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),B.multiply(y.projectionMatrix),B.multiply(y.matrixWorldInverse),B.multiply(s.matrixWorld),A.setFromNormalAndCoplanarPoint(u,f),A.applyMatrix4(y.matrixWorldInverse),v.set(A.normal.x,A.normal.y,A.normal.z,A.constant);const S=y.projectionMatrix;_.x=(Math.sign(v.x)+S.elements[8])/S.elements[0],_.y=(Math.sign(v.y)+S.elements[9])/S.elements[5],_.z=-1,_.w=(1+S.elements[10])/S.elements[14],v.multiplyScalar(2/v.dot(_)),S.elements[2]=v.x,S.elements[6]=v.y,S.elements[10]=v.z+1-h,S.elements[14]=v.w,s.visible=!1,n.forEach(ae=>{ae.visible=!1});const D=b.getRenderTarget(),Q=b.xr.enabled,k=b.shadowMap.autoUpdate,te=b.outputEncoding,W=b.toneMapping;let J=!1;"outputColorSpace"in b?J=b.outputColorSpace==="srgb":J=b.outputEncoding===3001,b.xr.enabled=!1,b.shadowMap.autoUpdate=!1,"outputColorSpace"in b?b.outputColorSpace=J?"srgb":"srgb-linear":b.outputEncoding=J?3001:3e3,b.toneMapping=Cf,b.setRenderTarget(x),b.state.buffers.depth.setMask(!0),b.autoClear===!1&&b.clear(),b.render(P,y),b.xr.enabled=Q,b.shadowMap.autoUpdate=k,b.outputEncoding=te,b.toneMapping=W,b.setRenderTarget(D);const ee=O.viewport;ee!==void 0&&b.state.viewport(ee),s.visible=!0,n.forEach(ae=>{ae.visible=!0})},this.getRenderTarget=function(){return x},this.dispose=function(){x.dispose(),s.material.dispose()}}}Tl.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <encodings_fragment>

		}`};class Mi{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){e===void 0&&(e=new M);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){t===void 0&&(t=new M);const i=this.elements,n=e.x,s=e.y,r=e.z;return t.x=i[0]*n+i[1]*s+i[2]*r,t.y=i[3]*n+i[4]*s+i[5]*r,t.z=i[6]*n+i[7]*s+i[8]*r,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){t===void 0&&(t=new Mi);const i=this.elements,n=e.elements,s=t.elements,r=i[0],a=i[1],c=i[2],h=i[3],d=i[4],l=i[5],A=i[6],u=i[7],f=i[8],p=n[0],m=n[1],g=n[2],v=n[3],C=n[4],E=n[5],_=n[6],B=n[7],y=n[8];return s[0]=r*p+a*v+c*_,s[1]=r*m+a*C+c*B,s[2]=r*g+a*E+c*y,s[3]=h*p+d*v+l*_,s[4]=h*m+d*C+l*B,s[5]=h*g+d*E+l*y,s[6]=A*p+u*v+f*_,s[7]=A*m+u*C+f*B,s[8]=A*g+u*E+f*y,t}scale(e,t){t===void 0&&(t=new Mi);const i=this.elements,n=t.elements;for(let s=0;s!==3;s++)n[3*s+0]=e.x*i[3*s+0],n[3*s+1]=e.y*i[3*s+1],n[3*s+2]=e.z*i[3*s+2];return t}solve(e,t){t===void 0&&(t=new M);const i=3,n=4,s=[];let r,a;for(r=0;r<i*n;r++)s.push(0);for(r=0;r<3;r++)for(a=0;a<3;a++)s[r+n*a]=this.elements[r+3*a];s[3+4*0]=e.x,s[3+4*1]=e.y,s[3+4*2]=e.z;let c=3;const h=c;let d;const l=4;let A;do{if(r=h-c,s[r+n*r]===0){for(a=r+1;a<h;a++)if(s[r+n*a]!==0){d=l;do A=l-d,s[A+n*r]+=s[A+n*a];while(--d);break}}if(s[r+n*r]!==0)for(a=r+1;a<h;a++){const u=s[r+n*a]/s[r+n*r];d=l;do A=l-d,s[A+n*a]=A<=r?0:s[A+n*a]-s[A+n*r]*u;while(--d)}}while(--c);if(t.z=s[2*n+3]/s[2*n+2],t.y=(s[1*n+3]-s[1*n+2]*t.z)/s[1*n+1],t.x=(s[0*n+3]-s[0*n+2]*t.z-s[0*n+1]*t.y)/s[0*n+0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,i){if(i===void 0)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";const t=",";for(let i=0;i<9;i++)e+=this.elements[i]+t;return e}reverse(e){e===void 0&&(e=new Mi);const t=3,i=6,n=sv;let s,r;for(s=0;s<3;s++)for(r=0;r<3;r++)n[s+i*r]=this.elements[s+3*r];n[3+6*0]=1,n[3+6*1]=0,n[3+6*2]=0,n[4+6*0]=0,n[4+6*1]=1,n[4+6*2]=0,n[5+6*0]=0,n[5+6*1]=0,n[5+6*2]=1;let a=3;const c=a;let h;const d=i;let l;do{if(s=c-a,n[s+i*s]===0){for(r=s+1;r<c;r++)if(n[s+i*r]!==0){h=d;do l=d-h,n[l+i*s]+=n[l+i*r];while(--h);break}}if(n[s+i*s]!==0)for(r=s+1;r<c;r++){const A=n[s+i*r]/n[s+i*s];h=d;do l=d-h,n[l+i*r]=l<=s?0:n[l+i*r]-n[l+i*s]*A;while(--h)}}while(--a);s=2;do{r=s-1;do{const A=n[s+i*r]/n[s+i*s];h=i;do l=i-h,n[l+i*r]=n[l+i*r]-n[l+i*s]*A;while(--h)}while(r--)}while(--s);s=2;do{const A=1/n[s+i*s];h=i;do l=i-h,n[l+i*s]=n[l+i*s]*A;while(--h)}while(s--);s=2;do{r=2;do{if(l=n[t+r+i*s],isNaN(l)||l===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,r,l)}while(r--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,n=e.z,s=e.w,r=t+t,a=i+i,c=n+n,h=t*r,d=t*a,l=t*c,A=i*a,u=i*c,f=n*c,p=s*r,m=s*a,g=s*c,v=this.elements;return v[3*0+0]=1-(A+f),v[3*0+1]=d-g,v[3*0+2]=l+m,v[3*1+0]=d+g,v[3*1+1]=1-(h+f),v[3*1+2]=u-p,v[3*2+0]=l-m,v[3*2+1]=u+p,v[3*2+2]=1-(h+A),this}transpose(e){e===void 0&&(e=new Mi);const t=this.elements,i=e.elements;let n;return i[0]=t[0],i[4]=t[4],i[8]=t[8],n=t[1],i[1]=t[3],i[3]=n,n=t[2],i[2]=t[6],i[6]=n,n=t[5],i[5]=t[7],i[7]=n,e}}const sv=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class M{constructor(e,t,i){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=i}cross(e,t){t===void 0&&(t=new M);const i=e.x,n=e.y,s=e.z,r=this.x,a=this.y,c=this.z;return t.x=a*s-c*n,t.y=c*i-r*s,t.z=r*n-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(t)t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z;else return new M(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,t){if(t)t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z;else return new M(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new Mi([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,n=Math.sqrt(e*e+t*t+i*i);if(n>0){const s=1/n;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return n}unit(e){e===void 0&&(e=new M);const t=this.x,i=this.y,n=this.z;let s=Math.sqrt(t*t+i*i+n*n);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=n*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,n=this.z,s=e.x,r=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(r-i)*(r-i)+(a-n)*(a-n))}distanceSquared(e){const t=this.x,i=this.y,n=this.z,s=e.x,r=e.y,a=e.z;return(s-t)*(s-t)+(r-i)*(r-i)+(a-n)*(a-n)}scale(e,t){t===void 0&&(t=new M);const i=this.x,n=this.y,s=this.z;return t.x=e*i,t.y=e*n,t.z=e*s,t}vmul(e,t){return t===void 0&&(t=new M),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i){return i===void 0&&(i=new M),i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new M),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const n=rv,s=1/i;n.set(this.x*s,this.y*s,this.z*s);const r=ov;Math.abs(n.x)<.9?(r.set(1,0,0),n.cross(r,e)):(r.set(0,1,0),n.cross(r,e)),n.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const n=this.x,s=this.y,r=this.z;i.x=n+(e.x-n)*t,i.y=s+(e.y-s)*t,i.z=r+(e.z-r)*t}almostEquals(e,t){return t===void 0&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(Pc),Pc.almostEquals(e,t)}clone(){return new M(this.x,this.y,this.z)}}M.ZERO=new M(0,0,0);M.UNIT_X=new M(1,0,0);M.UNIT_Y=new M(0,1,0);M.UNIT_Z=new M(0,0,1);const rv=new M,ov=new M,Pc=new M;class oi{constructor(e){e===void 0&&(e={}),this.lowerBound=new M,this.upperBound=new M,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,n){const s=this.lowerBound,r=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),r.copy(s);for(let c=1;c<e.length;c++){let h=e[c];a&&(a.vmult(h,Gc),h=Gc),h.x>r.x&&(r.x=h.x),h.x<s.x&&(s.x=h.x),h.y>r.y&&(r.y=h.y),h.y<s.y&&(s.y=h.y),h.z>r.z&&(r.z=h.z),h.z<s.z&&(s.z=h.z)}return t&&(t.vadd(s,s),t.vadd(r,r)),n&&(s.x-=n,s.y-=n,s.z-=n,r.x+=n,r.y+=n,r.z+=n),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new oi().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,n=e.lowerBound,s=e.upperBound,r=n.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x,a=n.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y,c=n.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z;return r&&a&&c}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,n=e.lowerBound,s=e.upperBound;return t.x<=n.x&&i.x>=s.x&&t.y<=n.y&&i.y>=s.y&&t.z<=n.z&&i.z>=s.z}getCorners(e,t,i,n,s,r,a,c){const h=this.lowerBound,d=this.upperBound;e.copy(h),t.set(d.x,h.y,h.z),i.set(d.x,d.y,h.z),n.set(h.x,d.y,d.z),s.set(d.x,h.y,d.z),r.set(h.x,d.y,h.z),a.set(h.x,h.y,d.z),c.copy(d)}toLocalFrame(e,t){const i=Uc,n=i[0],s=i[1],r=i[2],a=i[3],c=i[4],h=i[5],d=i[6],l=i[7];this.getCorners(n,s,r,a,c,h,d,l);for(let A=0;A!==8;A++){const u=i[A];e.pointToLocal(u,u)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=Uc,n=i[0],s=i[1],r=i[2],a=i[3],c=i[4],h=i[5],d=i[6],l=i[7];this.getCorners(n,s,r,a,c,h,d,l);for(let A=0;A!==8;A++){const u=i[A];e.pointToWorld(u,u)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,n=1/t.x,s=1/t.y,r=1/t.z,a=(this.lowerBound.x-i.x)*n,c=(this.upperBound.x-i.x)*n,h=(this.lowerBound.y-i.y)*s,d=(this.upperBound.y-i.y)*s,l=(this.lowerBound.z-i.z)*r,A=(this.upperBound.z-i.z)*r,u=Math.max(Math.max(Math.min(a,c),Math.min(h,d)),Math.min(l,A)),f=Math.min(Math.min(Math.max(a,c),Math.max(h,d)),Math.max(l,A));return!(f<0||u>f)}}const Gc=new M,Uc=[new M,new M,new M,new M,new M,new M,new M,new M];class kc{constructor(){this.matrix=[]}get(e,t){let{index:i}=e,{index:n}=t;if(n>i){const s=n;n=i,i=s}return this.matrix[(i*(i+1)>>1)+n-1]}set(e,t,i){let{index:n}=e,{index:s}=t;if(s>n){const r=s;s=n,n=r}this.matrix[(n*(n+1)>>1)+s-1]=i?1:0}reset(){for(let e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class nu{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;return i[e]===void 0&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return!!(i[e]!==void 0&&i[e].includes(t))}hasAnyEventListener(e){return this._listeners===void 0?!1:this._listeners[e]!==void 0}removeEventListener(e,t){if(this._listeners===void 0)return this;const i=this._listeners;if(i[e]===void 0)return this;const n=i[e].indexOf(t);return n!==-1&&i[e].splice(n,1),this}dispatchEvent(e){if(this._listeners===void 0)return this;const i=this._listeners[e.type];if(i!==void 0){e.target=this;for(let n=0,s=i.length;n<s;n++)i[n].call(this,e)}return this}}class _t{constructor(e,t,i,n){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),n===void 0&&(n=1),this.x=e,this.y=t,this.z=i,this.w=n}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(t*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(t*.5),this}toAxisAngle(e){e===void 0&&(e=new M),this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=av,n=lv;e.tangents(i,n),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){t===void 0&&(t=new _t);const i=this.x,n=this.y,s=this.z,r=this.w,a=e.x,c=e.y,h=e.z,d=e.w;return t.x=i*d+r*a+n*h-s*c,t.y=n*d+r*c+s*a-i*h,t.z=s*d+r*h+i*c-n*a,t.w=r*d-i*a-n*c-s*h,t}inverse(e){e===void 0&&(e=new _t);const t=this.x,i=this.y,n=this.z,s=this.w;this.conjugate(e);const r=1/(t*t+i*i+n*n+s*s);return e.x*=r,e.y*=r,e.z*=r,e.w*=r,e}conjugate(e){return e===void 0&&(e=new _t),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){t===void 0&&(t=new M);const i=e.x,n=e.y,s=e.z,r=this.x,a=this.y,c=this.z,h=this.w,d=h*i+a*s-c*n,l=h*n+c*i-r*s,A=h*s+r*n-a*i,u=-r*i-a*n-c*s;return t.x=d*h+u*-r+l*-c-A*-a,t.y=l*h+u*-a+A*-r-d*-c,t.z=A*h+u*-c+d*-a-l*-r,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){t===void 0&&(t="YZX");let i,n,s;const r=this.x,a=this.y,c=this.z,h=this.w;switch(t){case"YZX":const d=r*a+c*h;if(d>.499&&(i=2*Math.atan2(r,h),n=Math.PI/2,s=0),d<-.499&&(i=-2*Math.atan2(r,h),n=-Math.PI/2,s=0),i===void 0){const l=r*r,A=a*a,u=c*c;i=Math.atan2(2*a*h-2*r*c,1-2*A-2*u),n=Math.asin(2*d),s=Math.atan2(2*r*h-2*a*c,1-2*l-2*u)}break;default:throw new Error(`Euler order ${t} not supported yet.`)}e.y=i,e.z=n,e.x=s}setFromEuler(e,t,i,n){n===void 0&&(n="XYZ");const s=Math.cos(e/2),r=Math.cos(t/2),a=Math.cos(i/2),c=Math.sin(e/2),h=Math.sin(t/2),d=Math.sin(i/2);return n==="XYZ"?(this.x=c*r*a+s*h*d,this.y=s*h*a-c*r*d,this.z=s*r*d+c*h*a,this.w=s*r*a-c*h*d):n==="YXZ"?(this.x=c*r*a+s*h*d,this.y=s*h*a-c*r*d,this.z=s*r*d-c*h*a,this.w=s*r*a+c*h*d):n==="ZXY"?(this.x=c*r*a-s*h*d,this.y=s*h*a+c*r*d,this.z=s*r*d+c*h*a,this.w=s*r*a-c*h*d):n==="ZYX"?(this.x=c*r*a-s*h*d,this.y=s*h*a+c*r*d,this.z=s*r*d-c*h*a,this.w=s*r*a+c*h*d):n==="YZX"?(this.x=c*r*a+s*h*d,this.y=s*h*a+c*r*d,this.z=s*r*d-c*h*a,this.w=s*r*a-c*h*d):n==="XZY"&&(this.x=c*r*a-s*h*d,this.y=s*h*a-c*r*d,this.z=s*r*d+c*h*a,this.w=s*r*a+c*h*d),this}clone(){return new _t(this.x,this.y,this.z,this.w)}slerp(e,t,i){i===void 0&&(i=new _t);const n=this.x,s=this.y,r=this.z,a=this.w;let c=e.x,h=e.y,d=e.z,l=e.w,A,u,f,p,m;return u=n*c+s*h+r*d+a*l,u<0&&(u=-u,c=-c,h=-h,d=-d,l=-l),1-u>1e-6?(A=Math.acos(u),f=Math.sin(A),p=Math.sin((1-t)*A)/f,m=Math.sin(t*A)/f):(p=1-t,m=t),i.x=p*n+m*c,i.y=p*s+m*h,i.z=p*r+m*d,i.w=p*a+m*l,i}integrate(e,t,i,n){n===void 0&&(n=new _t);const s=e.x*i.x,r=e.y*i.y,a=e.z*i.z,c=this.x,h=this.y,d=this.z,l=this.w,A=t*.5;return n.x+=A*(s*l+r*d-a*h),n.y+=A*(r*l+a*c-s*d),n.z+=A*(a*l+s*h-r*c),n.w+=A*(-s*c-r*h-a*d),n}}const av=new M,lv=new M,cv={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class me{constructor(e){e===void 0&&(e={}),this.id=me.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,t){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,t,i,n){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}me.idCounter=0;me.types=cv;class ke{constructor(e){e===void 0&&(e={}),this.position=new M,this.quaternion=new _t,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return ke.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return ke.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return t===void 0&&(t=new M),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,n){return n===void 0&&(n=new M),i.vsub(e,n),t.conjugate(Nc),Nc.vmult(n,n),n}static pointToWorldFrame(e,t,i,n){return n===void 0&&(n=new M),t.vmult(i,n),n.vadd(e,n),n}static vectorToWorldFrame(e,t,i){return i===void 0&&(i=new M),e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,n){return n===void 0&&(n=new M),t.w*=-1,t.vmult(i,n),t.w*=-1,n}}const Nc=new _t;class pr extends me{constructor(e){e===void 0&&(e={});const{vertices:t=[],faces:i=[],normals:n=[],axes:s,boundingSphereRadius:r}=e;super({type:me.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=i,this.faceNormals=n,this.faceNormals.length===0&&this.computeNormals(),r?this.boundingSphereRadius=r:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const n=new M;for(let s=0;s!==e.length;s++){const r=e[s],a=r.length;for(let c=0;c!==a;c++){const h=(c+1)%a;t[r[c]].vsub(t[r[h]],n),n.normalize();let d=!1;for(let l=0;l!==i.length;l++)if(i[l].almostEquals(n)||i[l].almostEquals(n)){d=!0;break}d||i.push(n.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let n=0;n<this.faces[e].length;n++)if(!this.vertices[this.faces[e][n]])throw new Error(`Vertex ${this.faces[e][n]} not found!`);const t=this.faceNormals[e]||new M;this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t;const i=this.vertices[this.faces[e][0]];if(t.dot(i)<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let n=0;n<this.faces[e].length;n++)console.warn(`.vertices[${this.faces[e][n]}] = Vec3(${this.vertices[this.faces[e][n]].toString()})`)}}}getFaceNormal(e,t){const i=this.faces[e],n=this.vertices[i[0]],s=this.vertices[i[1]],r=this.vertices[i[2]];pr.computeNormal(n,s,r,t)}static computeNormal(e,t,i,n){const s=new M,r=new M;t.vsub(e,r),i.vsub(t,s),s.cross(r,n),n.isZero()||n.normalize()}clipAgainstHull(e,t,i,n,s,r,a,c,h){const d=new M;let l=-1,A=-Number.MAX_VALUE;for(let f=0;f<i.faces.length;f++){d.copy(i.faceNormals[f]),s.vmult(d,d);const p=d.dot(r);p>A&&(A=p,l=f)}const u=[];for(let f=0;f<i.faces[l].length;f++){const p=i.vertices[i.faces[l][f]],m=new M;m.copy(p),s.vmult(m,m),n.vadd(m,m),u.push(m)}l>=0&&this.clipFaceAgainstHull(r,e,t,u,a,c,h)}findSeparatingAxis(e,t,i,n,s,r,a,c){const h=new M,d=new M,l=new M,A=new M,u=new M,f=new M;let p=Number.MAX_VALUE;const m=this;if(m.uniqueAxes)for(let g=0;g!==m.uniqueAxes.length;g++){i.vmult(m.uniqueAxes[g],h);const v=m.testSepAxis(h,e,t,i,n,s);if(v===!1)return!1;v<p&&(p=v,r.copy(h))}else{const g=a?a.length:m.faces.length;for(let v=0;v<g;v++){const C=a?a[v]:v;h.copy(m.faceNormals[C]),i.vmult(h,h);const E=m.testSepAxis(h,e,t,i,n,s);if(E===!1)return!1;E<p&&(p=E,r.copy(h))}}if(e.uniqueAxes)for(let g=0;g!==e.uniqueAxes.length;g++){s.vmult(e.uniqueAxes[g],d);const v=m.testSepAxis(d,e,t,i,n,s);if(v===!1)return!1;v<p&&(p=v,r.copy(d))}else{const g=c?c.length:e.faces.length;for(let v=0;v<g;v++){const C=c?c[v]:v;d.copy(e.faceNormals[C]),s.vmult(d,d);const E=m.testSepAxis(d,e,t,i,n,s);if(E===!1)return!1;E<p&&(p=E,r.copy(d))}}for(let g=0;g!==m.uniqueEdges.length;g++){i.vmult(m.uniqueEdges[g],A);for(let v=0;v!==e.uniqueEdges.length;v++)if(s.vmult(e.uniqueEdges[v],u),A.cross(u,f),!f.almostZero()){f.normalize();const C=m.testSepAxis(f,e,t,i,n,s);if(C===!1)return!1;C<p&&(p=C,r.copy(f))}}return n.vsub(t,l),l.dot(r)>0&&r.negate(r),!0}testSepAxis(e,t,i,n,s,r){const a=this;pr.project(a,e,i,n,Aa),pr.project(t,e,s,r,ha);const c=Aa[0],h=Aa[1],d=ha[0],l=ha[1];if(c<l||d<h)return!1;const A=c-l,u=d-h;return A<u?A:u}calculateLocalInertia(e,t){const i=new M,n=new M;this.computeLocalAABB(n,i);const s=i.x-n.x,r=i.y-n.y,a=i.z-n.z;t.x=1/12*e*(2*r*2*r+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*r*2*r+2*s*2*s)}getPlaneConstantOfFace(e){const t=this.faces[e],i=this.faceNormals[e],n=this.vertices[t[0]];return-i.dot(n)}clipFaceAgainstHull(e,t,i,n,s,r,a){const c=new M,h=new M,d=new M,l=new M,A=new M,u=new M,f=new M,p=new M,m=this,g=[],v=n,C=g;let E=-1,_=Number.MAX_VALUE;for(let b=0;b<m.faces.length;b++){c.copy(m.faceNormals[b]),i.vmult(c,c);const P=c.dot(e);P<_&&(_=P,E=b)}if(E<0)return;const B=m.faces[E];B.connectedFaces=[];for(let b=0;b<m.faces.length;b++)for(let P=0;P<m.faces[b].length;P++)B.indexOf(m.faces[b][P])!==-1&&b!==E&&B.connectedFaces.indexOf(b)===-1&&B.connectedFaces.push(b);const y=B.length;for(let b=0;b<y;b++){const P=m.vertices[B[b]],O=m.vertices[B[(b+1)%y]];P.vsub(O,h),d.copy(h),i.vmult(d,d),t.vadd(d,d),l.copy(this.faceNormals[E]),i.vmult(l,l),t.vadd(l,l),d.cross(l,A),A.negate(A),u.copy(P),i.vmult(u,u),t.vadd(u,u);const S=B.connectedFaces[b];f.copy(this.faceNormals[S]);const D=this.getPlaneConstantOfFace(S);p.copy(f),i.vmult(p,p);const Q=D-p.dot(t);for(this.clipFaceAgainstPlane(v,C,p,Q);v.length;)v.shift();for(;C.length;)v.push(C.shift())}f.copy(this.faceNormals[E]);const x=this.getPlaneConstantOfFace(E);p.copy(f),i.vmult(p,p);const w=x-p.dot(t);for(let b=0;b<v.length;b++){let P=p.dot(v[b])+w;if(P<=s&&(console.log(`clamped: depth=${P} to minDist=${s}`),P=s),P<=r){const O=v[b];if(P<=1e-6){const S={point:O,normal:p,depth:P};a.push(S)}}}}clipFaceAgainstPlane(e,t,i,n){let s,r;const a=e.length;if(a<2)return t;let c=e[e.length-1],h=e[0];s=i.dot(c)+n;for(let d=0;d<a;d++){if(h=e[d],r=i.dot(h)+n,s<0)if(r<0){const l=new M;l.copy(h),t.push(l)}else{const l=new M;c.lerp(h,s/(s-r),l),t.push(l)}else if(r<0){const l=new M;c.lerp(h,s/(s-r),l),t.push(l),t.push(h)}c=h,s=r}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new M);const i=this.vertices,n=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],n[s]),e.vadd(n[s],n[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let n=0;n<this.vertices.length;n++){const s=i[n];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new M);const i=this.faceNormals,n=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],n[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const n=t[i].lengthSquared();n>e&&(e=n)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,n){const s=this.vertices;let r,a,c,h,d,l,A=new M;for(let u=0;u<s.length;u++){A.copy(s[u]),t.vmult(A,A),e.vadd(A,A);const f=A;(r===void 0||f.x<r)&&(r=f.x),(h===void 0||f.x>h)&&(h=f.x),(a===void 0||f.y<a)&&(a=f.y),(d===void 0||f.y>d)&&(d=f.y),(c===void 0||f.z<c)&&(c=f.z),(l===void 0||f.z>l)&&(l=f.z)}i.set(r,a,c),n.set(h,d,l)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){e===void 0&&(e=new M);const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,n=this.vertices;if(t){for(let s=0;s<i;s++){const r=n[s];t.vmult(r,r)}for(let s=0;s<this.faceNormals.length;s++){const r=this.faceNormals[s];t.vmult(r,r)}}if(e)for(let s=0;s<i;s++){const r=n[s];r.vadd(e,r)}}pointIsInside(e){const t=this.vertices,i=this.faces,n=this.faceNormals,s=new M;this.getAveragePointLocal(s);for(let r=0;r<this.faces.length;r++){let a=n[r];const c=t[i[r][0]],h=new M;e.vsub(c,h);const d=a.dot(h),l=new M;s.vsub(c,l);const A=a.dot(l);if(d<0&&A>0||d>0&&A<0)return!1}return-1}static project(e,t,i,n,s){const r=e.vertices.length,a=Av;let c=0,h=0;const d=hv,l=e.vertices;d.setZero(),ke.vectorToLocalFrame(i,n,t,a),ke.pointToLocalFrame(i,n,d,d);const A=d.dot(a);h=c=l[0].dot(a);for(let u=1;u<r;u++){const f=l[u].dot(a);f>c&&(c=f),f<h&&(h=f)}if(h-=A,c-=A,h>c){const u=h;h=c,c=u}s[0]=c,s[1]=h}}const Aa=[],ha=[];new M;const Av=new M,hv=new M;class bl extends me{constructor(e){super({type:me.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,n=M,s=[new n(-e,-t,-i),new n(e,-t,-i),new n(e,t,-i),new n(-e,t,-i),new n(-e,-t,i),new n(e,-t,i),new n(e,t,i),new n(-e,t,i)],r=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],a=[new n(0,0,1),new n(0,1,0),new n(1,0,0)],c=new pr({vertices:s,faces:r,axes:a});this.convexPolyhedronRepresentation=c,c.material=this.material}calculateLocalInertia(e,t){return t===void 0&&(t=new M),bl.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const n=e;i.x=1/12*t*(2*n.y*2*n.y+2*n.z*2*n.z),i.y=1/12*t*(2*n.x*2*n.x+2*n.z*2*n.z),i.z=1/12*t*(2*n.y*2*n.y+2*n.x*2*n.x)}getSideNormals(e,t){const i=e,n=this.halfExtents;if(i[0].set(n.x,0,0),i[1].set(0,n.y,0),i[2].set(0,0,n.z),i[3].set(-n.x,0,0),i[4].set(0,-n.y,0),i[5].set(0,0,-n.z),t!==void 0)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const n=this.halfExtents,s=[[n.x,n.y,n.z],[-n.x,n.y,n.z],[-n.x,-n.y,n.z],[-n.x,-n.y,-n.z],[n.x,-n.y,-n.z],[n.x,n.y,-n.z],[-n.x,n.y,-n.z],[n.x,-n.y,n.z]];for(let r=0;r<s.length;r++)pn.set(s[r][0],s[r][1],s[r][2]),t.vmult(pn,pn),e.vadd(pn,pn),i(pn.x,pn.y,pn.z)}calculateWorldAABB(e,t,i,n){const s=this.halfExtents;Qi[0].set(s.x,s.y,s.z),Qi[1].set(-s.x,s.y,s.z),Qi[2].set(-s.x,-s.y,s.z),Qi[3].set(-s.x,-s.y,-s.z),Qi[4].set(s.x,-s.y,-s.z),Qi[5].set(s.x,s.y,-s.z),Qi[6].set(-s.x,s.y,-s.z),Qi[7].set(s.x,-s.y,s.z);const r=Qi[0];t.vmult(r,r),e.vadd(r,r),n.copy(r),i.copy(r);for(let a=1;a<8;a++){const c=Qi[a];t.vmult(c,c),e.vadd(c,c);const h=c.x,d=c.y,l=c.z;h>n.x&&(n.x=h),d>n.y&&(n.y=d),l>n.z&&(n.z=l),h<i.x&&(i.x=h),d<i.y&&(i.y=d),l<i.z&&(i.z=l)}}}const pn=new M,Qi=[new M,new M,new M,new M,new M,new M,new M,new M],Dl={DYNAMIC:1,STATIC:2,KINEMATIC:4},Rl={AWAKE:0,SLEEPY:1,SLEEPING:2};class ve extends nu{constructor(e){e===void 0&&(e={}),super(),this.id=ve.idCounter++,this.index=-1,this.world=null,this.vlambda=new M,this.collisionFilterGroup=typeof e.collisionFilterGroup=="number"?e.collisionFilterGroup:1,this.collisionFilterMask=typeof e.collisionFilterMask=="number"?e.collisionFilterMask:-1,this.collisionResponse=typeof e.collisionResponse=="boolean"?e.collisionResponse:!0,this.position=new M,this.previousPosition=new M,this.interpolatedPosition=new M,this.initPosition=new M,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new M,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new M,this.force=new M;const t=typeof e.mass=="number"?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping=typeof e.linearDamping=="number"?e.linearDamping:.01,this.type=t<=0?ve.STATIC:ve.DYNAMIC,typeof e.type==typeof ve.STATIC&&(this.type=e.type),this.allowSleep=typeof e.allowSleep<"u"?e.allowSleep:!0,this.sleepState=ve.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new M,this.quaternion=new _t,this.initQuaternion=new _t,this.previousQuaternion=new _t,this.interpolatedQuaternion=new _t,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new M,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new M,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new M,this.invInertia=new M,this.invInertiaWorld=new Mi,this.invMassSolve=0,this.invInertiaSolve=new M,this.invInertiaWorldSolve=new Mi,this.fixedRotation=typeof e.fixedRotation<"u"?e.fixedRotation:!1,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new M(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new M(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new oi,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new M,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=ve.AWAKE,this.wakeUpAfterNarrowphase=!1,e===ve.SLEEPING&&this.dispatchEvent(ve.wakeupEvent)}sleep(){this.sleepState=ve.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),n=this.sleepSpeedLimit**2;t===ve.AWAKE&&i<n?(this.sleepState=ve.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(ve.sleepyEvent)):t===ve.SLEEPY&&i>n?this.wakeUp():t===ve.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(ve.sleepEvent))}}updateSolveMassProperties(){this.sleepState===ve.SLEEPING||this.type===ve.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return t===void 0&&(t=new M),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return t===void 0&&(t=new M),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return t===void 0&&(t=new M),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return t===void 0&&(t=new M),this.quaternion.vmult(e,t),t}addShape(e,t,i){const n=new M,s=new _t;return t&&n.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(n),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return t===-1?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let n=0;for(let s=0;s!==i;s++){const r=e[s];r.updateBoundingSphereRadius();const a=t[s].length(),c=r.boundingSphereRadius;a+c>n&&(n=a+c)}this.boundingRadius=n}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,n=e.length,s=uv,r=dv,a=this.quaternion,c=this.aabb,h=fv;for(let d=0;d!==n;d++){const l=e[d];a.vmult(t[d],s),s.vadd(this.position,s),a.mult(i[d],r),l.calculateWorldAABB(s,r,h.lowerBound,h.upperBound),d===0?c.copy(h):c.extend(h)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(!(t.x===t.y&&t.y===t.z&&!e)){const i=pv,n=gv;i.setRotationFromQuaternion(this.quaternion),i.transpose(n),i.scale(t,i),i.mmult(n,this.invInertiaWorld)}}applyForce(e,t){if(t===void 0&&(t=new M),this.type!==ve.DYNAMIC)return;this.sleepState===ve.SLEEPING&&this.wakeUp();const i=mv;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t){if(t===void 0&&(t=new M),this.type!==ve.DYNAMIC)return;const i=vv,n=_v;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,n),this.applyForce(i,n)}applyTorque(e){this.type===ve.DYNAMIC&&(this.sleepState===ve.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(t===void 0&&(t=new M),this.type!==ve.DYNAMIC)return;this.sleepState===ve.SLEEPING&&this.wakeUp();const i=t,n=Cv;n.copy(e),n.scale(this.invMass,n),this.velocity.vadd(n,this.velocity);const s=Ev;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t){if(t===void 0&&(t=new M),this.type!==ve.DYNAMIC)return;const i=Bv,n=yv;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,n),this.applyImpulse(i,n)}updateMassProperties(){const e=Iv;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),bl.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new M;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),!(this.type===ve.DYNAMIC||this.type===ve.KINEMATIC)||this.sleepState===ve.SLEEPING)return;const n=this.velocity,s=this.angularVelocity,r=this.position,a=this.force,c=this.torque,h=this.quaternion,d=this.invMass,l=this.invInertiaWorld,A=this.linearFactor,u=d*e;n.x+=a.x*u*A.x,n.y+=a.y*u*A.y,n.z+=a.z*u*A.z;const f=l.elements,p=this.angularFactor,m=c.x*p.x,g=c.y*p.y,v=c.z*p.z;s.x+=e*(f[0]*m+f[1]*g+f[2]*v),s.y+=e*(f[3]*m+f[4]*g+f[5]*v),s.z+=e*(f[6]*m+f[7]*g+f[8]*v),r.x+=n.x*e,r.y+=n.y*e,r.z+=n.z*e,h.integrate(this.angularVelocity,e,this.angularFactor,h),t&&(i?h.normalizeFast():h.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}ve.idCounter=0;ve.COLLIDE_EVENT_NAME="collide";ve.DYNAMIC=Dl.DYNAMIC;ve.STATIC=Dl.STATIC;ve.KINEMATIC=Dl.KINEMATIC;ve.AWAKE=Rl.AWAKE;ve.SLEEPY=Rl.SLEEPY;ve.SLEEPING=Rl.SLEEPING;ve.wakeupEvent={type:"wakeup"};ve.sleepyEvent={type:"sleepy"};ve.sleepEvent={type:"sleep"};const uv=new M,dv=new _t,fv=new oi,pv=new Mi,gv=new Mi;new Mi;const mv=new M,vv=new M,_v=new M,Cv=new M,Ev=new M,Bv=new M,yv=new M,Iv=new M;class wv{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,t,i){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,t){return!((e.collisionFilterGroup&t.collisionFilterMask)===0||(t.collisionFilterGroup&e.collisionFilterMask)===0||((e.type&ve.STATIC)!==0||e.sleepState===ve.SLEEPING)&&((t.type&ve.STATIC)!==0||t.sleepState===ve.SLEEPING))}intersectionTest(e,t,i,n){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,i,n):this.doBoundingSphereBroadphase(e,t,i,n)}doBoundingSphereBroadphase(e,t,i,n){const s=xv;t.position.vsub(e.position,s);const r=(e.boundingRadius+t.boundingRadius)**2;s.lengthSquared()<r&&(i.push(e),n.push(t))}doBoundingBoxBroadphase(e,t,i,n){e.aabbNeedsUpdate&&e.updateAABB(),t.aabbNeedsUpdate&&t.updateAABB(),e.aabb.overlaps(t.aabb)&&(i.push(e),n.push(t))}makePairsUnique(e,t){const i=Mv,n=Sv,s=Tv,r=e.length;for(let a=0;a!==r;a++)n[a]=e[a],s[a]=t[a];e.length=0,t.length=0;for(let a=0;a!==r;a++){const c=n[a].id,h=s[a].id,d=c<h?`${c},${h}`:`${h},${c}`;i[d]=a,i.keys.push(d)}for(let a=0;a!==i.keys.length;a++){const c=i.keys.pop(),h=i[c];e.push(n[h]),t.push(s[h]),delete i[c]}}setWorld(e){}static boundingSphereCheck(e,t){const i=new M;e.position.vsub(t.position,i);const n=e.shapes[0],s=t.shapes[0];return Math.pow(n.boundingSphereRadius+s.boundingSphereRadius,2)>i.lengthSquared()}aabbQuery(e,t,i){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const xv=new M;new M;new _t;new M;const Mv={keys:[]},Sv=[],Tv=[];new M;new M;new M;class bv extends wv{constructor(){super()}collisionPairs(e,t,i){const n=e.bodies,s=n.length;let r,a;for(let c=0;c!==s;c++)for(let h=0;h!==c;h++)r=n[c],a=n[h],this.needBroadphaseCollision(r,a)&&this.intersectionTest(r,a,t,i)}aabbQuery(e,t,i){i===void 0&&(i=[]);for(let n=0;n<e.bodies.length;n++){const s=e.bodies[n];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(t)&&i.push(s)}return i}}class go{constructor(){this.rayFromWorld=new M,this.rayToWorld=new M,this.hitNormalWorld=new M,this.hitPointWorld=new M,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,n,s,r,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(n),this.shape=s,this.body=r,this.distance=a}}let su,ru,ou,au,lu,cu,Au;const Ql={CLOSEST:1,ANY:2,ALL:4};su=me.types.SPHERE;ru=me.types.PLANE;ou=me.types.BOX;au=me.types.CYLINDER;lu=me.types.CONVEXPOLYHEDRON;cu=me.types.HEIGHTFIELD;Au=me.types.TRIMESH;class pt{get[su](){return this._intersectSphere}get[ru](){return this._intersectPlane}get[ou](){return this._intersectBox}get[au](){return this._intersectConvex}get[lu](){return this._intersectConvex}get[cu](){return this._intersectHeightfield}get[Au](){return this._intersectTrimesh}constructor(e,t){e===void 0&&(e=new M),t===void 0&&(t=new M),this.from=e.clone(),this.to=t.clone(),this.direction=new M,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=pt.ANY,this.result=new go,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||pt.ANY,this.result=t.result||new go,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=typeof t.checkCollisionResponse<"u"?t.checkCollisionResponse:!0,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Hc),ua.length=0,e.broadphase.aabbQuery(e,Hc,ua),this.intersectBodies(ua),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||(this.collisionFilterGroup&e.collisionFilterMask)===0||(e.collisionFilterGroup&this.collisionFilterMask)===0)return;const n=Dv,s=Rv;for(let r=0,a=e.shapes.length;r<a;r++){const c=e.shapes[r];if(!(i&&!c.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[r],s),e.quaternion.vmult(e.shapeOffsets[r],n),n.vadd(e.position,n),this.intersectShape(c,s,n,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,n=e.length;!this.result.shouldStop&&i<n;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,n){const s=this.from;if(Kv(s,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,n,e)}_intersectBox(e,t,i,n,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,n,s)}_intersectPlane(e,t,i,n,s){const r=this.from,a=this.to,c=this.direction,h=new M(0,0,1);t.vmult(h,h);const d=new M;r.vsub(i,d);const l=d.dot(h);a.vsub(i,d);const A=d.dot(h);if(l*A>0||r.distanceTo(a)<l)return;const u=h.dot(c);if(Math.abs(u)<this.precision)return;const f=new M,p=new M,m=new M;r.vsub(i,f);const g=-h.dot(f)/u;c.scale(g,p),r.vadd(p,m),this.reportIntersection(h,m,s,n,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,n=this.to,s=this.from;t.x=Math.min(n.x,s.x),t.y=Math.min(n.y,s.y),t.z=Math.min(n.z,s.z),i.x=Math.max(n.x,s.x),i.y=Math.max(n.y,s.y),i.z=Math.max(n.z,s.z)}_intersectHeightfield(e,t,i,n,s){e.data,e.elementSize;const r=Qv;r.from.copy(this.from),r.to.copy(this.to),ke.pointToLocalFrame(i,t,r.from,r.from),ke.pointToLocalFrame(i,t,r.to,r.to),r.updateDirection();const a=Fv;let c,h,d,l;c=h=0,d=l=e.data.length-1;const A=new oi;r.getAABB(A),e.getIndexOfPosition(A.lowerBound.x,A.lowerBound.y,a,!0),c=Math.max(c,a[0]),h=Math.max(h,a[1]),e.getIndexOfPosition(A.upperBound.x,A.upperBound.y,a,!0),d=Math.min(d,a[0]+1),l=Math.min(l,a[1]+1);for(let u=c;u<d;u++)for(let f=h;f<l;f++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(u,f,A),!!A.overlapsRay(r)){if(e.getConvexTrianglePillar(u,f,!1),ke.pointToWorldFrame(i,t,e.pillarOffset,Kr),this._intersectConvex(e.pillarConvex,t,Kr,n,s,zc),this.result.shouldStop)return;e.getConvexTrianglePillar(u,f,!0),ke.pointToWorldFrame(i,t,e.pillarOffset,Kr),this._intersectConvex(e.pillarConvex,t,Kr,n,s,zc)}}}_intersectSphere(e,t,i,n,s){const r=this.from,a=this.to,c=e.radius,h=(a.x-r.x)**2+(a.y-r.y)**2+(a.z-r.z)**2,d=2*((a.x-r.x)*(r.x-i.x)+(a.y-r.y)*(r.y-i.y)+(a.z-r.z)*(r.z-i.z)),l=(r.x-i.x)**2+(r.y-i.y)**2+(r.z-i.z)**2-c**2,A=d**2-4*h*l,u=Ov,f=Lv;if(!(A<0))if(A===0)r.lerp(a,A,u),u.vsub(i,f),f.normalize(),this.reportIntersection(f,u,s,n,-1);else{const p=(-d-Math.sqrt(A))/(2*h),m=(-d+Math.sqrt(A))/(2*h);if(p>=0&&p<=1&&(r.lerp(a,p,u),u.vsub(i,f),f.normalize(),this.reportIntersection(f,u,s,n,-1)),this.result.shouldStop)return;m>=0&&m<=1&&(r.lerp(a,m,u),u.vsub(i,f),f.normalize(),this.reportIntersection(f,u,s,n,-1))}}_intersectConvex(e,t,i,n,s,r){const a=Pv,c=Jc,h=r&&r.faceList||null,d=e.faces,l=e.vertices,A=e.faceNormals,u=this.direction,f=this.from,p=this.to,m=f.distanceTo(p),g=h?h.length:d.length,v=this.result;for(let C=0;!v.shouldStop&&C<g;C++){const E=h?h[C]:C,_=d[E],B=A[E],y=t,x=i;c.copy(l[_[0]]),y.vmult(c,c),c.vadd(x,c),c.vsub(f,c),y.vmult(B,a);const w=u.dot(a);if(Math.abs(w)<this.precision)continue;const b=a.dot(c)/w;if(!(b<0)){u.scale(b,Jt),Jt.vadd(f,Jt),wi.copy(l[_[0]]),y.vmult(wi,wi),x.vadd(wi,wi);for(let P=1;!v.shouldStop&&P<_.length-1;P++){Fi.copy(l[_[P]]),Oi.copy(l[_[P+1]]),y.vmult(Fi,Fi),y.vmult(Oi,Oi),x.vadd(Fi,Fi),x.vadd(Oi,Oi);const O=Jt.distanceTo(f);!(pt.pointInTriangle(Jt,wi,Fi,Oi)||pt.pointInTriangle(Jt,Fi,wi,Oi))||O>m||this.reportIntersection(a,Jt,s,n,E)}}}}_intersectTrimesh(e,t,i,n,s,r){const a=Gv,c=Jv,h=Vv,d=Jc,l=Uv,A=kv,u=Nv,f=zv,p=Hv,m=e.indices;e.vertices;const g=this.from,v=this.to,C=this.direction;h.position.copy(i),h.quaternion.copy(t),ke.vectorToLocalFrame(i,t,C,l),ke.pointToLocalFrame(i,t,g,A),ke.pointToLocalFrame(i,t,v,u),u.x*=e.scale.x,u.y*=e.scale.y,u.z*=e.scale.z,A.x*=e.scale.x,A.y*=e.scale.y,A.z*=e.scale.z,u.vsub(A,l),l.normalize();const E=A.distanceSquared(u);e.tree.rayQuery(this,h,c);for(let _=0,B=c.length;!this.result.shouldStop&&_!==B;_++){const y=c[_];e.getNormal(y,a),e.getVertex(m[y*3],wi),wi.vsub(A,d);const x=l.dot(a),w=a.dot(d)/x;if(w<0)continue;l.scale(w,Jt),Jt.vadd(A,Jt),e.getVertex(m[y*3+1],Fi),e.getVertex(m[y*3+2],Oi);const b=Jt.distanceSquared(A);!(pt.pointInTriangle(Jt,Fi,wi,Oi)||pt.pointInTriangle(Jt,wi,Fi,Oi))||b>E||(ke.vectorToWorldFrame(t,a,p),ke.pointToWorldFrame(i,t,Jt,f),this.reportIntersection(p,f,s,n,y))}c.length=0}reportIntersection(e,t,i,n,s){const r=this.from,a=this.to,c=r.distanceTo(t),h=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(h.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case pt.ALL:this.hasHit=!0,h.set(r,a,e,t,i,n,c),h.hasHit=!0,this.callback(h);break;case pt.CLOSEST:(c<h.distance||!h.hasHit)&&(this.hasHit=!0,h.hasHit=!0,h.set(r,a,e,t,i,n,c));break;case pt.ANY:this.hasHit=!0,h.hasHit=!0,h.set(r,a,e,t,i,n,c),h.shouldStop=!0;break}}static pointInTriangle(e,t,i,n){n.vsub(t,zn),i.vsub(t,qs),e.vsub(t,da);const s=zn.dot(zn),r=zn.dot(qs),a=zn.dot(da),c=qs.dot(qs),h=qs.dot(da);let d,l;return(d=c*a-r*h)>=0&&(l=s*h-r*a)>=0&&d+l<s*c-r*r}}pt.CLOSEST=Ql.CLOSEST;pt.ANY=Ql.ANY;pt.ALL=Ql.ALL;const Hc=new oi,ua=[],qs=new M,da=new M,Dv=new M,Rv=new _t,Jt=new M,wi=new M,Fi=new M,Oi=new M;new M;new go;const zc={faceList:[0]},Kr=new M,Qv=new pt,Fv=[],Ov=new M,Lv=new M,Pv=new M;new M;new M;const Jc=new M,Gv=new M,Uv=new M,kv=new M,Nv=new M,Hv=new M,zv=new M;new oi;const Jv=[],Vv=new ke,zn=new M,Yr=new M;function Kv(o,e,t){t.vsub(o,zn);const i=zn.dot(e);return e.scale(i,Yr),Yr.vadd(o,Yr),t.distanceTo(Yr)}class Yv{static defaults(e,t){e===void 0&&(e={});for(let i in t)i in e||(e[i]=t[i]);return e}}class Vc{constructor(){this.spatial=new M,this.rotational=new M}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}}class Lr{constructor(e,t,i,n){i===void 0&&(i=-1e6),n===void 0&&(n=1e6),this.id=Lr.idCounter++,this.minForce=i,this.maxForce=n,this.bi=e,this.bj=t,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new Vc,this.jacobianElementB=new Vc,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(e,t,i){const n=t,s=e,r=i;this.a=4/(r*(1+4*n)),this.b=4*n/(1+4*n),this.eps=4/(r*r*s*(1+4*n))}computeB(e,t,i){const n=this.computeGW(),s=this.computeGq(),r=this.computeGiMf();return-s*e-n*t-r*i}computeGq(){const e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,s=i.position,r=n.position;return e.spatial.dot(s)+t.spatial.dot(r)}computeGW(){const e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,s=i.velocity,r=n.velocity,a=i.angularVelocity,c=n.angularVelocity;return e.multiplyVectors(s,a)+t.multiplyVectors(r,c)}computeGWlambda(){const e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,s=i.vlambda,r=n.vlambda,a=i.wlambda,c=n.wlambda;return e.multiplyVectors(s,a)+t.multiplyVectors(r,c)}computeGiMf(){const e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,s=i.force,r=i.torque,a=n.force,c=n.torque,h=i.invMassSolve,d=n.invMassSolve;return s.scale(h,Kc),a.scale(d,Yc),i.invInertiaWorldSolve.vmult(r,qc),n.invInertiaWorldSolve.vmult(c,Xc),e.multiplyVectors(Kc,qc)+t.multiplyVectors(Yc,Xc)}computeGiMGt(){const e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,s=i.invMassSolve,r=n.invMassSolve,a=i.invInertiaWorldSolve,c=n.invInertiaWorldSolve;let h=s+r;return a.vmult(e.rotational,qr),h+=qr.dot(e.rotational),c.vmult(t.rotational,qr),h+=qr.dot(t.rotational),h}addToWlambda(e){const t=this.jacobianElementA,i=this.jacobianElementB,n=this.bi,s=this.bj,r=qv;n.vlambda.addScaledVector(n.invMassSolve*e,t.spatial,n.vlambda),s.vlambda.addScaledVector(s.invMassSolve*e,i.spatial,s.vlambda),n.invInertiaWorldSolve.vmult(t.rotational,r),n.wlambda.addScaledVector(e,r,n.wlambda),s.invInertiaWorldSolve.vmult(i.rotational,r),s.wlambda.addScaledVector(e,r,s.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Lr.idCounter=0;const Kc=new M,Yc=new M,qc=new M,Xc=new M,qr=new M,qv=new M;class Xv extends Lr{constructor(e,t,i){i===void 0&&(i=1e6),super(e,t,0,i),this.restitution=0,this.ri=new M,this.rj=new M,this.ni=new M}computeB(e){const t=this.a,i=this.b,n=this.bi,s=this.bj,r=this.ri,a=this.rj,c=Wv,h=jv,d=n.velocity,l=n.angularVelocity;n.force,n.torque;const A=s.velocity,u=s.angularVelocity;s.force,s.torque;const f=Zv,p=this.jacobianElementA,m=this.jacobianElementB,g=this.ni;r.cross(g,c),a.cross(g,h),g.negate(p.spatial),c.negate(p.rotational),m.spatial.copy(g),m.rotational.copy(h),f.copy(s.position),f.vadd(a,f),f.vsub(n.position,f),f.vsub(r,f);const v=g.dot(f),C=this.restitution+1,E=C*A.dot(g)-C*d.dot(g)+u.dot(h)-l.dot(c),_=this.computeGiMf();return-v*t-E*i-e*_}getImpactVelocityAlongNormal(){const e=$v,t=e0,i=t0,n=i0,s=n0;return this.bi.position.vadd(this.ri,i),this.bj.position.vadd(this.rj,n),this.bi.getVelocityAtWorldPoint(i,e),this.bj.getVelocityAtWorldPoint(n,t),e.vsub(t,s),this.ni.dot(s)}}const Wv=new M,jv=new M,Zv=new M,$v=new M,e0=new M,t0=new M,i0=new M,n0=new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;class Wc extends Lr{constructor(e,t,i){super(e,t,-i,i),this.ri=new M,this.rj=new M,this.t=new M}computeB(e){this.a;const t=this.b;this.bi,this.bj;const i=this.ri,n=this.rj,s=s0,r=r0,a=this.t;i.cross(a,s),n.cross(a,r);const c=this.jacobianElementA,h=this.jacobianElementB;a.negate(c.spatial),s.negate(c.rotational),h.spatial.copy(a),h.rotational.copy(r);const d=this.computeGW(),l=this.computeGiMf();return-d*t-e*l}}const s0=new M,r0=new M;class To{constructor(e,t,i){i=Yv.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=To.idCounter++,this.materials=[e,t],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}}To.idCounter=0;class bo{constructor(e){e===void 0&&(e={});let t="";typeof e=="string"&&(t=e,e={}),this.name=t,this.id=bo.idCounter++,this.friction=typeof e.friction<"u"?e.friction:-1,this.restitution=typeof e.restitution<"u"?e.restitution:-1}}bo.idCounter=0;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new pt;new M;new M;new M;new M(1,0,0),new M(0,1,0),new M(0,0,1);new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new M;new oi;new M;new oi;new M;new M;new M;new M;new M;new M;new M;new oi;new M;new ke;new oi;class o0{constructor(){this.equations=[]}solve(e,t){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const t=this.equations,i=t.indexOf(e);i!==-1&&t.splice(i,1)}removeAllEquations(){this.equations.length=0}}class a0 extends o0{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,t){let i=0;const n=this.iterations,s=this.tolerance*this.tolerance,r=this.equations,a=r.length,c=t.bodies,h=c.length,d=e;let l,A,u,f,p,m;if(a!==0)for(let E=0;E!==h;E++)c[E].updateSolveMassProperties();const g=c0,v=A0,C=l0;g.length=a,v.length=a,C.length=a;for(let E=0;E!==a;E++){const _=r[E];C[E]=0,v[E]=_.computeB(d),g[E]=1/_.computeC()}if(a!==0){for(let B=0;B!==h;B++){const y=c[B],x=y.vlambda,w=y.wlambda;x.set(0,0,0),w.set(0,0,0)}for(i=0;i!==n;i++){f=0;for(let B=0;B!==a;B++){const y=r[B];l=v[B],A=g[B],m=C[B],p=y.computeGWlambda(),u=A*(l-p-y.eps*m),m+u<y.minForce?u=y.minForce-m:m+u>y.maxForce&&(u=y.maxForce-m),C[B]+=u,f+=u>0?u:-u,y.addToWlambda(u)}if(f*f<s)break}for(let B=0;B!==h;B++){const y=c[B],x=y.velocity,w=y.angularVelocity;y.vlambda.vmul(y.linearFactor,y.vlambda),x.vadd(y.vlambda,x),y.wlambda.vmul(y.angularFactor,y.wlambda),w.vadd(y.wlambda,w)}let E=r.length;const _=1/d;for(;E--;)r[E].multiplier=C[E]*_}return i}}const l0=[],c0=[],A0=[];class h0{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let t=0;t!==e;t++)this.objects.push(t<0||arguments.length<=t?void 0:arguments[t]);return this}get(){return this.objects.length===0?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}class u0 extends h0{constructor(){super(...arguments),this.type=M}constructObject(){return new M}}const tt={sphereSphere:me.types.SPHERE,spherePlane:me.types.SPHERE|me.types.PLANE,boxBox:me.types.BOX|me.types.BOX,sphereBox:me.types.SPHERE|me.types.BOX,planeBox:me.types.PLANE|me.types.BOX,convexConvex:me.types.CONVEXPOLYHEDRON,sphereConvex:me.types.SPHERE|me.types.CONVEXPOLYHEDRON,planeConvex:me.types.PLANE|me.types.CONVEXPOLYHEDRON,boxConvex:me.types.BOX|me.types.CONVEXPOLYHEDRON,sphereHeightfield:me.types.SPHERE|me.types.HEIGHTFIELD,boxHeightfield:me.types.BOX|me.types.HEIGHTFIELD,convexHeightfield:me.types.CONVEXPOLYHEDRON|me.types.HEIGHTFIELD,sphereParticle:me.types.PARTICLE|me.types.SPHERE,planeParticle:me.types.PLANE|me.types.PARTICLE,boxParticle:me.types.BOX|me.types.PARTICLE,convexParticle:me.types.PARTICLE|me.types.CONVEXPOLYHEDRON,cylinderCylinder:me.types.CYLINDER,sphereCylinder:me.types.SPHERE|me.types.CYLINDER,planeCylinder:me.types.PLANE|me.types.CYLINDER,boxCylinder:me.types.BOX|me.types.CYLINDER,convexCylinder:me.types.CONVEXPOLYHEDRON|me.types.CYLINDER,heightfieldCylinder:me.types.HEIGHTFIELD|me.types.CYLINDER,particleCylinder:me.types.PARTICLE|me.types.CYLINDER,sphereTrimesh:me.types.SPHERE|me.types.TRIMESH,planeTrimesh:me.types.PLANE|me.types.TRIMESH};class d0{get[tt.sphereSphere](){return this.sphereSphere}get[tt.spherePlane](){return this.spherePlane}get[tt.boxBox](){return this.boxBox}get[tt.sphereBox](){return this.sphereBox}get[tt.planeBox](){return this.planeBox}get[tt.convexConvex](){return this.convexConvex}get[tt.sphereConvex](){return this.sphereConvex}get[tt.planeConvex](){return this.planeConvex}get[tt.boxConvex](){return this.boxConvex}get[tt.sphereHeightfield](){return this.sphereHeightfield}get[tt.boxHeightfield](){return this.boxHeightfield}get[tt.convexHeightfield](){return this.convexHeightfield}get[tt.sphereParticle](){return this.sphereParticle}get[tt.planeParticle](){return this.planeParticle}get[tt.boxParticle](){return this.boxParticle}get[tt.convexParticle](){return this.convexParticle}get[tt.cylinderCylinder](){return this.convexConvex}get[tt.sphereCylinder](){return this.sphereConvex}get[tt.planeCylinder](){return this.planeConvex}get[tt.boxCylinder](){return this.boxConvex}get[tt.convexCylinder](){return this.convexConvex}get[tt.heightfieldCylinder](){return this.heightfieldCylinder}get[tt.particleCylinder](){return this.particleCylinder}get[tt.sphereTrimesh](){return this.sphereTrimesh}get[tt.planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new u0,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,t,i,n,s,r){let a;this.contactPointPool.length?(a=this.contactPointPool.pop(),a.bi=e,a.bj=t):a=new Xv(e,t),a.enabled=e.collisionResponse&&t.collisionResponse&&i.collisionResponse&&n.collisionResponse;const c=this.currentContactMaterial;a.restitution=c.restitution,a.setSpookParams(c.contactEquationStiffness,c.contactEquationRelaxation,this.world.dt);const h=i.material||e.material,d=n.material||t.material;return h&&d&&h.restitution>=0&&d.restitution>=0&&(a.restitution=h.restitution*d.restitution),a.si=s||i,a.sj=r||n,a}createFrictionEquationsFromContact(e,t){const i=e.bi,n=e.bj,s=e.si,r=e.sj,a=this.world,c=this.currentContactMaterial;let h=c.friction;const d=s.material||i.material,l=r.material||n.material;if(d&&l&&d.friction>=0&&l.friction>=0&&(h=d.friction*l.friction),h>0){const A=h*(a.frictionGravity||a.gravity).length();let u=i.invMass+n.invMass;u>0&&(u=1/u);const f=this.frictionEquationPool,p=f.length?f.pop():new Wc(i,n,A*u),m=f.length?f.pop():new Wc(i,n,A*u);return p.bi=m.bi=i,p.bj=m.bj=n,p.minForce=m.minForce=-A*u,p.maxForce=m.maxForce=A*u,p.ri.copy(e.ri),p.rj.copy(e.rj),m.ri.copy(e.ri),m.rj.copy(e.rj),e.ni.tangents(p.t,m.t),p.setSpookParams(c.frictionEquationStiffness,c.frictionEquationRelaxation,a.dt),m.setSpookParams(c.frictionEquationStiffness,c.frictionEquationRelaxation,a.dt),p.enabled=m.enabled=e.enabled,t.push(p,m),!0}return!1}createFrictionFromAverage(e){let t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||e===1)return;const i=this.frictionResult[this.frictionResult.length-2],n=this.frictionResult[this.frictionResult.length-1];On.setZero(),cs.setZero(),As.setZero();const s=t.bi;t.bj;for(let a=0;a!==e;a++)t=this.result[this.result.length-1-a],t.bi!==s?(On.vadd(t.ni,On),cs.vadd(t.ri,cs),As.vadd(t.rj,As)):(On.vsub(t.ni,On),cs.vadd(t.rj,cs),As.vadd(t.ri,As));const r=1/e;cs.scale(r,i.ri),As.scale(r,i.rj),n.ri.copy(i.ri),n.rj.copy(i.rj),On.normalize(),On.tangents(i.t,n.t)}getContacts(e,t,i,n,s,r,a){this.contactPointPool=s,this.frictionEquationPool=a,this.result=n,this.frictionResult=r;const c=g0,h=m0,d=f0,l=p0;for(let A=0,u=e.length;A!==u;A++){const f=e[A],p=t[A];let m=null;f.material&&p.material&&(m=i.getContactMaterial(f.material,p.material)||null);const g=f.type&ve.KINEMATIC&&p.type&ve.STATIC||f.type&ve.STATIC&&p.type&ve.KINEMATIC||f.type&ve.KINEMATIC&&p.type&ve.KINEMATIC;for(let v=0;v<f.shapes.length;v++){f.quaternion.mult(f.shapeOrientations[v],c),f.quaternion.vmult(f.shapeOffsets[v],d),d.vadd(f.position,d);const C=f.shapes[v];for(let E=0;E<p.shapes.length;E++){p.quaternion.mult(p.shapeOrientations[E],h),p.quaternion.vmult(p.shapeOffsets[E],l),l.vadd(p.position,l);const _=p.shapes[E];if(!(C.collisionFilterMask&_.collisionFilterGroup&&_.collisionFilterMask&C.collisionFilterGroup)||d.distanceTo(l)>C.boundingSphereRadius+_.boundingSphereRadius)continue;let B=null;C.material&&_.material&&(B=i.getContactMaterial(C.material,_.material)||null),this.currentContactMaterial=B||m||i.defaultContactMaterial;const y=C.type|_.type,x=this[y];if(x){let w=!1;C.type<_.type?w=x.call(this,C,_,d,l,c,h,f,p,C,_,g):w=x.call(this,_,C,l,d,h,c,p,f,C,_,g),w&&g&&(i.shapeOverlapKeeper.set(C.id,_.id),i.bodyOverlapKeeper.set(f.id,p.id))}}}}}sphereSphere(e,t,i,n,s,r,a,c,h,d,l){if(l)return i.distanceSquared(n)<(e.radius+t.radius)**2;const A=this.createContactEquation(a,c,e,t,h,d);n.vsub(i,A.ni),A.ni.normalize(),A.ri.copy(A.ni),A.rj.copy(A.ni),A.ri.scale(e.radius,A.ri),A.rj.scale(-t.radius,A.rj),A.ri.vadd(i,A.ri),A.ri.vsub(a.position,A.ri),A.rj.vadd(n,A.rj),A.rj.vsub(c.position,A.rj),this.result.push(A),this.createFrictionEquationsFromContact(A,this.frictionResult)}spherePlane(e,t,i,n,s,r,a,c,h,d,l){const A=this.createContactEquation(a,c,e,t,h,d);if(A.ni.set(0,0,1),r.vmult(A.ni,A.ni),A.ni.negate(A.ni),A.ni.normalize(),A.ni.scale(e.radius,A.ri),i.vsub(n,Xr),A.ni.scale(A.ni.dot(Xr),jc),Xr.vsub(jc,A.rj),-Xr.dot(A.ni)<=e.radius){if(l)return!0;const u=A.ri,f=A.rj;u.vadd(i,u),u.vsub(a.position,u),f.vadd(n,f),f.vsub(c.position,f),this.result.push(A),this.createFrictionEquationsFromContact(A,this.frictionResult)}}boxBox(e,t,i,n,s,r,a,c,h,d,l){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,i,n,s,r,a,c,e,t,l)}sphereBox(e,t,i,n,s,r,a,c,h,d,l){const A=this.v3pool,u=z0;i.vsub(n,Wr),t.getSideNormals(u,r);const f=e.radius;let p=!1;const m=V0,g=K0,v=Y0;let C=null,E=0,_=0,B=0,y=null;for(let k=0,te=u.length;k!==te&&p===!1;k++){const W=k0;W.copy(u[k]);const J=W.length();W.normalize();const ee=Wr.dot(W);if(ee<J+f&&ee>0){const ae=N0,j=H0;ae.copy(u[(k+1)%3]),j.copy(u[(k+2)%3]);const Ee=ae.length(),Be=j.length();ae.normalize(),j.normalize();const H=Wr.dot(ae),G=Wr.dot(j);if(H<Ee&&H>-Ee&&G<Be&&G>-Be){const F=Math.abs(ee-J-f);if((y===null||F<y)&&(y=F,_=H,B=G,C=J,m.copy(W),g.copy(ae),v.copy(j),E++,l))return!0}}}if(E){p=!0;const k=this.createContactEquation(a,c,e,t,h,d);m.scale(-f,k.ri),k.ni.copy(m),k.ni.negate(k.ni),m.scale(C,m),g.scale(_,g),m.vadd(g,m),v.scale(B,v),m.vadd(v,k.rj),k.ri.vadd(i,k.ri),k.ri.vsub(a.position,k.ri),k.rj.vadd(n,k.rj),k.rj.vsub(c.position,k.rj),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult)}let x=A.get();const w=J0;for(let k=0;k!==2&&!p;k++)for(let te=0;te!==2&&!p;te++)for(let W=0;W!==2&&!p;W++)if(x.set(0,0,0),k?x.vadd(u[0],x):x.vsub(u[0],x),te?x.vadd(u[1],x):x.vsub(u[1],x),W?x.vadd(u[2],x):x.vsub(u[2],x),n.vadd(x,w),w.vsub(i,w),w.lengthSquared()<f*f){if(l)return!0;p=!0;const J=this.createContactEquation(a,c,e,t,h,d);J.ri.copy(w),J.ri.normalize(),J.ni.copy(J.ri),J.ri.scale(f,J.ri),J.rj.copy(x),J.ri.vadd(i,J.ri),J.ri.vsub(a.position,J.ri),J.rj.vadd(n,J.rj),J.rj.vsub(c.position,J.rj),this.result.push(J),this.createFrictionEquationsFromContact(J,this.frictionResult)}A.release(x),x=null;const b=A.get(),P=A.get(),O=A.get(),S=A.get(),D=A.get(),Q=u.length;for(let k=0;k!==Q&&!p;k++)for(let te=0;te!==Q&&!p;te++)if(k%3!==te%3){u[te].cross(u[k],b),b.normalize(),u[k].vadd(u[te],P),O.copy(i),O.vsub(P,O),O.vsub(n,O);const W=O.dot(b);b.scale(W,S);let J=0;for(;J===k%3||J===te%3;)J++;D.copy(i),D.vsub(S,D),D.vsub(P,D),D.vsub(n,D);const ee=Math.abs(W),ae=D.length();if(ee<u[J].length()&&ae<f){if(l)return!0;p=!0;const j=this.createContactEquation(a,c,e,t,h,d);P.vadd(S,j.rj),j.rj.copy(j.rj),D.negate(j.ni),j.ni.normalize(),j.ri.copy(j.rj),j.ri.vadd(n,j.ri),j.ri.vsub(i,j.ri),j.ri.normalize(),j.ri.scale(f,j.ri),j.ri.vadd(i,j.ri),j.ri.vsub(a.position,j.ri),j.rj.vadd(n,j.rj),j.rj.vsub(c.position,j.rj),this.result.push(j),this.createFrictionEquationsFromContact(j,this.frictionResult)}}A.release(b,P,O,S,D)}planeBox(e,t,i,n,s,r,a,c,h,d,l){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,i,n,s,r,a,c,e,t,l)}convexConvex(e,t,i,n,s,r,a,c,h,d,l,A,u){const f=l_;if(!(i.distanceTo(n)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,i,s,n,r,f,A,u)){const p=[],m=c_;e.clipAgainstHull(i,s,t,n,r,f,-100,100,p);let g=0;for(let v=0;v!==p.length;v++){if(l)return!0;const C=this.createContactEquation(a,c,e,t,h,d),E=C.ri,_=C.rj;f.negate(C.ni),p[v].normal.negate(m),m.scale(p[v].depth,m),p[v].point.vadd(m,E),_.copy(p[v].point),E.vsub(i,E),_.vsub(n,_),E.vadd(i,E),E.vsub(a.position,E),_.vadd(n,_),_.vsub(c.position,_),this.result.push(C),g++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(C,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)}}sphereConvex(e,t,i,n,s,r,a,c,h,d,l){const A=this.v3pool;i.vsub(n,q0);const u=t.faceNormals,f=t.faces,p=t.vertices,m=e.radius;let g=!1;for(let v=0;v!==p.length;v++){const C=p[v],E=Z0;r.vmult(C,E),n.vadd(E,E);const _=j0;if(E.vsub(i,_),_.lengthSquared()<m*m){if(l)return!0;g=!0;const B=this.createContactEquation(a,c,e,t,h,d);B.ri.copy(_),B.ri.normalize(),B.ni.copy(B.ri),B.ri.scale(m,B.ri),E.vsub(n,B.rj),B.ri.vadd(i,B.ri),B.ri.vsub(a.position,B.ri),B.rj.vadd(n,B.rj),B.rj.vsub(c.position,B.rj),this.result.push(B),this.createFrictionEquationsFromContact(B,this.frictionResult);return}}for(let v=0,C=f.length;v!==C&&g===!1;v++){const E=u[v],_=f[v],B=$0;r.vmult(E,B);const y=e_;r.vmult(p[_[0]],y),y.vadd(n,y);const x=t_;B.scale(-m,x),i.vadd(x,x);const w=i_;x.vsub(y,w);const b=w.dot(B),P=n_;if(i.vsub(y,P),b<0&&P.dot(B)>0){const O=[];for(let S=0,D=_.length;S!==D;S++){const Q=A.get();r.vmult(p[_[S]],Q),n.vadd(Q,Q),O.push(Q)}if(U0(O,B,i)){if(l)return!0;g=!0;const S=this.createContactEquation(a,c,e,t,h,d);B.scale(-m,S.ri),B.negate(S.ni);const D=A.get();B.scale(-b,D);const Q=A.get();B.scale(-m,Q),i.vsub(n,S.rj),S.rj.vadd(Q,S.rj),S.rj.vadd(D,S.rj),S.rj.vadd(n,S.rj),S.rj.vsub(c.position,S.rj),S.ri.vadd(i,S.ri),S.ri.vsub(a.position,S.ri),A.release(D),A.release(Q),this.result.push(S),this.createFrictionEquationsFromContact(S,this.frictionResult);for(let k=0,te=O.length;k!==te;k++)A.release(O[k]);return}else for(let S=0;S!==_.length;S++){const D=A.get(),Q=A.get();r.vmult(p[_[(S+1)%_.length]],D),r.vmult(p[_[(S+2)%_.length]],Q),n.vadd(D,D),n.vadd(Q,Q);const k=X0;Q.vsub(D,k);const te=W0;k.unit(te);const W=A.get(),J=A.get();i.vsub(D,J);const ee=J.dot(te);te.scale(ee,W),W.vadd(D,W);const ae=A.get();if(W.vsub(i,ae),ee>0&&ee*ee<k.lengthSquared()&&ae.lengthSquared()<m*m){if(l)return!0;const j=this.createContactEquation(a,c,e,t,h,d);W.vsub(n,j.rj),W.vsub(i,j.ni),j.ni.normalize(),j.ni.scale(m,j.ri),j.rj.vadd(n,j.rj),j.rj.vsub(c.position,j.rj),j.ri.vadd(i,j.ri),j.ri.vsub(a.position,j.ri),this.result.push(j),this.createFrictionEquationsFromContact(j,this.frictionResult);for(let Ee=0,Be=O.length;Ee!==Be;Ee++)A.release(O[Ee]);A.release(D),A.release(Q),A.release(W),A.release(ae),A.release(J);return}A.release(D),A.release(Q),A.release(W),A.release(ae),A.release(J)}for(let S=0,D=O.length;S!==D;S++)A.release(O[S])}}}planeConvex(e,t,i,n,s,r,a,c,h,d,l){const A=s_,u=r_;u.set(0,0,1),s.vmult(u,u);let f=0;const p=o_;for(let m=0;m!==t.vertices.length;m++)if(A.copy(t.vertices[m]),r.vmult(A,A),n.vadd(A,A),A.vsub(i,p),u.dot(p)<=0){if(l)return!0;const v=this.createContactEquation(a,c,e,t,h,d),C=a_;u.scale(u.dot(p),C),A.vsub(C,C),C.vsub(i,v.ri),v.ni.copy(u),A.vsub(n,v.rj),v.ri.vadd(i,v.ri),v.ri.vsub(a.position,v.ri),v.rj.vadd(n,v.rj),v.rj.vsub(c.position,v.rj),this.result.push(v),f++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(v,this.frictionResult)}this.enableFrictionReduction&&f&&this.createFrictionFromAverage(f)}boxConvex(e,t,i,n,s,r,a,c,h,d,l){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,i,n,s,r,a,c,e,t,l)}sphereHeightfield(e,t,i,n,s,r,a,c,h,d,l){const A=t.data,u=e.radius,f=t.elementSize,p=E_,m=C_;ke.pointToLocalFrame(n,r,i,m);let g=Math.floor((m.x-u)/f)-1,v=Math.ceil((m.x+u)/f)+1,C=Math.floor((m.y-u)/f)-1,E=Math.ceil((m.y+u)/f)+1;if(v<0||E<0||g>A.length||C>A[0].length)return;g<0&&(g=0),v<0&&(v=0),C<0&&(C=0),E<0&&(E=0),g>=A.length&&(g=A.length-1),v>=A.length&&(v=A.length-1),E>=A[0].length&&(E=A[0].length-1),C>=A[0].length&&(C=A[0].length-1);const _=[];t.getRectMinMax(g,C,v,E,_);const B=_[0],y=_[1];if(m.z-u>y||m.z+u<B)return;const x=this.result;for(let w=g;w<v;w++)for(let b=C;b<E;b++){const P=x.length;let O=!1;if(t.getConvexTrianglePillar(w,b,!1),ke.pointToWorldFrame(n,r,t.pillarOffset,p),i.distanceTo(p)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(O=this.sphereConvex(e,t.pillarConvex,i,p,s,r,a,c,e,t,l)),l&&O||(t.getConvexTrianglePillar(w,b,!0),ke.pointToWorldFrame(n,r,t.pillarOffset,p),i.distanceTo(p)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(O=this.sphereConvex(e,t.pillarConvex,i,p,s,r,a,c,e,t,l)),l&&O))return!0;if(x.length-P>2)return}}boxHeightfield(e,t,i,n,s,r,a,c,h,d,l){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,i,n,s,r,a,c,e,t,l)}convexHeightfield(e,t,i,n,s,r,a,c,h,d,l){const A=t.data,u=t.elementSize,f=e.boundingSphereRadius,p=v_,m=__,g=m_;ke.pointToLocalFrame(n,r,i,g);let v=Math.floor((g.x-f)/u)-1,C=Math.ceil((g.x+f)/u)+1,E=Math.floor((g.y-f)/u)-1,_=Math.ceil((g.y+f)/u)+1;if(C<0||_<0||v>A.length||E>A[0].length)return;v<0&&(v=0),C<0&&(C=0),E<0&&(E=0),_<0&&(_=0),v>=A.length&&(v=A.length-1),C>=A.length&&(C=A.length-1),_>=A[0].length&&(_=A[0].length-1),E>=A[0].length&&(E=A[0].length-1);const B=[];t.getRectMinMax(v,E,C,_,B);const y=B[0],x=B[1];if(!(g.z-f>x||g.z+f<y))for(let w=v;w<C;w++)for(let b=E;b<_;b++){let P=!1;if(t.getConvexTrianglePillar(w,b,!1),ke.pointToWorldFrame(n,r,t.pillarOffset,p),i.distanceTo(p)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(P=this.convexConvex(e,t.pillarConvex,i,p,s,r,a,c,null,null,l,m,null)),l&&P||(t.getConvexTrianglePillar(w,b,!0),ke.pointToWorldFrame(n,r,t.pillarOffset,p),i.distanceTo(p)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(P=this.convexConvex(e,t.pillarConvex,i,p,s,r,a,c,null,null,l,m,null)),l&&P))return!0}}sphereParticle(e,t,i,n,s,r,a,c,h,d,l){const A=d_;if(A.set(0,0,1),n.vsub(i,A),A.lengthSquared()<=e.radius*e.radius){if(l)return!0;const f=this.createContactEquation(c,a,t,e,h,d);A.normalize(),f.rj.copy(A),f.rj.scale(e.radius,f.rj),f.ni.copy(A),f.ni.negate(f.ni),f.ri.set(0,0,0),this.result.push(f),this.createFrictionEquationsFromContact(f,this.frictionResult)}}planeParticle(e,t,i,n,s,r,a,c,h,d,l){const A=A_;A.set(0,0,1),a.quaternion.vmult(A,A);const u=h_;if(n.vsub(a.position,u),A.dot(u)<=0){if(l)return!0;const p=this.createContactEquation(c,a,t,e,h,d);p.ni.copy(A),p.ni.negate(p.ni),p.ri.set(0,0,0);const m=u_;A.scale(A.dot(n),m),n.vsub(m,m),p.rj.copy(m),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult)}}boxParticle(e,t,i,n,s,r,a,c,h,d,l){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,i,n,s,r,a,c,e,t,l)}convexParticle(e,t,i,n,s,r,a,c,h,d,l){let A=-1;const u=p_,f=g_;let p=null;const m=f_;if(m.copy(n),m.vsub(i,m),s.conjugate(Zc),Zc.vmult(m,m),e.pointIsInside(m)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(i,s),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(s);for(let g=0,v=e.faces.length;g!==v;g++){const C=[e.worldVertices[e.faces[g][0]]],E=e.worldFaceNormals[g];n.vsub(C[0],$c);const _=-E.dot($c);if(p===null||Math.abs(_)<Math.abs(p)){if(l)return!0;p=_,A=g,u.copy(E)}}if(A!==-1){const g=this.createContactEquation(c,a,t,e,h,d);u.scale(p,f),f.vadd(n,f),f.vsub(i,f),g.rj.copy(f),u.negate(g.ni),g.ri.set(0,0,0);const v=g.ri,C=g.rj;v.vadd(n,v),v.vsub(c.position,v),C.vadd(i,C),C.vsub(a.position,C),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,t,i,n,s,r,a,c,h,d,l){return this.convexHeightfield(t,e,n,i,r,s,c,a,h,d,l)}particleCylinder(e,t,i,n,s,r,a,c,h,d,l){return this.convexParticle(t,e,n,i,r,s,c,a,h,d,l)}sphereTrimesh(e,t,i,n,s,r,a,c,h,d,l){const A=w0,u=x0,f=M0,p=S0,m=T0,g=b0,v=F0,C=I0,E=B0,_=O0;ke.pointToLocalFrame(n,r,i,m);const B=e.radius;v.lowerBound.set(m.x-B,m.y-B,m.z-B),v.upperBound.set(m.x+B,m.y+B,m.z+B),t.getTrianglesInAABB(v,_);const y=y0,x=e.radius*e.radius;for(let S=0;S<_.length;S++)for(let D=0;D<3;D++)if(t.getVertex(t.indices[_[S]*3+D],y),y.vsub(m,E),E.lengthSquared()<=x){if(C.copy(y),ke.pointToWorldFrame(n,r,C,y),y.vsub(i,E),l)return!0;let Q=this.createContactEquation(a,c,e,t,h,d);Q.ni.copy(E),Q.ni.normalize(),Q.ri.copy(Q.ni),Q.ri.scale(e.radius,Q.ri),Q.ri.vadd(i,Q.ri),Q.ri.vsub(a.position,Q.ri),Q.rj.copy(y),Q.rj.vsub(c.position,Q.rj),this.result.push(Q),this.createFrictionEquationsFromContact(Q,this.frictionResult)}for(let S=0;S<_.length;S++)for(let D=0;D<3;D++){t.getVertex(t.indices[_[S]*3+D],A),t.getVertex(t.indices[_[S]*3+(D+1)%3],u),u.vsub(A,f),m.vsub(u,g);const Q=g.dot(f);m.vsub(A,g);let k=g.dot(f);if(k>0&&Q<0&&(m.vsub(A,g),p.copy(f),p.normalize(),k=g.dot(p),p.scale(k,g),g.vadd(A,g),g.distanceTo(m)<e.radius)){if(l)return!0;const W=this.createContactEquation(a,c,e,t,h,d);g.vsub(m,W.ni),W.ni.normalize(),W.ni.scale(e.radius,W.ri),W.ri.vadd(i,W.ri),W.ri.vsub(a.position,W.ri),ke.pointToWorldFrame(n,r,g,g),g.vsub(c.position,W.rj),ke.vectorToWorldFrame(r,W.ni,W.ni),ke.vectorToWorldFrame(r,W.ri,W.ri),this.result.push(W),this.createFrictionEquationsFromContact(W,this.frictionResult)}}const w=D0,b=R0,P=Q0,O=E0;for(let S=0,D=_.length;S!==D;S++){t.getTriangleVertices(_[S],w,b,P),t.getNormal(_[S],O),m.vsub(w,g);let Q=g.dot(O);if(O.scale(Q,g),m.vsub(g,g),Q=g.distanceTo(m),pt.pointInTriangle(g,w,b,P)&&Q<e.radius){if(l)return!0;let k=this.createContactEquation(a,c,e,t,h,d);g.vsub(m,k.ni),k.ni.normalize(),k.ni.scale(e.radius,k.ri),k.ri.vadd(i,k.ri),k.ri.vsub(a.position,k.ri),ke.pointToWorldFrame(n,r,g,g),g.vsub(c.position,k.rj),ke.vectorToWorldFrame(r,k.ni,k.ni),ke.vectorToWorldFrame(r,k.ri,k.ri),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult)}}_.length=0}planeTrimesh(e,t,i,n,s,r,a,c,h,d,l){const A=new M,u=v0;u.set(0,0,1),s.vmult(u,u);for(let f=0;f<t.vertices.length/3;f++){t.getVertex(f,A);const p=new M;p.copy(A),ke.pointToWorldFrame(n,r,p,A);const m=_0;if(A.vsub(i,m),u.dot(m)<=0){if(l)return!0;const v=this.createContactEquation(a,c,e,t,h,d);v.ni.copy(u);const C=C0;u.scale(m.dot(u),C),A.vsub(C,C),v.ri.copy(C),v.ri.vsub(a.position,v.ri),v.rj.copy(A),v.rj.vsub(c.position,v.rj),this.result.push(v),this.createFrictionEquationsFromContact(v,this.frictionResult)}}}}const On=new M,cs=new M,As=new M,f0=new M,p0=new M,g0=new _t,m0=new _t,v0=new M,_0=new M,C0=new M,E0=new M,B0=new M;new M;const y0=new M,I0=new M,w0=new M,x0=new M,M0=new M,S0=new M,T0=new M,b0=new M,D0=new M,R0=new M,Q0=new M,F0=new oi,O0=[],Xr=new M,jc=new M,L0=new M,P0=new M,G0=new M;function U0(o,e,t){let i=null;const n=o.length;for(let s=0;s!==n;s++){const r=o[s],a=L0;o[(s+1)%n].vsub(r,a);const c=P0;a.cross(e,c);const h=G0;t.vsub(r,h);const d=c.dot(h);if(i===null||d>0&&i===!0||d<=0&&i===!1){i===null&&(i=d>0);continue}else return!1}return!0}const Wr=new M,k0=new M,N0=new M,H0=new M,z0=[new M,new M,new M,new M,new M,new M],J0=new M,V0=new M,K0=new M,Y0=new M,q0=new M,X0=new M,W0=new M,j0=new M,Z0=new M,$0=new M,e_=new M,t_=new M,i_=new M,n_=new M;new M;new M;const s_=new M,r_=new M,o_=new M,a_=new M,l_=new M,c_=new M,A_=new M,h_=new M,u_=new M,d_=new M,Zc=new _t,f_=new M;new M;const p_=new M,$c=new M,g_=new M,m_=new M,v_=new M,__=[0],C_=new M,E_=new M;class eA{constructor(){this.current=[],this.previous=[]}getKey(e,t){if(t<e){const i=t;t=e,e=i}return e<<16|t}set(e,t){const i=this.getKey(e,t),n=this.current;let s=0;for(;i>n[s];)s++;if(i!==n[s]){for(let r=n.length-1;r>=s;r--)n[r+1]=n[r];n[s]=i}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,t){const i=this.current,n=this.previous,s=i.length,r=n.length;let a=0;for(let c=0;c<s;c++){let h=!1;const d=i[c];for(;d>n[a];)a++;h=d===n[a],h||tA(e,d)}a=0;for(let c=0;c<r;c++){let h=!1;const d=n[c];for(;d>i[a];)a++;h=i[a]===d,h||tA(t,d)}}}function tA(o,e){o.push((e&4294901760)>>16,e&65535)}const fa=(o,e)=>o<e?`${o}-${e}`:`${e}-${o}`;class B_{constructor(){this.data={keys:[]}}get(e,t){const i=fa(e,t);return this.data[i]}set(e,t,i){const n=fa(e,t);this.get(e,t)||this.data.keys.push(n),this.data[n]=i}delete(e,t){const i=fa(e,t),n=this.data.keys.indexOf(i);n!==-1&&this.data.keys.splice(n,1),delete this.data[i]}reset(){const e=this.data,t=e.keys;for(;t.length>0;){const i=t.pop();delete e[i]}}}let y_=class extends nu{constructor(e){e===void 0&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=e.quatNormalizeSkip!==void 0?e.quatNormalizeSkip:0,this.quatNormalizeFast=e.quatNormalizeFast!==void 0?e.quatNormalizeFast:!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new M,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new M,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=e.broadphase!==void 0?e.broadphase:new bv,this.bodies=[],this.hasActiveBodies=!1,this.solver=e.solver!==void 0?e.solver:new a0,this.constraints=[],this.narrowphase=new d0(this),this.collisionMatrix=new kc,this.collisionMatrixPrevious=new kc,this.bodyOverlapKeeper=new eA,this.shapeOverlapKeeper=new eA,this.contactmaterials=[],this.contactMaterialTable=new B_,this.defaultMaterial=new bo("default"),this.defaultContactMaterial=new To(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,t){return this.contactMaterialTable.get(e.id,t.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const t=this.constraints.indexOf(e);t!==-1&&this.constraints.splice(t,1)}rayTest(e,t,i){i instanceof go?this.raycastClosest(e,t,{skipBackfaces:!0},i):this.raycastAll(e,t,{skipBackfaces:!0},i)}raycastAll(e,t,i,n){return i===void 0&&(i={}),i.mode=pt.ALL,i.from=e,i.to=t,i.callback=n,pa.intersectWorld(this,i)}raycastAny(e,t,i,n){return i===void 0&&(i={}),i.mode=pt.ANY,i.from=e,i.to=t,i.result=n,pa.intersectWorld(this,i)}raycastClosest(e,t,i,n){return i===void 0&&(i={}),i.mode=pt.CLOSEST,i.from=e,i.to=t,i.result=n,pa.intersectWorld(this,i)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof ve&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const t=this.bodies.length-1,i=this.bodies,n=i.indexOf(e);if(n!==-1){i.splice(n,1);for(let s=0;s!==i.length;s++)i[s].index=s;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const t=this.bodies;for(let i=0;i<t.length;i++){const n=t[i].shapes;for(let s=0;s<n.length;s++){const r=n[s];if(r.id===e)return r}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const t=this.contactmaterials.indexOf(e);t!==-1&&(this.contactmaterials.splice(t,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,t){e===void 0&&(e=1/60),t===void 0&&(t=10);const i=Et.now()/1e3;if(!this.lastCallTime)this.step(e,void 0,t);else{const n=i-this.lastCallTime;this.step(e,n,t)}this.lastCallTime=i}step(e,t,i){if(i===void 0&&(i=10),t===void 0)this.internalStep(e),this.time+=e;else{this.accumulator+=t;const n=Et.now();let s=0;for(;this.accumulator>=e&&s<i&&(this.internalStep(e),this.accumulator-=e,s++,!(Et.now()-n>e*1e3)););this.accumulator=this.accumulator%e;const r=this.accumulator/e;for(let a=0;a!==this.bodies.length;a++){const c=this.bodies[a];c.previousPosition.lerp(c.position,r,c.interpolatedPosition),c.previousQuaternion.slerp(c.quaternion,r,c.interpolatedQuaternion),c.previousQuaternion.normalize()}this.time+=t}}internalStep(e){this.dt=e;const t=this.contacts,i=S_,n=T_,s=this.bodies.length,r=this.bodies,a=this.solver,c=this.gravity,h=this.doProfiling,d=this.profile,l=ve.DYNAMIC;let A=-1/0;const u=this.constraints,f=M_;c.length();const p=c.x,m=c.y,g=c.z;let v=0;for(h&&(A=Et.now()),v=0;v!==s;v++){const S=r[v];if(S.type===l){const D=S.force,Q=S.mass;D.x+=Q*p,D.y+=Q*m,D.z+=Q*g}}for(let S=0,D=this.subsystems.length;S!==D;S++)this.subsystems[S].update();h&&(A=Et.now()),i.length=0,n.length=0,this.broadphase.collisionPairs(this,i,n),h&&(d.broadphase=Et.now()-A);let C=u.length;for(v=0;v!==C;v++){const S=u[v];if(!S.collideConnected)for(let D=i.length-1;D>=0;D-=1)(S.bodyA===i[D]&&S.bodyB===n[D]||S.bodyB===i[D]&&S.bodyA===n[D])&&(i.splice(D,1),n.splice(D,1))}this.collisionMatrixTick(),h&&(A=Et.now());const E=x_,_=t.length;for(v=0;v!==_;v++)E.push(t[v]);t.length=0;const B=this.frictionEquations.length;for(v=0;v!==B;v++)f.push(this.frictionEquations[v]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,n,this,t,E,this.frictionEquations,f),h&&(d.narrowphase=Et.now()-A),h&&(A=Et.now()),v=0;v<this.frictionEquations.length;v++)a.addEquation(this.frictionEquations[v]);const y=t.length;for(let S=0;S!==y;S++){const D=t[S],Q=D.bi,k=D.bj,te=D.si,W=D.sj;let J;if(Q.material&&k.material?J=this.getContactMaterial(Q.material,k.material)||this.defaultContactMaterial:J=this.defaultContactMaterial,J.friction,Q.material&&k.material&&(Q.material.friction>=0&&k.material.friction>=0&&Q.material.friction*k.material.friction,Q.material.restitution>=0&&k.material.restitution>=0&&(D.restitution=Q.material.restitution*k.material.restitution)),a.addEquation(D),Q.allowSleep&&Q.type===ve.DYNAMIC&&Q.sleepState===ve.SLEEPING&&k.sleepState===ve.AWAKE&&k.type!==ve.STATIC){const ee=k.velocity.lengthSquared()+k.angularVelocity.lengthSquared(),ae=k.sleepSpeedLimit**2;ee>=ae*2&&(Q.wakeUpAfterNarrowphase=!0)}if(k.allowSleep&&k.type===ve.DYNAMIC&&k.sleepState===ve.SLEEPING&&Q.sleepState===ve.AWAKE&&Q.type!==ve.STATIC){const ee=Q.velocity.lengthSquared()+Q.angularVelocity.lengthSquared(),ae=Q.sleepSpeedLimit**2;ee>=ae*2&&(k.wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(Q,k,!0),this.collisionMatrixPrevious.get(Q,k)||(Xs.body=k,Xs.contact=D,Q.dispatchEvent(Xs),Xs.body=Q,k.dispatchEvent(Xs)),this.bodyOverlapKeeper.set(Q.id,k.id),this.shapeOverlapKeeper.set(te.id,W.id)}for(this.emitContactEvents(),h&&(d.makeContactConstraints=Et.now()-A,A=Et.now()),v=0;v!==s;v++){const S=r[v];S.wakeUpAfterNarrowphase&&(S.wakeUp(),S.wakeUpAfterNarrowphase=!1)}for(C=u.length,v=0;v!==C;v++){const S=u[v];S.update();for(let D=0,Q=S.equations.length;D!==Q;D++){const k=S.equations[D];a.addEquation(k)}}a.solve(e,this),h&&(d.solve=Et.now()-A),a.removeAllEquations();const x=Math.pow;for(v=0;v!==s;v++){const S=r[v];if(S.type&l){const D=x(1-S.linearDamping,e),Q=S.velocity;Q.scale(D,Q);const k=S.angularVelocity;if(k){const te=x(1-S.angularDamping,e);k.scale(te,k)}}}this.dispatchEvent(w_),h&&(A=Et.now());const b=this.stepnumber%(this.quatNormalizeSkip+1)===0,P=this.quatNormalizeFast;for(v=0;v!==s;v++)r[v].integrate(e,b,P);this.clearForces(),this.broadphase.dirty=!0,h&&(d.integrate=Et.now()-A),this.stepnumber+=1,this.dispatchEvent(I_);let O=!0;if(this.allowSleep)for(O=!1,v=0;v!==s;v++){const S=r[v];S.sleepTick(this.time),S.sleepState!==ve.SLEEPING&&(O=!0)}this.hasActiveBodies=O}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(qi,Xi),e){for(let s=0,r=qi.length;s<r;s+=2)Ws.bodyA=this.getBodyById(qi[s]),Ws.bodyB=this.getBodyById(qi[s+1]),this.dispatchEvent(Ws);Ws.bodyA=Ws.bodyB=null}if(t){for(let s=0,r=Xi.length;s<r;s+=2)js.bodyA=this.getBodyById(Xi[s]),js.bodyB=this.getBodyById(Xi[s+1]),this.dispatchEvent(js);js.bodyA=js.bodyB=null}qi.length=Xi.length=0;const i=this.hasAnyEventListener("beginShapeContact"),n=this.hasAnyEventListener("endShapeContact");if((i||n)&&this.shapeOverlapKeeper.getDiff(qi,Xi),i){for(let s=0,r=qi.length;s<r;s+=2){const a=this.getShapeById(qi[s]),c=this.getShapeById(qi[s+1]);Wi.shapeA=a,Wi.shapeB=c,a&&(Wi.bodyA=a.body),c&&(Wi.bodyB=c.body),this.dispatchEvent(Wi)}Wi.bodyA=Wi.bodyB=Wi.shapeA=Wi.shapeB=null}if(n){for(let s=0,r=Xi.length;s<r;s+=2){const a=this.getShapeById(Xi[s]),c=this.getShapeById(Xi[s+1]);ji.shapeA=a,ji.shapeB=c,a&&(ji.bodyA=a.body),c&&(ji.bodyB=c.body),this.dispatchEvent(ji)}ji.bodyA=ji.bodyB=ji.shapeA=ji.shapeB=null}}clearForces(){const e=this.bodies,t=e.length;for(let i=0;i!==t;i++){const n=e[i];n.force,n.torque,n.force.set(0,0,0),n.torque.set(0,0,0)}}};new oi;const pa=new pt,Et=globalThis.performance||{};if(!Et.now){let o=Date.now();Et.timing&&Et.timing.navigationStart&&(o=Et.timing.navigationStart),Et.now=()=>Date.now()-o}new M;const I_={type:"postStep"},w_={type:"preStep"},Xs={type:ve.COLLIDE_EVENT_NAME,body:null,contact:null},x_=[],M_=[],S_=[],T_=[],qi=[],Xi=[],Ws={type:"beginContact",bodyA:null,bodyB:null},js={type:"endContact",bodyA:null,bodyB:null},Wi={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},ji={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};var ro={exports:{}},oo={exports:{}},b_=oo.exports,iA;function D_(){return iA||(iA=1,function(o){(function(e,t){o.exports?o.exports=t():e.EvEmitter=t()})(typeof window<"u"?window:b_,function(){function e(){}let t=e.prototype;return t.on=function(i,n){if(!i||!n)return this;let s=this._events=this._events||{},r=s[i]=s[i]||[];return r.includes(n)||r.push(n),this},t.once=function(i,n){if(!i||!n)return this;this.on(i,n);let s=this._onceEvents=this._onceEvents||{},r=s[i]=s[i]||{};return r[n]=!0,this},t.off=function(i,n){let s=this._events&&this._events[i];if(!s||!s.length)return this;let r=s.indexOf(n);return r!=-1&&s.splice(r,1),this},t.emitEvent=function(i,n){let s=this._events&&this._events[i];if(!s||!s.length)return this;s=s.slice(0),n=n||[];let r=this._onceEvents&&this._onceEvents[i];for(let a of s)r&&r[a]&&(this.off(i,a),delete r[a]),a.apply(this,n);return this},t.allOff=function(){return delete this._events,delete this._onceEvents,this},e})}(oo)),oo.exports}/*!
 * imagesLoaded v5.0.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */var R_=ro.exports,nA;function Q_(){return nA||(nA=1,function(o){(function(e,t){o.exports?o.exports=t(e,D_()):e.imagesLoaded=t(e,e.EvEmitter)})(typeof window<"u"?window:R_,function(t,i){let n=t.jQuery,s=t.console;function r(A){return Array.isArray(A)?A:typeof A=="object"&&typeof A.length=="number"?[...A]:[A]}function a(A,u,f){if(!(this instanceof a))return new a(A,u,f);let p=A;if(typeof A=="string"&&(p=document.querySelectorAll(A)),!p){s.error(`Bad element for imagesLoaded ${p||A}`);return}this.elements=r(p),this.options={},typeof u=="function"?f=u:Object.assign(this.options,u),f&&this.on("always",f),this.getImages(),n&&(this.jqDeferred=new n.Deferred),setTimeout(this.check.bind(this))}a.prototype=Object.create(i.prototype),a.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)};const c=[1,9,11];a.prototype.addElementImages=function(A){A.nodeName==="IMG"&&this.addImage(A),this.options.background===!0&&this.addElementBackgroundImages(A);let{nodeType:u}=A;if(!u||!c.includes(u))return;let f=A.querySelectorAll("img");for(let p of f)this.addImage(p);if(typeof this.options.background=="string"){let p=A.querySelectorAll(this.options.background);for(let m of p)this.addElementBackgroundImages(m)}};const h=/url\((['"])?(.*?)\1\)/gi;a.prototype.addElementBackgroundImages=function(A){let u=getComputedStyle(A);if(!u)return;let f=h.exec(u.backgroundImage);for(;f!==null;){let p=f&&f[2];p&&this.addBackground(p,A),f=h.exec(u.backgroundImage)}},a.prototype.addImage=function(A){let u=new d(A);this.images.push(u)},a.prototype.addBackground=function(A,u){let f=new l(A,u);this.images.push(f)},a.prototype.check=function(){if(this.progressedCount=0,this.hasAnyBroken=!1,!this.images.length){this.complete();return}let A=(u,f,p)=>{setTimeout(()=>{this.progress(u,f,p)})};this.images.forEach(function(u){u.once("progress",A),u.check()})},a.prototype.progress=function(A,u,f){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!A.isLoaded,this.emitEvent("progress",[this,A,u]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,A),this.progressedCount===this.images.length&&this.complete(),this.options.debug&&s&&s.log(`progress: ${f}`,A,u)},a.prototype.complete=function(){let A=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(A,[this]),this.emitEvent("always",[this]),this.jqDeferred){let u=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[u](this)}};function d(A){this.img=A}d.prototype=Object.create(i.prototype),d.prototype.check=function(){if(this.getIsImageComplete()){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}this.proxyImage=new Image,this.img.crossOrigin&&(this.proxyImage.crossOrigin=this.img.crossOrigin),this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.currentSrc||this.img.src},d.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},d.prototype.confirm=function(A,u){this.isLoaded=A;let{parentNode:f}=this.img,p=f.nodeName==="PICTURE"?f:this.img;this.emitEvent("progress",[this,p,u])},d.prototype.handleEvent=function(A){let u="on"+A.type;this[u]&&this[u](A)},d.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},d.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},d.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)};function l(A,u){this.url=A,this.element=u,this.img=new Image}return l.prototype=Object.create(d.prototype),l.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(this.img.naturalWidth!==0,"naturalWidth"),this.unbindEvents())},l.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},l.prototype.confirm=function(A,u){this.isLoaded=A,this.emitEvent("progress",[this,this.element,u])},a.makeJQueryPlugin=function(A){A=A||t.jQuery,A&&(n=A,n.fn.imagesLoaded=function(u,f){return new a(this,u,f).jqDeferred.promise(n(this))})},a.makeJQueryPlugin(),a})}(ro)),ro.exports}Q_();const F_=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"Mobile":"Desktop",O_="https://www.gstatic.com/draco/versioned/decoders/1.5.7/",L_=(o,e={})=>{const{unsuspend:t="loadedmetadata",crossOrigin:i="Anonymous",loop:n=!0,muted:s=!0,start:r=!0}=e;return new Promise(a=>{const c=Object.assign(document.createElement("video"),{src:o,crossOrigin:i,loop:n,muted:s,...e}),h=new Ef(c);c.addEventListener(t,()=>{r&&h.image.play(),a(h)})})},sA=(o,e)=>{const t=new Bf(o);t.compileEquirectangularShader();const i=t.fromEquirectangular(e).texture;return t.dispose(),i},Do=o=>{const e=[];return o.traverse(t=>{e.push(t)}),e},P_=(o,e)=>{const t=document.createElement("a");document.body.appendChild(t),t.style.display="none";const i=window.URL.createObjectURL(o);t.href=i,t.download=e,t.click()},G_=o=>new Promise(e=>setTimeout(e,o)),hu=Math.sqrt(3),U_=.5*(hu-1),Zs=(3-hu)/6,k_=1/3,Li=1/6,gr=o=>Math.floor(o)|0,rA=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),ga=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function N_(o=Math.random){const e=uu(o),t=new Float64Array(e).map(n=>rA[n%12*2]),i=new Float64Array(e).map(n=>rA[n%12*2+1]);return function(s,r){let a=0,c=0,h=0;const d=(s+r)*U_,l=gr(s+d),A=gr(r+d),u=(l+A)*Zs,f=l-u,p=A-u,m=s-f,g=r-p;let v,C;m>g?(v=1,C=0):(v=0,C=1);const E=m-v+Zs,_=g-C+Zs,B=m-1+2*Zs,y=g-1+2*Zs,x=l&255,w=A&255;let b=.5-m*m-g*g;if(b>=0){const S=x+e[w],D=t[S],Q=i[S];b*=b,a=b*b*(D*m+Q*g)}let P=.5-E*E-_*_;if(P>=0){const S=x+v+e[w+C],D=t[S],Q=i[S];P*=P,c=P*P*(D*E+Q*_)}let O=.5-B*B-y*y;if(O>=0){const S=x+1+e[w+1],D=t[S],Q=i[S];O*=O,h=O*O*(D*B+Q*y)}return 70*(a+c+h)}}function H_(o=Math.random){const e=uu(o),t=new Float64Array(e).map(s=>ga[s%12*3]),i=new Float64Array(e).map(s=>ga[s%12*3+1]),n=new Float64Array(e).map(s=>ga[s%12*3+2]);return function(r,a,c){let h,d,l,A;const u=(r+a+c)*k_,f=gr(r+u),p=gr(a+u),m=gr(c+u),g=(f+p+m)*Li,v=f-g,C=p-g,E=m-g,_=r-v,B=a-C,y=c-E;let x,w,b,P,O,S;_>=B?B>=y?(x=1,w=0,b=0,P=1,O=1,S=0):_>=y?(x=1,w=0,b=0,P=1,O=0,S=1):(x=0,w=0,b=1,P=1,O=0,S=1):B<y?(x=0,w=0,b=1,P=0,O=1,S=1):_<y?(x=0,w=1,b=0,P=0,O=1,S=1):(x=0,w=1,b=0,P=1,O=1,S=0);const D=_-x+Li,Q=B-w+Li,k=y-b+Li,te=_-P+2*Li,W=B-O+2*Li,J=y-S+2*Li,ee=_-1+3*Li,ae=B-1+3*Li,j=y-1+3*Li,Ee=f&255,Be=p&255,H=m&255;let G=.6-_*_-B*B-y*y;if(G<0)h=0;else{const ne=Ee+e[Be+e[H]];G*=G,h=G*G*(t[ne]*_+i[ne]*B+n[ne]*y)}let F=.6-D*D-Q*Q-k*k;if(F<0)d=0;else{const ne=Ee+x+e[Be+w+e[H+b]];F*=F,d=F*F*(t[ne]*D+i[ne]*Q+n[ne]*k)}let R=.6-te*te-W*W-J*J;if(R<0)l=0;else{const ne=Ee+P+e[Be+O+e[H+S]];R*=R,l=R*R*(t[ne]*te+i[ne]*W+n[ne]*J)}let Z=.6-ee*ee-ae*ae-j*j;if(Z<0)A=0;else{const ne=Ee+1+e[Be+1+e[H+1]];Z*=Z,A=Z*Z*(t[ne]*ee+i[ne]*ae+n[ne]*j)}return 32*(h+d+l+A)}}function uu(o){const t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){const n=i+~~(o()*(256-i)),s=t[i];t[i]=t[n],t[n]=s}for(let i=256;i<512;i++)t[i]=t[i-256];return t}H_();new xe;new xe;new xe;new Ce;class z_ extends xt{constructor(t,i,n={}){super(t);N(this,"config");N(this,"resourceList");N(this,"items");N(this,"toLoad");N(this,"loaded");N(this,"loaders");const{useDracoLoader:s=!1,useMeshoptDecoder:r=!1,dracoDecoderPath:a=O_,ktx2TranscoderPath:c="https://unpkg.com/three/examples/jsm/libs/basis/"}=n;this.config={useDracoLoader:s,useMeshoptDecoder:r,dracoDecoderPath:a,ktx2TranscoderPath:c},this.resourceList=i,this.items={},this.toLoad=i.length,this.loaded=0,this.loaders={},this.setLoaders(),s&&this.setDracoLoader(),r&&this.setMeshoptDecoder(),this.setKTX2Loader(),this.startLoading()}setLoaders(){this.loaders.gltfLoader=new ap,this.loaders.textureLoader=new xo,this.loaders.cubeTextureLoader=new yf,this.loaders.fontLoader=new Jp,this.loaders.fbxLoader=new Km,this.loaders.audioLoader=new If,this.loaders.objLoader=new Mg,this.loaders.hdrTextureLoader=new vg,this.loaders.svgLoader=new Eg,this.loaders.exrLoader=new _g,this.loaders.ktx2Loader=new pg}setDracoLoader(){var i;const t=new Sg;t.setDecoderPath(this.config.dracoDecoderPath),(i=this.loaders.gltfLoader)==null||i.setDRACOLoader(t)}setMeshoptDecoder(){var i;const t=bg();(i=this.loaders.gltfLoader)==null||i.setMeshoptDecoder(t)}setKTX2Loader(){var t,i,n;(i=(t=this.loaders.ktx2Loader)==null?void 0:t.setTranscoderPath(this.config.ktx2TranscoderPath))==null||i.detectSupport(this.base.renderer),this.loaders.ktx2Loader&&((n=this.loaders.gltfLoader)==null||n.setKTX2Loader(this.loaders.ktx2Loader))}startLoading(){var t,i,n,s,r,a,c,h,d,l,A;for(const u of this.resourceList)u.type==="gltfModel"?(t=this.loaders.gltfLoader)==null||t.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="texture"?(i=this.loaders.textureLoader)==null||i.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="cubeTexture"?(n=this.loaders.cubeTextureLoader)==null||n.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="font"?(s=this.loaders.fontLoader)==null||s.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="fbxModel"?(r=this.loaders.fbxLoader)==null||r.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="audio"?(a=this.loaders.audioLoader)==null||a.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="objModel"?(c=this.loaders.objLoader)==null||c.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="hdrTexture"?(h=this.loaders.hdrTextureLoader)==null||h.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="svg"?(d=this.loaders.svgLoader)==null||d.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="exrTexture"?(l=this.loaders.exrLoader)==null||l.load(u.path,f=>{this.resourceLoaded(u,f)}):u.type==="video"?L_(u.path).then(f=>{this.resourceLoaded(u,f)}):u.type==="ktx2Texture"&&((A=this.loaders.ktx2Loader)==null||A.load(u.path,f=>{this.resourceLoaded(u,f)}))}resourceLoaded(t,i){this.items[t.name]=i,this.loaded+=1,this.isLoaded&&this.emit("ready")}get loadProgress(){return this.loaded/this.toLoad}get isLoaded(){return this.loaded===this.toLoad}}class J_ extends xt{constructor(t){super(t);N(this,"clock");N(this,"deltaTime");N(this,"elapsedTime");const i=new wf;this.clock=i,this.deltaTime=0,this.elapsedTime=0}update(t){const i=this.clock.getElapsedTime(),n=i-this.elapsedTime;this.deltaTime=n,this.elapsedTime=i,this.emit("tick")}}class du extends xt{constructor(t){super(t);N(this,"shadertoyUniforms");this.shadertoyUniforms={iGlobalTime:{value:0},iTime:{value:0},iTimeDelta:{value:0},iResolution:{value:new xe(window.innerWidth,window.innerHeight,1)},iMouse:{value:new Yt(0,0,0,0)},iFrame:{value:0},iDate:{value:new Yt(new Date().getFullYear(),new Date().getMonth()+1,new Date().getDate(),new Date().getHours())},iSampleRate:{value:44100},iChannelTime:{value:[0,0,0,0]}}}injectShadertoyUniforms(t=this.shadertoyUniforms){const i=this.base.clock.elapsedTime;t.iGlobalTime.value=i,t.iTime.value=i;const n=this.base.clock.deltaTime;t.iTimeDelta.value=n,t.iResolution.value=new xe(window.innerWidth,window.innerHeight,1);const{x:s,y:r}=this.base.iMouse.mouse;t.iMouse.value=new Yt(s,r,0,0),t.iDate.value=new Yt(new Date().getFullYear(),new Date().getMonth()+1,new Date().getDate(),new Date().getHours()),t.iChannelTime.value=[i,i,i,i],t.iFrame.value+=1}}class V_ extends xt{constructor(t){super(t);N(this,"mouse");N(this,"mouseDOM");N(this,"mouseScreen");N(this,"prevMouseDOM");N(this,"isMouseMoving");N(this,"mouseMoveOffset");N(this,"mouseDOMDelta");const i=new Ce(0,0);this.mouse=i;const n=new Ce(0,0);this.mouseDOM=n;const s=new Ce(0,0);this.mouseScreen=s,this.prevMouseDOM=new Ce(0,0),this.isMouseMoving=!1,this.mouseMoveOffset=4,this.mouseDOMDelta=new Ce(0,0)}getMouse(t,i){return new Ce(t,window.innerHeight-i)}getMouseDOM(t,i){return new Ce(t,i)}getMouseScreen(t,i){return new Ce(t-window.innerWidth/2,-(i-window.innerHeight/2))}listenForMouse(){const t=F_();t==="Desktop"?this.listenForDesktop():t==="Mobile"&&this.listenForMobile()}listenForDesktop(){window.addEventListener("mousemove",t=>{const i=this.getMouse(t.clientX,t.clientY);this.mouse=i;const n=this.getMouseDOM(t.clientX,t.clientY);this.mouseDOM=n;const s=this.getMouseScreen(t.clientX,t.clientY);this.mouseScreen=s})}listenForMobile(){window.addEventListener("touchstart",t=>{const i=this.getMouse(t.touches[0].clientX,t.touches[0].clientY);this.mouse=i;const n=this.getMouseDOM(t.touches[0].clientX,t.touches[0].clientY);this.mouseDOM=n;const s=this.getMouseScreen(t.touches[0].clientX,t.touches[0].clientY);this.mouseScreen=s}),window.addEventListener("touchmove",t=>{const i=this.getMouse(t.touches[0].clientX,t.touches[0].clientY);this.mouse=i;const n=this.getMouseDOM(t.touches[0].clientX,t.touches[0].clientY);this.mouseDOM=n;const s=this.getMouseScreen(t.touches[0].clientX,t.touches[0].clientY);this.mouseScreen=s})}syncMouseDOM(){this.prevMouseDOM.x=this.mouseDOM.x,this.prevMouseDOM.y=this.mouseDOM.y}judgeIsMouseMoving(){Math.abs(this.mouseDOMDelta.x)<this.mouseMoveOffset&&Math.abs(this.mouseDOMDelta.y)<this.mouseMoveOffset?this.isMouseMoving=!1:this.isMouseMoving=!0}getMouseDOMDelta(){const t=this.mouseDOM.x-this.prevMouseDOM.x,i=this.mouseDOM.y-this.prevMouseDOM.y,n=new Ce(t,i);this.mouseDOMDelta=n}update(t){this.getMouseDOMDelta(),this.judgeIsMouseMoving(),this.syncMouseDOM()}}const ao=(o,e)=>{const t=e.x-o.x,i=e.y-o.y;return Math.sqrt(t*t+i*i)},K_=(o,e)=>{const t=e.x-o.x,i=e.y-o.y;return q_(Math.atan2(i,t))},Y_=(o,e,t)=>{const i={x:0,y:0};return t=tl(t),i.x=o.x-e*Math.cos(t),i.y=o.y-e*Math.sin(t),i},tl=o=>o*(Math.PI/180),q_=o=>o*(180/Math.PI),X_=o=>isNaN(o.buttons)?o.pressure!==0:o.buttons!==0,ma=new Map,oA=o=>{ma.has(o)&&clearTimeout(ma.get(o)),ma.set(o,setTimeout(o,100))},mo=(o,e,t)=>{const i=e.split(/[ ,]+/g);let n;for(let s=0;s<i.length;s+=1)n=i[s],o.addEventListener?o.addEventListener(n,t,!1):o.attachEvent&&o.attachEvent(n,t)},aA=(o,e,t)=>{const i=e.split(/[ ,]+/g);let n;for(let s=0;s<i.length;s+=1)n=i[s],o.removeEventListener?o.removeEventListener(n,t):o.detachEvent&&o.detachEvent(n,t)},fu=o=>(o.preventDefault(),o.type.match(/^touch/)?o.changedTouches:o),lA=()=>{const o=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:o,y:e}},cA=(o,e)=>{e.top||e.right||e.bottom||e.left?(o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left):(o.style.left=e.x+"px",o.style.top=e.y+"px")},Fl=(o,e,t)=>{const i=pu(o);for(let n in i)if(i.hasOwnProperty(n))if(typeof e=="string")i[n]=e+" "+t;else{let s="";for(let r=0,a=e.length;r<a;r+=1)s+=e[r]+" "+t+", ";i[n]=s.slice(0,-2)}return i},W_=(o,e)=>{const t=pu(o);for(let i in t)t.hasOwnProperty(i)&&(t[i]=e);return t},pu=o=>{const e={};return e[o]="",["webkit","Moz","o"].forEach(function(i){e[i+o.charAt(0).toUpperCase()+o.slice(1)]=""}),e},va=(o,e)=>{for(let t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);return o},j_=(o,e)=>{const t={};for(let i in o)o.hasOwnProperty(i)&&e.hasOwnProperty(i)?t[i]=e[i]:o.hasOwnProperty(i)&&(t[i]=o[i]);return t},il=(o,e)=>{if(o.length)for(let t=0,i=o.length;t<i;t+=1)e(o[t]);else e(o)},Z_=(o,e,t)=>({x:Math.min(Math.max(o.x,e.x-t),e.x+t),y:Math.min(Math.max(o.y,e.y-t),e.y+t)});var $_="ontouchstart"in window,eC=!!window.PointerEvent,tC=!!window.MSPointerEvent,$s={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Cs,yr={};eC?Cs=$s.pointer:tC?Cs=$s.MSPointer:$_?(Cs=$s.touch,yr=$s.mouse):Cs=$s.mouse;function cn(){}cn.prototype.on=function(o,e){var t=this,i=o.split(/[ ,]+/g),n;t._handlers_=t._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],t._handlers_[n]=t._handlers_[n]||[],t._handlers_[n].push(e);return t};cn.prototype.off=function(o,e){var t=this;return t._handlers_=t._handlers_||{},o===void 0?t._handlers_={}:e===void 0?t._handlers_[o]=null:t._handlers_[o]&&t._handlers_[o].indexOf(e)>=0&&t._handlers_[o].splice(t._handlers_[o].indexOf(e),1),t};cn.prototype.trigger=function(o,e){var t=this,i=o.split(/[ ,]+/g),n;t._handlers_=t._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],t._handlers_[n]&&t._handlers_[n].length&&t._handlers_[n].forEach(function(r){r.call(t,{type:n,target:t},e)})};cn.prototype.config=function(o){var e=this;e.options=e.defaults||{},o&&(e.options=j_(e.options,o))};cn.prototype.bindEvt=function(o,e){var t=this;return t._domHandlers_=t._domHandlers_||{},t._domHandlers_[e]=function(){typeof t["on"+e]=="function"?t["on"+e].apply(t,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},mo(o,Cs[e],t._domHandlers_[e]),yr[e]&&mo(o,yr[e],t._domHandlers_[e]),t};cn.prototype.unbindEvt=function(o,e){var t=this;return t._domHandlers_=t._domHandlers_||{},aA(o,Cs[e],t._domHandlers_[e]),yr[e]&&aA(o,yr[e],t._domHandlers_[e]),delete t._domHandlers_[e],this};function Bt(o,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=o,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Bt.id,Bt.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Bt.prototype=new cn;Bt.constructor=Bt;Bt.id=0;Bt.prototype.buildEl=function(o){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Bt.prototype.stylize=function(){if(this.options.dataOnly)return this;var o=this.options.fadeTime+"ms",e=W_("borderRadius","50%"),t=Fl("transition","opacity",o),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},va(i.el,t),this.options.shape==="circle"&&va(i.back,e),va(i.front,e),this.applyStyles(i),this};Bt.prototype.applyStyles=function(o){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var t in o[e])this.ui[e].style[t]=o[e][t];return this};Bt.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Bt.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Bt.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Bt.prototype.show=function(o){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof o=="function"&&o.call(this)},e.options.fadeTime)),e};Bt.prototype.hide=function(o){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var t=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=t,typeof o=="function"&&o.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const t=e.options.restJoystick,i={};i.x=t===!0||t.x!==!1?0:e.instance.frontPosition.x,i.y=t===!0||t.y!==!1?0:e.instance.frontPosition.y,e.setPosition(o,i)}return e};Bt.prototype.setPosition=function(o,e){var t=this;t.frontPosition={x:e.x,y:e.y};var i=t.options.fadeTime+"ms",n={};n.front=Fl("transition",["transform"],i);var s={front:{}};s.front={transform:"translate("+t.frontPosition.x+"px,"+t.frontPosition.y+"px)"},t.applyStyles(n),t.applyStyles(s),t.restTimeout=setTimeout(function(){typeof o=="function"&&o.call(t),t.restCallback()},t.options.fadeTime)};Bt.prototype.restCallback=function(){var o=this,e={};e.front=Fl("transition","none",""),o.applyStyles(e),o.trigger("rested",o.instance)};Bt.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Bt.prototype.computeDirection=function(o){var e=o.angle.radian,t=Math.PI/4,i=Math.PI/2,n,s,r;if(e>t&&e<t*3&&!o.lockX?n="up":e>-t&&e<=t&&!o.lockY?n="left":e>-t*3&&e<=-t&&!o.lockX?n="down":o.lockY||(n="right"),o.lockY||(e>-i&&e<i?s="left":s="right"),o.lockX||(e>0?r="up":r="down"),o.force>this.options.threshold){var a={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(a[c]=this.direction[c]);var h={};this.direction={x:s,y:r,angle:n},o.direction=this.direction;for(c in a)a[c]===this.direction[c]&&(h[c]=!0);if(h.x&&h.y&&h.angle)return o;(!h.x||!h.y)&&this.trigger("plain",o),h.x||this.trigger("plain:"+s,o),h.y||this.trigger("plain:"+r,o),h.angle||this.trigger("dir dir:"+n,o)}else this.resetDirection();return o};function ft(o,e){var t=this;t.nipples=[],t.idles=[],t.actives=[],t.ids=[],t.pressureIntervals={},t.manager=o,t.id=ft.id,ft.id+=1,t.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},t.config(e),(t.options.mode==="static"||t.options.mode==="semi")&&(t.options.multitouch=!1),t.options.multitouch||(t.options.maxNumberOfNipples=1);const i=getComputedStyle(t.options.zone.parentElement);return i&&i.display==="flex"&&(t.parentIsFlex=!0),t.updateBox(),t.prepareNipples(),t.bindings(),t.begin(),t.nipples}ft.prototype=new cn;ft.constructor=ft;ft.id=0;ft.prototype.prepareNipples=function(){var o=this,e=o.nipples;e.on=o.on.bind(o),e.off=o.off.bind(o),e.options=o.options,e.destroy=o.destroy.bind(o),e.ids=o.ids,e.id=o.id,e.processOnMove=o.processOnMove.bind(o),e.processOnEnd=o.processOnEnd.bind(o),e.get=function(t){if(t===void 0)return e[0];for(var i=0,n=e.length;i<n;i+=1)if(e[i].identifier===t)return e[i];return!1}};ft.prototype.bindings=function(){var o=this;o.bindEvt(o.options.zone,"start"),o.options.zone.style.touchAction="none",o.options.zone.style.msTouchAction="none"};ft.prototype.begin=function(){var o=this,e=o.options;if(e.mode==="static"){var t=o.createNipple(e.position,o.manager.getIdentifier());t.add(),o.idles.push(t)}};ft.prototype.createNipple=function(o,e){var t=this,i=t.manager.scroll,n={},s=t.options,r={x:t.parentIsFlex?i.x:i.x+t.box.left,y:t.parentIsFlex?i.y:i.y+t.box.top};if(o.x&&o.y)n={x:o.x-r.x,y:o.y-r.y};else if(o.top||o.right||o.bottom||o.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=o.top,a.style.right=o.right,a.style.bottom=o.bottom,a.style.left=o.left,a.style.position="absolute",s.zone.appendChild(a);var c=a.getBoundingClientRect();s.zone.removeChild(a),n=o,o={x:c.left+i.x,y:c.top+i.y}}var h=new Bt(t,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:o,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(cA(h.ui.el,n),cA(h.ui.front,h.frontPosition)),t.nipples.push(h),t.trigger("added "+h.identifier+":added",h),t.manager.trigger("added "+h.identifier+":added",h),t.bindNipple(h),h};ft.prototype.updateBox=function(){var o=this;o.box=o.options.zone.getBoundingClientRect()};ft.prototype.bindNipple=function(o){var e=this,t,i=function(n,s){t=n.type+" "+s.id+":"+n.type,e.trigger(t,s)};o.on("destroyed",e.onDestroyed.bind(e)),o.on("shown hidden rested dir plain",i),o.on("dir:up dir:right dir:down dir:left",i),o.on("plain:up plain:right plain:down plain:left",i)};ft.prototype.pressureFn=function(o,e,t){var i=this,n=0;clearInterval(i.pressureIntervals[t]),i.pressureIntervals[t]=setInterval((function(){var s=o.force||o.pressure||o.webkitForce||0;s!==n&&(e.trigger("pressure",s),i.trigger("pressure "+e.identifier+":pressure",s),n=s)}).bind(i),100)};ft.prototype.onstart=function(o){var e=this,t=e.options,i=o;o=fu(o),e.updateBox();var n=function(s){e.actives.length<t.maxNumberOfNipples?e.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(r){if(Object.values(i.touches).findIndex(function(c){return c.identifier===r})<0){var a=[o[0]];a.identifier=r,e.processOnEnd(a)}}),e.actives.length<t.maxNumberOfNipples&&e.processOnStart(s))};return il(o,n),e.manager.bindDocument(),!1};ft.prototype.processOnStart=function(o){var e=this,t=e.options,i,n=e.manager.getIdentifier(o),s=o.force||o.pressure||o.webkitForce||0,r={x:o.pageX,y:o.pageY},a=e.getOrCreate(n,r);a.identifier!==n&&e.manager.removeIdentifier(a.identifier),a.identifier=n;var c=function(d){d.trigger("start",d),e.trigger("start "+d.id+":start",d),d.show(),s>0&&e.pressureFn(o,d,d.identifier),e.processOnMove(o)};if((i=e.idles.indexOf(a))>=0&&e.idles.splice(i,1),e.actives.push(a),e.ids.push(a.identifier),t.mode!=="semi")c(a);else{var h=ao(r,a.position);if(h<=t.catchDistance)c(a);else{a.destroy(),e.processOnStart(o);return}}return a};ft.prototype.getOrCreate=function(o,e){var t=this,i=t.options,n;return/(semi|static)/.test(i.mode)?(n=t.idles[0],n?(t.idles.splice(0,1),n):i.mode==="semi"?t.createNipple(e,o):(console.warn("Coudln't find the needed nipple."),!1)):(n=t.createNipple(e,o),n)};ft.prototype.processOnMove=function(o){var e=this,t=e.options,i=e.manager.getIdentifier(o),n=e.nipples.get(i),s=e.manager.scroll;if(!X_(o)){this.processOnEnd(o);return}if(!n){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(t.dynamicPage){var r=n.el.getBoundingClientRect();n.position={x:s.x+r.left,y:s.y+r.top}}n.identifier=i;var a=n.options.size/2,c={x:o.pageX,y:o.pageY};t.lockX&&(c.y=n.position.y),t.lockY&&(c.x=n.position.x);var h=ao(c,n.position),d=K_(c,n.position),l=tl(d),A=h/a,u={distance:h,position:c},f,p;if(n.options.shape==="circle"?(f=Math.min(h,a),p=Y_(n.position,f,d)):(p=Z_(c,n.position,a),f=ao(p,n.position)),t.follow){if(h>a){let C=c.x-p.x,E=c.y-p.y;n.position.x+=C,n.position.y+=E,n.el.style.top=n.position.y-(e.box.top+s.y)+"px",n.el.style.left=n.position.x-(e.box.left+s.x)+"px",h=ao(c,n.position)}}else c=p,h=f;var m=c.x-n.position.x,g=c.y-n.position.y;n.frontPosition={x:m,y:g},t.dataOnly||(n.ui.front.style.transform="translate("+m+"px,"+g+"px)");var v={identifier:n.identifier,position:c,force:A,pressure:o.force||o.pressure||o.webkitForce||0,distance:h,angle:{radian:l,degree:d},vector:{x:m/a,y:-g/a},raw:u,instance:n,lockX:t.lockX,lockY:t.lockY};v=n.computeDirection(v),v.angle={radian:tl(180-d),degree:180-d},n.trigger("move",v),e.trigger("move "+n.id+":move",v)};ft.prototype.processOnEnd=function(o){var e=this,t=e.options,i=e.manager.getIdentifier(o),n=e.nipples.get(i),s=e.manager.removeIdentifier(n.identifier);n&&(t.dataOnly||n.hide(function(){t.mode==="dynamic"&&(n.trigger("removed",n),e.trigger("removed "+n.id+":removed",n),e.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(e.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),e.trigger("end "+n.id+":end",n),e.ids.indexOf(n.identifier)>=0&&e.ids.splice(e.ids.indexOf(n.identifier),1),e.actives.indexOf(n)>=0&&e.actives.splice(e.actives.indexOf(n),1),/(semi|static)/.test(t.mode)?e.idles.push(n):e.nipples.indexOf(n)>=0&&e.nipples.splice(e.nipples.indexOf(n),1),e.manager.unbindDocument(),/(semi|static)/.test(t.mode)&&(e.manager.ids[s.id]=s.identifier))};ft.prototype.onDestroyed=function(o,e){var t=this;t.nipples.indexOf(e)>=0&&t.nipples.splice(t.nipples.indexOf(e),1),t.actives.indexOf(e)>=0&&t.actives.splice(t.actives.indexOf(e),1),t.idles.indexOf(e)>=0&&t.idles.splice(t.idles.indexOf(e),1),t.ids.indexOf(e.identifier)>=0&&t.ids.splice(t.ids.indexOf(e.identifier),1),t.manager.removeIdentifier(e.identifier),t.manager.unbindDocument()};ft.prototype.destroy=function(){var o=this;o.unbindEvt(o.options.zone,"start"),o.nipples.forEach(function(t){t.destroy()});for(var e in o.pressureIntervals)o.pressureIntervals.hasOwnProperty(e)&&clearInterval(o.pressureIntervals[e]);o.trigger("destroyed",o.nipples),o.manager.unbindDocument(),o.off()};function It(o){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=lA(),e.config(o),e.prepareCollections();var t=function(){var n;e.collections.forEach(function(s){s.forEach(function(r){n=r.el.getBoundingClientRect(),r.position={x:e.scroll.x+n.left,y:e.scroll.y+n.top}})})};mo(window,"resize",function(){oA(t)});var i=function(){e.scroll=lA()};return mo(window,"scroll",function(){oA(i)}),e.collections}It.prototype=new cn;It.constructor=It;It.prototype.prepareCollections=function(){var o=this;o.collections.create=o.create.bind(o),o.collections.on=o.on.bind(o),o.collections.off=o.off.bind(o),o.collections.destroy=o.destroy.bind(o),o.collections.get=function(e){var t;return o.collections.every(function(i){return t=i.get(e),!t}),t}};It.prototype.create=function(o){return this.createCollection(o)};It.prototype.createCollection=function(o){var e=this,t=new ft(e,o);return e.bindCollection(t),e.collections.push(t),t};It.prototype.bindCollection=function(o){var e=this,t,i=function(n,s){t=n.type+" "+s.id+":"+n.type,e.trigger(t,s)};o.on("destroyed",e.onDestroyed.bind(e)),o.on("shown hidden rested dir plain",i),o.on("dir:up dir:right dir:down dir:left",i),o.on("plain:up plain:right plain:down plain:left",i)};It.prototype.bindDocument=function(){var o=this;o.binded||(o.bindEvt(document,"move").bindEvt(document,"end"),o.binded=!0)};It.prototype.unbindDocument=function(o){var e=this;(!Object.keys(e.ids).length||o===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};It.prototype.getIdentifier=function(o){var e;return o?(e=o.identifier===void 0?o.pointerId:o.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};It.prototype.removeIdentifier=function(o){var e={};for(var t in this.ids)if(this.ids[t]===o){e.id=t,e.identifier=this.ids[t],delete this.ids[t];break}return e};It.prototype.onmove=function(o){var e=this;return e.onAny("move",o),!1};It.prototype.onend=function(o){var e=this;return e.onAny("end",o),!1};It.prototype.oncancel=function(o){var e=this;return e.onAny("end",o),!1};It.prototype.onAny=function(o,e){var t=this,i,n="processOn"+o.charAt(0).toUpperCase()+o.slice(1);e=fu(e);var s=function(a,c,h){h.ids.indexOf(c)>=0&&(h[n](a),a._found_=!0)},r=function(a){i=t.getIdentifier(a),il(t.collections,s.bind(null,a,i)),a._found_||t.removeIdentifier(i)};return il(e,r),!1};It.prototype.destroy=function(){var o=this;o.unbindDocument(!0),o.ids={},o.index=0,o.collections.forEach(function(e){e.destroy()}),o.off()};It.prototype.onDestroyed=function(o,e){var t=this;if(t.collections.indexOf(e)<0)return!1;t.collections.splice(t.collections.indexOf(e),1)};new It;class iC{constructor(){N(this,"keys");this.keys={}}listenForKey(){window.addEventListener("keydown",e=>{this.onKeyDown(e)}),window.addEventListener("keyup",e=>{this.onKeyUp(e)})}onKeyDown(e){this.keys[e.key]=!0}onKeyUp(e){this.keys[e.key]=!1}get isUpKeyDown(){return this.keys.w||this.keys.ArrowUp}get isDownKeyDown(){return this.keys.s||this.keys.ArrowDown}get isLeftKeyDown(){return this.keys.a||this.keys.ArrowLeft}get isRightKeyDown(){return this.keys.d||this.keys.ArrowRight}get isSpaceKeyDown(){return this.keys[" "]}get isEnterKeyDown(){return this.keys.Enter}get isBackspaceKeyDown(){return this.keys.Backspace}get isCtrlKeyDown(){return this.keys.Control}get isShiftKeyDown(){return this.keys.Shift}get isTabKeyDown(){return this.keys.Tab}get isEscKeyDown(){return this.keys.Escape}}class nC extends xt{constructor(t){super(t);N(this,"world");N(this,"meshPhysicsObjects");const i=new y_;i.gravity.set(0,-9.82,0),this.world=i,this.meshPhysicsObjects=[]}add({mesh:t,body:i,copyPosition:n=!0,copyQuaternion:s=!0}){const r=new sC(t,i,n,s);this.base.physics.world.addBody(i),this.meshPhysicsObjects.push(r)}tick(){const t=this.world,i=this.base.clock.deltaTime;t.step(1/60,i,3)}sync(){this.meshPhysicsObjects.forEach(t=>{const{mesh:i,body:n,copyPosition:s,copyQuaternion:r}=t;s&&i.position.copy(n.position),r&&i.quaternion.copy(n.quaternion)})}update(t){this.sync(),this.tick()}}class sC{constructor(e,t,i=!0,n=!0){N(this,"mesh");N(this,"body");N(this,"copyPosition");N(this,"copyQuaternion");this.mesh=e,this.body=t,this.copyPosition=i,this.copyQuaternion=n}}class rC extends wo{constructor(t={}){const i=window.innerWidth/window.innerHeight,{frustum:n=5.7,near:s=.1,far:r=2e3,useAspect:a=!0}=t,c=a?i:1;super(c*n*-.5,c*n*.5,n*.5,n*-.5,s,r);N(this,"frustum");N(this,"useAspect");this.frustum=n,this.useAspect=a}}new xo;class oC extends xt{constructor(t,i={}){super(t);N(this,"enabled");N(this,"autoAdaptMobile");this.enabled=!0;const{autoAdaptMobile:n=!1}=i;this.autoAdaptMobile=n,this.autoAdaptMobile&&this.resize()}get aspect(){return window.innerWidth/window.innerHeight}resizeRenderer(t){t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(2,window.devicePixelRatio))}resizeComposer(t){t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio&&t.setPixelRatio(Math.min(2,window.devicePixelRatio))}resizeCamera(t){const{aspect:i}=this;if(t instanceof rn)t.aspect=i,t.updateProjectionMatrix();else if(t instanceof rC){const{frustum:n,useAspect:s}=t;if(n){const r=s?i:1;[t.left,t.right,t.top,t.bottom]=[r*n*-.5,r*n*.5,n*.5,n*-.5],t.updateProjectionMatrix()}}}resize(){const{base:t}=this,{renderer:i,camera:n,composer:s}=t;this.resizeRenderer(i),s&&this.resizeComposer(s),this.resizeCamera(n),this.autoAdaptMobile&&this.adaptMobile(),this.emit("resize")}listenForResize(){window.addEventListener("resize",()=>{this.enabled&&this.resize()})}enable(){this.enabled=!0}disable(){this.enabled=!1}adaptMobile(){const{base:t}=this,{renderer:i,camera:n}=t,s=document.documentElement.clientWidth,r=document.documentElement.clientHeight;s>r?(i.setSize(s,r),n instanceof rn&&(n.aspect=s/r,n.updateProjectionMatrix())):(i.setSize(r,s),n instanceof rn&&(n.aspect=r/s,n.updateProjectionMatrix()))}}var lo={exports:{}},aC=lo.exports,AA;function lC(){return AA||(AA=1,function(o,e){(function(t,i){o.exports=i()})(aC,function(){var t=function(){function i(u){return r.appendChild(u.dom),u}function n(u){for(var f=0;f<r.children.length;f++)r.children[f].style.display=f===u?"block":"none";s=u}var s=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(u){u.preventDefault(),n(++s%r.children.length)},!1);var a=(performance||Date).now(),c=a,h=0,d=i(new t.Panel("FPS","#0ff","#002")),l=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var A=i(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:r,addPanel:i,showPanel:n,begin:function(){a=(performance||Date).now()},end:function(){h++;var u=(performance||Date).now();if(l.update(u-a,200),u>c+1e3&&(d.update(1e3*h/(u-c),100),c=u,h=0,A)){var f=performance.memory;A.update(f.usedJSHeapSize/1048576,f.jsHeapSizeLimit/1048576)}return u},update:function(){a=this.end()},domElement:r,setMode:n}};return t.Panel=function(i,n,s){var r=1/0,a=0,c=Math.round,h=c(window.devicePixelRatio||1),d=80*h,l=48*h,A=3*h,u=2*h,f=3*h,p=15*h,m=74*h,g=30*h,v=document.createElement("canvas");v.width=d,v.height=l,v.style.cssText="width:80px;height:48px";var C=v.getContext("2d");return C.font="bold "+9*h+"px Helvetica,Arial,sans-serif",C.textBaseline="top",C.fillStyle=s,C.fillRect(0,0,d,l),C.fillStyle=n,C.fillText(i,A,u),C.fillRect(f,p,m,g),C.fillStyle=s,C.globalAlpha=.9,C.fillRect(f,p,m,g),{dom:v,update:function(E,_){r=Math.min(r,E),a=Math.max(a,E),C.fillStyle=s,C.globalAlpha=1,C.fillRect(0,0,d,p),C.fillStyle=n,C.fillText(c(E)+" "+i+" ("+c(r)+"-"+c(a)+")",A,u),C.drawImage(v,f+h,p,m-h,g,f,p,m-h,g),C.fillRect(f+m-h,p,h,g),C.fillStyle=s,C.globalAlpha=.9,C.fillRect(f+m-h,p,h,c((1-E/_)*g))}}},t})}(lo)),lo.exports}var cC=lC();const AC=Qr(cC);class hC extends xt{constructor(t){super(t);N(this,"stats");const i=new AC;this.stats=i,this.base.container.appendChild(this.stats.dom)}update(t){this.stats.update()}}class uC{constructor(e="#sketch",t={}){N(this,"camera");N(this,"scene");N(this,"renderer");N(this,"container");N(this,"animator");N(this,"interactionManager");N(this,"composer");N(this,"clock");N(this,"iMouse");N(this,"physics");N(this,"resizer");N(this,"keyboard");const{hello:i=!0,gl:n={},autoAdaptMobile:s=!1,autoRender:r=!0}=t;i&&console.log("%c- powered by kokomi.js -","padding: 5px 10px; background: #030A8C; font-size: 11px");const a=new rn(70,window.innerWidth/window.innerHeight,.01,100);a.position.z=1,this.camera=a;const c=new fo;this.scene=c;const h=new xf({antialias:!0,alpha:!0,...n});h.setSize(window.innerWidth,window.innerHeight),h.setPixelRatio(Math.min(2,window.devicePixelRatio)),this.renderer=h;const d=document.querySelector(e);d==null||d.appendChild(h.domElement),this.container=d;const l=new zf(this,{autoRender:r});this.animator=l;const A=new Hf(this.renderer,this.camera,this.renderer.domElement);this.interactionManager=A,this.composer=null;const u=new J_(this);this.clock=u;const f=new V_(this);this.iMouse=f;const p=new nC(this);this.physics=p;const m=new oC(this,{autoAdaptMobile:s});this.resizer=m;const g=new iC;this.keyboard=g,this.init(),this.addEventListeners()}addEventListeners(){this.resizer.listenForResize(),this.iMouse.listenForMouse(),this.keyboard.listenForKey()}update(e){this.animator.add(e)}init(){this.update(()=>{this.interactionManager.update()}),this.animator.update()}render(){this.composer?this.composer.render():this.renderer.render(this.scene,this.camera)}async saveScreenshot(e="screenshot.png"){this.render();const t=await new Promise(i=>{this.renderer.domElement.toBlob(i,"image/png")});t&&P_(t,e)}destroy(){this.scene.traverse(e=>{var t;e instanceof Ei&&((t=e.geometry)==null||t.dispose(),Object.values(e.material).forEach(i=>{i&&typeof i.dispose=="function"&&i.dispose()}))}),this.renderer.dispose()}}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const at={LEFT:1,RIGHT:2,MIDDLE:4},V=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),hs={NONE:0,IN:1,OUT:-1};function Ln(o){return o.isPerspectiveCamera}function vn(o){return o.isOrthographicCamera}const us=Math.PI*2,hA=Math.PI/2,gu=1e-5,er=Math.PI/180;function xi(o,e,t){return Math.max(e,Math.min(t,o))}function Ze(o,e=gu){return Math.abs(o)<e}function Ne(o,e,t=gu){return Ze(o-e,t)}function uA(o,e){return Math.round(o/e)*e}function tr(o){return isFinite(o)?o:o<0?-Number.MAX_VALUE:Number.MAX_VALUE}function ir(o){return Math.abs(o)<Number.MAX_VALUE?o:o*(1/0)}function jr(o,e,t,i,n=1/0,s){i=Math.max(1e-4,i);const r=2/i,a=r*s,c=1/(1+a+.48*a*a+.235*a*a*a);let h=o-e;const d=e,l=n*i;h=xi(h,-l,l),e=o-h;const A=(t.value+r*h)*s;t.value=(t.value-r*A)*c;let u=e+(h+A)*c;return d-o>0==u>d&&(u=d,t.value=(u-d)/s),u}function dA(o,e,t,i,n=1/0,s,r){i=Math.max(1e-4,i);const a=2/i,c=a*s,h=1/(1+c+.48*c*c+.235*c*c*c);let d=e.x,l=e.y,A=e.z,u=o.x-d,f=o.y-l,p=o.z-A;const m=d,g=l,v=A,C=n*i,E=C*C,_=u*u+f*f+p*p;if(_>E){const Q=Math.sqrt(_);u=u/Q*C,f=f/Q*C,p=p/Q*C}d=o.x-u,l=o.y-f,A=o.z-p;const B=(t.x+a*u)*s,y=(t.y+a*f)*s,x=(t.z+a*p)*s;t.x=(t.x-a*B)*h,t.y=(t.y-a*y)*h,t.z=(t.z-a*x)*h,r.x=d+(u+B)*h,r.y=l+(f+y)*h,r.z=A+(p+x)*h;const w=m-o.x,b=g-o.y,P=v-o.z,O=r.x-m,S=r.y-g,D=r.z-v;return w*O+b*S+P*D>0&&(r.x=m,r.y=g,r.z=v,t.x=(r.x-m)/s,t.y=(r.y-g)/s,t.z=(r.z-v)/s),r}function _a(o,e){e.set(0,0),o.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=o.length,e.y/=o.length}function Ca(o,e){return vn(o)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class dC{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners[e];if(n!==void 0){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const i=this._listeners[e.type];if(i!==void 0){e.target=this;const n=i.slice(0);for(let s=0,r=n.length;s<r;s++)n[s].call(this,e)}}}var Ea;const fC="2.10.1",Zr=1/8,pC=/Mac/.test((Ea=globalThis==null?void 0:globalThis.navigator)===null||Ea===void 0?void 0:Ea.platform);let we,fA,$r,Ba,Vt,Se,Pe,ds,nr,Pi,Gi,Pn,pA,gA,ui,sr,fs,mA,ya,vA,Ia,wa,eo,_A=class nl extends dC{static install(e){we=e.THREE,fA=Object.freeze(new we.Vector3(0,0,0)),$r=Object.freeze(new we.Vector3(0,1,0)),Ba=Object.freeze(new we.Vector3(0,0,1)),Vt=new we.Vector2,Se=new we.Vector3,Pe=new we.Vector3,ds=new we.Vector3,nr=new we.Vector3,Pi=new we.Vector3,Gi=new we.Vector3,Pn=new we.Vector3,pA=new we.Vector3,gA=new we.Vector3,ui=new we.Spherical,sr=new we.Spherical,fs=new we.Box3,mA=new we.Box3,ya=new we.Sphere,vA=new we.Quaternion,Ia=new we.Quaternion,wa=new we.Matrix4,eo=new we.Raycaster}static get ACTION(){return V}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=V.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=hs.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new we.Vector3,this._focalOffsetVelocity=new we.Vector3,this._zoomVelocity={value:0},this._truckInternal=(g,v,C,E)=>{let _,B;if(Ln(this._camera)){const y=Se.copy(this._camera.position).sub(this._target),x=this._camera.getEffectiveFOV()*er,w=y.length()*Math.tan(x*.5);_=this.truckSpeed*g*w/this._elementRect.height,B=this.truckSpeed*v*w/this._elementRect.height}else if(vn(this._camera)){const y=this._camera;_=this.truckSpeed*g*(y.right-y.left)/y.zoom/this._elementRect.width,B=this.truckSpeed*v*(y.top-y.bottom)/y.zoom/this._elementRect.height}else return;E?(C?this.setFocalOffset(this._focalOffsetEnd.x+_,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(_,0,!0),this.forward(-B,!0)):C?this.setFocalOffset(this._focalOffsetEnd.x+_,this._focalOffsetEnd.y+B,this._focalOffsetEnd.z,!0):this.truck(_,B,!0)},this._rotateInternal=(g,v)=>{const C=us*this.azimuthRotateSpeed*g/this._elementRect.height,E=us*this.polarRotateSpeed*v/this._elementRect.height;this.rotate(C,E,!0)},this._dollyInternal=(g,v,C)=>{const E=Math.pow(.95,-g*this.dollySpeed),_=this._sphericalEnd.radius,B=this._sphericalEnd.radius*E,y=xi(B,this.minDistance,this.maxDistance),x=y-B;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(B,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(x,!0),this._dollyToNoClamp(y,!0)):this._dollyToNoClamp(y,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?B:y)-_,this._dollyControlCoord.set(v,C)),this._lastDollyDirection=Math.sign(-g)},this._zoomInternal=(g,v,C)=>{const E=Math.pow(.95,g*this.dollySpeed),_=this._zoom,B=this._zoom*E;this.zoomTo(B,!0),this.dollyToCursor&&(this._changedZoom+=B-_,this._dollyControlCoord.set(v,C))},typeof we>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new we.Quaternion().setFromUnitVectors(this._camera.up,$r),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=V.NONE,this._target=new we.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new we.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new we.Spherical().setFromVector3(Se.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new we.Vector3,new we.Vector3,new we.Vector3,new we.Vector3],this._updateNearPlaneCorners(),this._boundary=new we.Box3(new we.Vector3(-1/0,-1/0,-1/0),new we.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new we.Vector2,this.mouseButtons={left:V.ROTATE,middle:V.DOLLY,right:V.TRUCK,wheel:Ln(this._camera)?V.DOLLY:vn(this._camera)?V.ZOOM:V.NONE},this.touches={one:V.TOUCH_ROTATE,two:Ln(this._camera)?V.TOUCH_DOLLY_TRUCK:vn(this._camera)?V.TOUCH_ZOOM_TRUCK:V.NONE,three:V.TOUCH_TRUCK};const i=new we.Vector2,n=new we.Vector2,s=new we.Vector2,r=g=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const E=this._domElement.getBoundingClientRect(),_=g.clientX/E.width,B=g.clientY/E.height;if(_<this._interactiveArea.left||_>this._interactiveArea.right||B<this._interactiveArea.top||B>this._interactiveArea.bottom)return}const v=g.pointerType!=="mouse"?null:(g.buttons&at.LEFT)===at.LEFT?at.LEFT:(g.buttons&at.MIDDLE)===at.MIDDLE?at.MIDDLE:(g.buttons&at.RIGHT)===at.RIGHT?at.RIGHT:null;if(v!==null){const E=this._findPointerByMouseButton(v);E&&this._disposePointer(E)}if((g.buttons&at.LEFT)===at.LEFT&&this._lockedPointer)return;const C={pointerId:g.pointerId,clientX:g.clientX,clientY:g.clientY,deltaX:0,deltaY:0,mouseButton:v};this._activePointers.push(C),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),this._isDragging=!0,A(g)},a=g=>{g.cancelable&&g.preventDefault();const v=g.pointerId,C=this._lockedPointer||this._findPointerById(v);if(C){if(C.clientX=g.clientX,C.clientY=g.clientY,C.deltaX=g.movementX,C.deltaY=g.movementY,this._state=0,g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(g.buttons&at.LEFT)===at.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(g.buttons&at.MIDDLE)===at.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(g.buttons&at.RIGHT)===at.RIGHT&&(this._state=this._state|this.mouseButtons.right);u()}},c=g=>{const v=this._findPointerById(g.pointerId);if(!(v&&v===this._lockedPointer)){if(v&&this._disposePointer(v),g.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=V.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=V.NONE;f()}};let h=-1;const d=g=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===V.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const B=this._domElement.getBoundingClientRect(),y=g.clientX/B.width,x=g.clientY/B.height;if(y<this._interactiveArea.left||y>this._interactiveArea.right||x<this._interactiveArea.top||x>this._interactiveArea.bottom)return}if(g.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===V.ROTATE||this.mouseButtons.wheel===V.TRUCK){const B=performance.now();h-B<1e3&&this._getClientRect(this._elementRect),h=B}const v=pC?-1:-3,C=g.deltaMode===1||g.ctrlKey?g.deltaY/v:g.deltaY/(v*10),E=this.dollyToCursor?(g.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,_=this.dollyToCursor?(g.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case V.ROTATE:{this._rotateInternal(g.deltaX,g.deltaY),this._isUserControllingRotate=!0;break}case V.TRUCK:{this._truckInternal(g.deltaX,g.deltaY,!1,!1),this._isUserControllingTruck=!0;break}case V.SCREEN_PAN:{this._truckInternal(g.deltaX,g.deltaY,!1,!0),this._isUserControllingTruck=!0;break}case V.OFFSET:{this._truckInternal(g.deltaX,g.deltaY,!0,!1),this._isUserControllingOffset=!0;break}case V.DOLLY:{this._dollyInternal(-C,E,_),this._isUserControllingDolly=!0;break}case V.ZOOM:{this._zoomInternal(-C,E,_),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},l=g=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===nl.ACTION.NONE){const v=g instanceof PointerEvent?g.pointerId:0,C=this._findPointerById(v);C&&this._disposePointer(C),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c);return}g.preventDefault()}},A=g=>{if(!this._enabled)return;if(_a(this._activePointers,Vt),this._getClientRect(this._elementRect),i.copy(Vt),n.copy(Vt),this._activePointers.length>=2){const C=Vt.x-this._activePointers[1].clientX,E=Vt.y-this._activePointers[1].clientY,_=Math.sqrt(C*C+E*E);s.set(0,_);const B=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,y=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(B,y)}if(this._state=0,!g)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in g&&g.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(g.buttons&at.LEFT)===at.LEFT&&(this._state=this._state|this.mouseButtons.left),(g.buttons&at.MIDDLE)===at.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(g.buttons&at.RIGHT)===at.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&V.ROTATE)===V.ROTATE||(this._state&V.TOUCH_ROTATE)===V.TOUCH_ROTATE||(this._state&V.TOUCH_DOLLY_ROTATE)===V.TOUCH_DOLLY_ROTATE||(this._state&V.TOUCH_ZOOM_ROTATE)===V.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&V.TRUCK)===V.TRUCK||(this._state&V.SCREEN_PAN)===V.SCREEN_PAN||(this._state&V.TOUCH_TRUCK)===V.TOUCH_TRUCK||(this._state&V.TOUCH_SCREEN_PAN)===V.TOUCH_SCREEN_PAN||(this._state&V.TOUCH_DOLLY_TRUCK)===V.TOUCH_DOLLY_TRUCK||(this._state&V.TOUCH_DOLLY_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN||(this._state&V.TOUCH_ZOOM_TRUCK)===V.TOUCH_ZOOM_TRUCK||(this._state&V.TOUCH_ZOOM_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&V.DOLLY)===V.DOLLY||(this._state&V.TOUCH_DOLLY)===V.TOUCH_DOLLY||(this._state&V.TOUCH_DOLLY_TRUCK)===V.TOUCH_DOLLY_TRUCK||(this._state&V.TOUCH_DOLLY_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN||(this._state&V.TOUCH_DOLLY_OFFSET)===V.TOUCH_DOLLY_OFFSET||(this._state&V.TOUCH_DOLLY_ROTATE)===V.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&V.ZOOM)===V.ZOOM||(this._state&V.TOUCH_ZOOM)===V.TOUCH_ZOOM||(this._state&V.TOUCH_ZOOM_TRUCK)===V.TOUCH_ZOOM_TRUCK||(this._state&V.TOUCH_ZOOM_SCREEN_PAN)===V.TOUCH_ZOOM_SCREEN_PAN||(this._state&V.TOUCH_ZOOM_OFFSET)===V.TOUCH_ZOOM_OFFSET||(this._state&V.TOUCH_ZOOM_ROTATE)===V.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&V.OFFSET)===V.OFFSET||(this._state&V.TOUCH_OFFSET)===V.TOUCH_OFFSET||(this._state&V.TOUCH_DOLLY_OFFSET)===V.TOUCH_DOLLY_OFFSET||(this._state&V.TOUCH_ZOOM_OFFSET)===V.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},u=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,_a(this._activePointers,Vt);const v=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,C=v?-v.deltaX:n.x-Vt.x,E=v?-v.deltaY:n.y-Vt.y;if(n.copy(Vt),((this._state&V.ROTATE)===V.ROTATE||(this._state&V.TOUCH_ROTATE)===V.TOUCH_ROTATE||(this._state&V.TOUCH_DOLLY_ROTATE)===V.TOUCH_DOLLY_ROTATE||(this._state&V.TOUCH_ZOOM_ROTATE)===V.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(C,E),this._isUserControllingRotate=!0),(this._state&V.DOLLY)===V.DOLLY||(this._state&V.ZOOM)===V.ZOOM){const _=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,B=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,y=this.dollyDragInverted?-1:1;(this._state&V.DOLLY)===V.DOLLY?(this._dollyInternal(y*E*Zr,_,B),this._isUserControllingDolly=!0):(this._zoomInternal(y*E*Zr,_,B),this._isUserControllingZoom=!0)}if((this._state&V.TOUCH_DOLLY)===V.TOUCH_DOLLY||(this._state&V.TOUCH_ZOOM)===V.TOUCH_ZOOM||(this._state&V.TOUCH_DOLLY_TRUCK)===V.TOUCH_DOLLY_TRUCK||(this._state&V.TOUCH_ZOOM_TRUCK)===V.TOUCH_ZOOM_TRUCK||(this._state&V.TOUCH_DOLLY_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN||(this._state&V.TOUCH_ZOOM_SCREEN_PAN)===V.TOUCH_ZOOM_SCREEN_PAN||(this._state&V.TOUCH_DOLLY_OFFSET)===V.TOUCH_DOLLY_OFFSET||(this._state&V.TOUCH_ZOOM_OFFSET)===V.TOUCH_ZOOM_OFFSET||(this._state&V.TOUCH_DOLLY_ROTATE)===V.TOUCH_DOLLY_ROTATE||(this._state&V.TOUCH_ZOOM_ROTATE)===V.TOUCH_ZOOM_ROTATE){const _=Vt.x-this._activePointers[1].clientX,B=Vt.y-this._activePointers[1].clientY,y=Math.sqrt(_*_+B*B),x=s.y-y;s.set(0,y);const w=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,b=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&V.TOUCH_DOLLY)===V.TOUCH_DOLLY||(this._state&V.TOUCH_DOLLY_ROTATE)===V.TOUCH_DOLLY_ROTATE||(this._state&V.TOUCH_DOLLY_TRUCK)===V.TOUCH_DOLLY_TRUCK||(this._state&V.TOUCH_DOLLY_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN||(this._state&V.TOUCH_DOLLY_OFFSET)===V.TOUCH_DOLLY_OFFSET?(this._dollyInternal(x*Zr,w,b),this._isUserControllingDolly=!0):(this._zoomInternal(x*Zr,w,b),this._isUserControllingZoom=!0)}((this._state&V.TRUCK)===V.TRUCK||(this._state&V.TOUCH_TRUCK)===V.TOUCH_TRUCK||(this._state&V.TOUCH_DOLLY_TRUCK)===V.TOUCH_DOLLY_TRUCK||(this._state&V.TOUCH_ZOOM_TRUCK)===V.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(C,E,!1,!1),this._isUserControllingTruck=!0),((this._state&V.SCREEN_PAN)===V.SCREEN_PAN||(this._state&V.TOUCH_SCREEN_PAN)===V.TOUCH_SCREEN_PAN||(this._state&V.TOUCH_DOLLY_SCREEN_PAN)===V.TOUCH_DOLLY_SCREEN_PAN||(this._state&V.TOUCH_ZOOM_SCREEN_PAN)===V.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(C,E,!1,!0),this._isUserControllingTruck=!0),((this._state&V.OFFSET)===V.OFFSET||(this._state&V.TOUCH_OFFSET)===V.TOUCH_OFFSET||(this._state&V.TOUCH_DOLLY_OFFSET)===V.TOUCH_DOLLY_OFFSET||(this._state&V.TOUCH_ZOOM_OFFSET)===V.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(C,E,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},f=()=>{_a(this._activePointers,Vt),n.copy(Vt),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",p),this._domElement.ownerDocument.addEventListener("pointerlockerror",m),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),A())},this.unlockPointer=()=>{var g,v,C;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(g=this._domElement)===null||g===void 0||g.ownerDocument.exitPointerLock(),(v=this._domElement)===null||v===void 0||v.ownerDocument.removeEventListener("pointerlockchange",p),(C=this._domElement)===null||C===void 0||C.ownerDocument.removeEventListener("pointerlockerror",m),this.cancel()};const p=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},m=()=>{this.unlockPointer()};this._addAllEventListeners=g=>{this._domElement=g,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",r),this._domElement.addEventListener("pointercancel",c),this._domElement.addEventListener("wheel",d,{passive:!1}),this._domElement.addEventListener("contextmenu",l)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",r),this._domElement.removeEventListener("pointercancel",c),this._domElement.removeEventListener("wheel",d,{passive:!1}),this._domElement.removeEventListener("contextmenu",l),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("pointerlockchange",p),this._domElement.ownerDocument.removeEventListener("pointerlockerror",m))},this.cancel=()=>{this._state!==V.NONE&&(this._state=V.NONE,this._activePointers.length=0,f())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=xi(e.width,0,1),this._interactiveArea.height=xi(e.height,0,1),this._interactiveArea.x=xi(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=xi(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,i)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,i=!1){this._isUserControllingRotate=!1;const n=xi(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=xi(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const r=!i||Ne(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Ne(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(r)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=hs.NONE,this._changedDolly=0,this._dollyToNoClamp(xi(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const r=this._collisionTest(),a=Ne(r,this._spherical.radius);if(!(i>e)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,r)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const s=!t||Ne(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(nr).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const i=!t||Ne(this._target.x,this._targetEnd.x,this.restThreshold)&&Ne(this._target.y,this._targetEnd.y,this.restThreshold)&&Ne(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=xi(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const i=!t||Ne(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(e,t,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,i)}truck(e,t,i=!1){this._camera.updateMatrix(),Pi.setFromMatrixColumn(this._camera.matrix,0),Gi.setFromMatrixColumn(this._camera.matrix,1),Pi.multiplyScalar(e),Gi.multiplyScalar(-t);const n=Se.copy(Pi).add(Gi),s=Pe.copy(this._targetEnd).add(n);return this.moveTo(s.x,s.y,s.z,i)}forward(e,t=!1){Se.setFromMatrixColumn(this._camera.matrix,0),Se.crossVectors(this._camera.up,Se),Se.multiplyScalar(e);const i=Pe.copy(this._targetEnd).add(Se);return this.moveTo(i.x,i.y,i.z,t)}elevate(e,t=!1){return Se.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Se.x,this._targetEnd.y+Se.y,this._targetEnd.z+Se.z,t)}moveTo(e,t,i,n=!1){this._isUserControllingTruck=!1;const s=Se.set(e,t,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);const r=!n||Ne(this._target.x,this._targetEnd.x,this.restThreshold)&&Ne(this._target.y,this._targetEnd.y,this.restThreshold)&&Ne(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}lookInDirectionOf(e,t,i,n=!1){const a=Se.set(e,t,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(a.x,a.y,a.z,n)}fitToBox(e,t,{cover:i=!1,paddingLeft:n=0,paddingRight:s=0,paddingBottom:r=0,paddingTop:a=0}={}){const c=[],h=e.isBox3?fs.copy(e):fs.setFromObject(e);h.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const d=uA(this._sphericalEnd.theta,hA),l=uA(this._sphericalEnd.phi,hA);c.push(this.rotateTo(d,l,t));const A=Se.setFromSpherical(this._sphericalEnd).normalize(),u=vA.setFromUnitVectors(A,Ba),f=Ne(Math.abs(A.y),1);f&&u.multiply(Ia.setFromAxisAngle($r,d)),u.multiply(this._yAxisUpSpaceInverse);const p=mA.makeEmpty();Pe.copy(h.min).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.min).setX(h.max.x).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.min).setY(h.max.y).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.max).setZ(h.min.z).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.min).setZ(h.max.z).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.max).setY(h.min.y).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.max).setX(h.min.x).applyQuaternion(u),p.expandByPoint(Pe),Pe.copy(h.max).applyQuaternion(u),p.expandByPoint(Pe),p.min.x-=n,p.min.y-=r,p.max.x+=s,p.max.y+=a,u.setFromUnitVectors(Ba,A),f&&u.premultiply(Ia.invert()),u.premultiply(this._yAxisUpSpace);const m=p.getSize(Se),g=p.getCenter(Pe).applyQuaternion(u);if(Ln(this._camera)){const v=this.getDistanceToFitBox(m.x,m.y,m.z,i);c.push(this.moveTo(g.x,g.y,g.z,t)),c.push(this.dollyTo(v,t)),c.push(this.setFocalOffset(0,0,0,t))}else if(vn(this._camera)){const v=this._camera,C=v.right-v.left,E=v.top-v.bottom,_=i?Math.max(C/m.x,E/m.y):Math.min(C/m.x,E/m.y);c.push(this.moveTo(g.x,g.y,g.z,t)),c.push(this.zoomTo(_,t)),c.push(this.setFocalOffset(0,0,0,t))}return Promise.all(c)}fitToSphere(e,t){const i=[],s="isObject3D"in e?nl.createBoundingSphere(e,ya):ya.copy(e);if(i.push(this.moveTo(s.center.x,s.center.y,s.center.z,t)),Ln(this._camera)){const r=this.getDistanceToFitSphere(s.radius);i.push(this.dollyTo(r,t))}else if(vn(this._camera)){const r=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,c=2*s.radius,h=Math.min(r/c,a/c);i.push(this.zoomTo(h,t))}return i.push(this.setFocalOffset(0,0,0,t)),Promise.all(i)}setLookAt(e,t,i,n,s,r,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=hs.NONE,this._changedDolly=0;const c=Pe.set(n,s,r),h=Se.set(e,t,i);this._targetEnd.copy(c),this._sphericalEnd.setFromVector3(h.sub(c).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const d=!a||Ne(this._target.x,this._targetEnd.x,this.restThreshold)&&Ne(this._target.y,this._targetEnd.y,this.restThreshold)&&Ne(this._target.z,this._targetEnd.z,this.restThreshold)&&Ne(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Ne(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Ne(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(d)}lerpLookAt(e,t,i,n,s,r,a,c,h,d,l,A,u,f=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=hs.NONE,this._changedDolly=0;const p=Se.set(n,s,r),m=Pe.set(e,t,i);ui.setFromVector3(m.sub(p).applyQuaternion(this._yAxisUpSpace));const g=ds.set(d,l,A),v=Pe.set(a,c,h);sr.setFromVector3(v.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(g,u));const C=sr.theta-ui.theta,E=sr.phi-ui.phi,_=sr.radius-ui.radius;this._sphericalEnd.set(ui.radius+_*u,ui.phi+E*u,ui.theta+C*u),this.normalizeRotations(),this._needsUpdate=!0,f||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const B=!f||Ne(this._target.x,this._targetEnd.x,this.restThreshold)&&Ne(this._target.y,this._targetEnd.y,this.restThreshold)&&Ne(this._target.z,this._targetEnd.z,this.restThreshold)&&Ne(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Ne(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Ne(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(B)}setPosition(e,t,i,n=!1){return this.setLookAt(e,t,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,i,n=!1){const s=this.getPosition(Se),r=this.setLookAt(s.x,s.y,s.z,e,t,i,n);return this._sphericalEnd.phi=xi(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),r}setFocalOffset(e,t,i,n=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,i),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);const s=!n||Ne(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Ne(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Ne(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,i){this._camera.updateMatrixWorld(),Pi.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Gi.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Pn.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const n=Se.set(e,t,i),s=n.distanceTo(this._camera.position),r=n.sub(this._camera.position);Pi.multiplyScalar(r.x),Gi.multiplyScalar(r.y),Pn.multiplyScalar(r.z),Se.copy(Pi).add(Gi).add(Pn),Se.z=Se.z+s,this.dollyTo(s,!1),this.setFocalOffset(-Se.x,Se.y,-Se.z,!1),this.moveTo(e,t,i,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,i,n){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new we.Vector4,typeof e=="number"?this._viewport.set(e,t,i,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,i,n=!1){if(Ca(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,r=this._camera.getEffectiveFOV()*er,a=this._camera.aspect;return((n?s>a:s<a)?t:e/a)*.5/Math.tan(r*.5)+i*.5}getDistanceToFitSphere(e){if(Ca(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*er,i=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,n=1<this._camera.aspect?t:i;return e/Math.sin(n*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new we.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new we.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new we.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new we.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%us,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=us),this._spherical.theta+=us*Math.round((this._sphericalEnd.theta-this._spherical.theta)/us)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!Ne(this._camera.up.x,this._cameraUp0.x)||!Ne(this._camera.up.y,this._cameraUp0.y)||!Ne(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(Se);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,$r),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Se.subVectors(this._target,this._camera.position).normalize(),t=Pe.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(Se);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,s=pA.subVectors(this._targetEnd,this._target),r=gA.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(Ze(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const l=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=jr(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,l,1/0,e),this._needsUpdate=!0}if(Ze(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const l=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=jr(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,l,1/0,e),this._needsUpdate=!0}if(Ze(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const l=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=jr(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,l,this.maxSpeed,e),this._needsUpdate=!0}if(Ze(s.x)&&Ze(s.y)&&Ze(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const l=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;dA(this._target,this._targetEnd,this._targetVelocity,l,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Ze(r.x)&&Ze(r.y)&&Ze(r.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const l=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;dA(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,l,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Ze(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const l=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=jr(this._zoom,this._zoomEnd,this._zoomVelocity,l,1/0,e)}if(this.dollyToCursor){if(Ln(this._camera)&&this._changedDolly!==0){const l=this._spherical.radius-this._lastDistance,A=this._camera,u=this._getCameraDirection(nr),f=Se.copy(u).cross(A.up).normalize();f.lengthSq()===0&&(f.x=1);const p=Pe.crossVectors(f,u),m=this._sphericalEnd.radius*Math.tan(A.getEffectiveFOV()*er*.5),v=(this._sphericalEnd.radius-l-this._sphericalEnd.radius)/this._sphericalEnd.radius,C=ds.copy(this._targetEnd).add(f.multiplyScalar(this._dollyControlCoord.x*m*A.aspect)).add(p.multiplyScalar(this._dollyControlCoord.y*m)),E=Se.copy(this._targetEnd).lerp(C,v),_=this._lastDollyDirection===hs.IN&&this._spherical.radius<=this.minDistance,B=this._lastDollyDirection===hs.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(_||B)){this._sphericalEnd.radius-=l,this._spherical.radius-=l;const x=Pe.copy(u).multiplyScalar(-l);E.add(x)}this._boundary.clampPoint(E,E);const y=Pe.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(y),this._changedDolly-=l,Ze(this._changedDolly)&&(this._changedDolly=0)}else if(vn(this._camera)&&this._changedZoom!==0){const l=this._zoom-this._lastZoom,A=this._camera,u=Se.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(A.near+A.far)/(A.near-A.far)).unproject(A),f=Pe.set(0,0,-1).applyQuaternion(A.quaternion),p=ds.copy(u).add(f.multiplyScalar(-u.dot(A.up))),g=-(this._zoom-l-this._zoom)/this._zoom,v=this._getCameraDirection(nr),C=this._targetEnd.dot(v),E=Se.copy(this._targetEnd).lerp(p,g),_=E.dot(v),B=v.multiplyScalar(_-C);E.sub(B),this._boundary.clampPoint(E,E);const y=Pe.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(y),this._changedZoom-=l,Ze(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Ze(this._focalOffset.x)||!Ze(this._focalOffset.y)||!Ze(this._focalOffset.z))&&(Pi.setFromMatrixColumn(this._camera.matrix,0),Gi.setFromMatrixColumn(this._camera.matrix,1),Pn.setFromMatrixColumn(this._camera.matrix,2),Pi.multiplyScalar(this._focalOffset.x),Gi.multiplyScalar(-this._focalOffset.y),Pn.multiplyScalar(this._focalOffset.z),Se.copy(Pi).add(Gi).add(Pn),this._camera.position.add(Se),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Se.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const d=this._needsUpdate;return d&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):d?(this.dispatchEvent({type:"update"}),Ze(t,this.restThreshold)&&Ze(i,this.restThreshold)&&Ze(n,this.restThreshold)&&Ze(s.x,this.restThreshold)&&Ze(s.y,this.restThreshold)&&Ze(s.z,this.restThreshold)&&Ze(r.x,this.restThreshold)&&Ze(r.y,this.restThreshold)&&Ze(r.z,this.restThreshold)&&Ze(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!d&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=d,this._needsUpdate=!1,d}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:tr(this.maxDistance),minZoom:this.minZoom,maxZoom:tr(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:tr(this.maxPolarAngle),minAzimuthAngle:tr(this.minAzimuthAngle),maxAzimuthAngle:tr(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:Se.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const i=JSON.parse(e);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=ir(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=ir(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=ir(i.maxPolarAngle),this.minAzimuthAngle=ir(i.minAzimuthAngle),this.maxAzimuthAngle=ir(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],t),ui.setFromVector3(Se.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(ui.theta,ui.phi,t),this.dollyTo(ui.radius,t),this.zoomTo(i.zoom,t),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",fC),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,i){const n=t.lengthSq();if(n===0)return e;const s=Pe.copy(t).add(e),a=this._boundary.clampPoint(s,ds).sub(s),c=a.lengthSq();if(c===0)return e.add(t);if(c===n)return e;if(i===0)return e.add(t).add(a);{const h=1+i*c/t.dot(a);return e.add(Pe.copy(t).multiplyScalar(h)).add(a.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(Ln(this._camera)){const e=this._camera,t=e.near,i=e.getEffectiveFOV()*er,n=Math.tan(i*.5)*t,s=n*e.aspect;this._nearPlaneCorners[0].set(-s,-n,0),this._nearPlaneCorners[1].set(s,-n,0),this._nearPlaneCorners[2].set(s,n,0),this._nearPlaneCorners[3].set(-s,n,0)}else if(vn(this._camera)){const e=this._camera,t=1/e.zoom,i=e.left*t,n=e.right*t,s=e.top*t,r=e.bottom*t;this._nearPlaneCorners[0].set(i,s,0),this._nearPlaneCorners[1].set(n,s,0),this._nearPlaneCorners[2].set(n,r,0),this._nearPlaneCorners[3].set(i,r,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Ca(this._camera,"_collisionTest"))return e;const i=this._getTargetDirection(nr);wa.lookAt(fA,i,this._camera.up);for(let n=0;n<4;n++){const s=Pe.copy(this._nearPlaneCorners[n]);s.applyMatrix4(wa);const r=ds.addVectors(this._target,s);eo.set(r,i),eo.far=this._spherical.radius+1;const a=eo.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const i=()=>{this.removeEventListener("rest",i),t()};this.addEventListener("rest",i)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new we.Sphere){const i=t,n=i.center;fs.makeEmpty(),e.traverseVisible(r=>{r.isMesh&&fs.expandByObject(r)}),fs.getCenter(n);let s=0;return e.traverseVisible(r=>{if(!r.isMesh)return;const a=r;if(!a.geometry)return;const c=a.geometry.clone();c.applyMatrix4(a.matrixWorld);const d=c.attributes.position;for(let l=0,A=d.count;l<A;l++)Se.fromBufferAttribute(d,l),s=Math.max(s,n.distanceToSquared(Se))}),i.radius=Math.sqrt(s),i}};class gC extends xt{constructor(t){super(t);N(this,"controls");_A.install({THREE:uo});const i=new _A(t.camera,t.renderer.domElement);this.controls=i}update(t){this.controls.update(this.base.clock.deltaTime)}}class CA extends xt{constructor(t,i={}){super(t);N(this,"width");N(this,"height");N(this,"rt");const{width:n,height:s,samples:r=0,depth:a=!1,options:c={}}=i;this.width=n,this.height=s;const h=new Bi(this.actualWidth,this.actualHeight,{minFilter:Pt,magFilter:Pt,type:Ot,...c});this.rt=h,a&&(h.depthTexture=new nh(this.actualWidth,this.actualHeight,Ti)),r&&(h.samples=r),this.base.resizer.on("resize",()=>{this.rt.setSize(this.actualWidth,this.actualHeight)})}get actualWidth(){return this.width||window.innerWidth*window.devicePixelRatio}get actualHeight(){return this.height||window.innerHeight*window.devicePixelRatio}}class mC extends xt{constructor(t,i={}){super(t);N(this,"fbo");N(this,"cubeCamera");N(this,"virtualScene");N(this,"ignoreObjects");const{resolution:n=256,near:s=1,far:r=1e3,scene:a=null,options:c={},textureType:h=Ot,ignoreObjects:d=[]}=i;this.ignoreObjects=d;const l=new Mf(n,c);l.texture.type=h,this.fbo=l;const A=new Sf(s,r,l);this.cubeCamera=A;const u=a||new fo;this.virtualScene=u}update(){this.ignoreObjects.forEach(t=>{t.visible=!1}),this.cubeCamera.update(this.base.renderer,this.virtualScene),this.ignoreObjects.forEach(t=>{t.visible=!0})}add(t){this.virtualScene.add(t)}get texture(){return this.fbo.texture}}function en(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function mu(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ni={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ss={duration:.5,overwrite:!1,delay:0},Ol,Tt,rt,vi=1e8,qe=1/vi,sl=Math.PI*2,vC=sl/4,_C=0,vu=Math.sqrt,CC=Math.cos,EC=Math.sin,wt=function(e){return typeof e=="string"},At=function(e){return typeof e=="function"},an=function(e){return typeof e=="number"},Ll=function(e){return typeof e>"u"},Ji=function(e){return typeof e=="object"},qt=function(e){return e!==!1},Pl=function(){return typeof window<"u"},to=function(e){return At(e)||wt(e)},_u=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Lt=Array.isArray,rl=/(?:-?\.?\d|\.)+/gi,Cu=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Es=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,xa=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Eu=/[+-]=-?[.\d]+/,Bu=/[^,'"\[\]\s]+/gi,BC=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,lt,Ui,ol,Gl,si={},vo={},yu,Iu=function(e){return(vo=Ts(e,si))&&Zt},Ul=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Ir=function(e,t){return!t&&console.warn(e)},wu=function(e,t){return e&&(si[e]=t)&&vo&&(vo[e]=t)||si},wr=function(){return 0},yC={suppressEvents:!0,isStart:!0,kill:!1},co={suppressEvents:!0,kill:!1},IC={suppressEvents:!0},kl={},Mn=[],al={},xu,ei={},Ma={},EA=30,Ao=[],Nl="",Hl=function(e){var t=e[0],i,n;if(Ji(t)||At(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=Ao.length;n--&&!Ao[n].targetTest(t););i=Ao[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new Wu(e[n],i)))||e.splice(n,1);return e},Xn=function(e){return e._gsap||Hl(_i(e))[0]._gsap},Mu=function(e,t,i){return(i=e[t])&&At(i)?e[t]():Ll(i)&&e.getAttribute&&e.getAttribute(t)||i},Xt=function(e,t){return(e=e.split(",")).forEach(t)||e},dt=function(e){return Math.round(e*1e5)/1e5||0},vt=function(e){return Math.round(e*1e7)/1e7||0},ws=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},wC=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},_o=function(){var e=Mn.length,t=Mn.slice(0),i,n;for(al={},Mn.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},zl=function(e){return!!(e._initted||e._startAt||e.add)},Su=function(e,t,i,n){Mn.length&&!Tt&&_o(),e.render(t,i,!!(Tt&&t<0&&zl(e))),Mn.length&&!Tt&&_o()},Tu=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Bu).length<2?t:wt(e)?e.trim():e},bu=function(e){return e},ri=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},xC=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},Ts=function(e,t){for(var i in t)e[i]=t[i];return e},BA=function o(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Ji(t[i])?o(e[i]||(e[i]={}),t[i]):t[i]);return e},Co=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},mr=function(e){var t=e.parent||lt,i=e.keyframes?xC(Lt(e.keyframes)):ri;if(qt(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},MC=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},Du=function(e,t,i,n,s){var r=e[n],a;if(s)for(a=t[s];r&&r[s]>a;)r=r._prev;return r?(t._next=r._next,r._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=r,t.parent=t._dp=e,t},Ro=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=t._prev,r=t._next;s?s._next=r:e[i]===t&&(e[i]=r),r?r._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},bn=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Wn=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},SC=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},ll=function(e,t,i,n){return e._startAt&&(Tt?e._startAt.revert(co):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},TC=function o(e){return!e||e._ts&&o(e.parent)},yA=function(e){return e._repeat?bs(e._tTime,e=e.duration()+e._rDelay)*e:0},bs=function(e,t){var i=Math.floor(e=vt(e/t));return e&&i===e?i-1:i},Eo=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Qo=function(e){return e._end=vt(e._start+(e._tDur/Math.abs(e._ts||e._rts||qe)||0))},Fo=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=vt(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Qo(e),i._dirty||Wn(i,e)),e},Ru=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=Eo(e.rawTime(),t),(!t._dur||Pr(0,t.totalDuration(),i)-t._tTime>qe)&&t.render(i,!0)),Wn(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-qe}},ki=function(e,t,i,n){return t.parent&&bn(t),t._start=vt((an(i)?i:i||e!==lt?di(e,i,t):e._time)+t._delay),t._end=vt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Du(e,t,"_first","_last",e._sort?"_start":0),cl(t)||(e._recent=t),n||Ru(e,t),e._ts<0&&Fo(e,e._tTime),e},Qu=function(e,t){return(si.ScrollTrigger||Ul("scrollTrigger",t))&&si.ScrollTrigger.create(t,e)},Fu=function(e,t,i,n,s){if(Vl(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!Tt&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&xu!==ti.frame)return Mn.push(e),e._lazy=[s,n],1},bC=function o(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||o(t))},cl=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},DC=function(e,t,i,n){var s=e.ratio,r=t<0||!t&&(!e._start&&bC(e)&&!(!e._initted&&cl(e))||(e._ts<0||e._dp._ts<0)&&!cl(e))?0:1,a=e._rDelay,c=0,h,d,l;if(a&&e._repeat&&(c=Pr(0,e._tDur,t),d=bs(c,a),e._yoyo&&d&1&&(r=1-r),d!==bs(e._tTime,a)&&(s=1-r,e.vars.repeatRefresh&&e._initted&&e.invalidate())),r!==s||Tt||n||e._zTime===qe||!t&&e._zTime){if(!e._initted&&Fu(e,t,n,i,c))return;for(l=e._zTime,e._zTime=t||(i?qe:0),i||(i=t&&!l),e.ratio=r,e._from&&(r=1-r),e._time=0,e._tTime=c,h=e._pt;h;)h.r(r,h.d),h=h._next;t<0&&ll(e,t,i,!0),e._onUpdate&&!i&&ii(e,"onUpdate"),c&&e._repeat&&!i&&e.parent&&ii(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===r&&(r&&bn(e,1),!i&&!Tt&&(ii(e,r?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},RC=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},Ds=function(e,t,i,n){var s=e._repeat,r=vt(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=r/e._dur),e._dur=r,e._tDur=s?s<0?1e10:vt(r*(s+1)+e._rDelay*s):r,a>0&&!n&&Fo(e,e._tTime=e._tDur*a),e.parent&&Qo(e),i||Wn(e.parent,e),e},IA=function(e){return e instanceof Ht?Wn(e):Ds(e,e._dur)},QC={_start:0,endTime:wr,totalDuration:wr},di=function o(e,t,i){var n=e.labels,s=e._recent||QC,r=e.duration()>=vi?s.endTime(!1):e._dur,a,c,h;return wt(t)&&(isNaN(t)||t in n)?(c=t.charAt(0),h=t.substr(-1)==="%",a=t.indexOf("="),c==="<"||c===">"?(a>=0&&(t=t.replace(/=/,"")),(c==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(a<0?s:i).totalDuration()/100:1)):a<0?(t in n||(n[t]=r),n[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),h&&i&&(c=c/100*(Lt(i)?i[0]:i).totalDuration()),a>1?o(e,t.substr(0,a-1),i)+c:r+c)):t==null?r:+t},vr=function(e,t,i){var n=an(t[1]),s=(n?2:1)+(e<2?0:1),r=t[s],a,c;if(n&&(r.duration=t[1]),r.parent=i,e){for(a=r,c=i;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=qt(c.vars.inherit)&&c.parent;r.immediateRender=qt(a.immediateRender),e<2?r.runBackwards=1:r.startAt=t[s-1]}return new mt(t[0],r,t[s+1])},Rn=function(e,t){return e||e===0?t(e):t},Pr=function(e,t,i){return i<e?e:i>t?t:i},Ft=function(e,t){return!wt(e)||!(t=BC.exec(e))?"":t[1]},FC=function(e,t,i){return Rn(i,function(n){return Pr(e,t,n)})},Al=[].slice,Ou=function(e,t){return e&&Ji(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Ji(e[0]))&&!e.nodeType&&e!==Ui},OC=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var s;return wt(n)&&!t||Ou(n,1)?(s=i).push.apply(s,_i(n)):i.push(n)})||i},_i=function(e,t,i){return rt&&!t&&rt.selector?rt.selector(e):wt(e)&&!i&&(ol||!Rs())?Al.call((t||Gl).querySelectorAll(e),0):Lt(e)?OC(e,i):Ou(e)?Al.call(e,0):e?[e]:[]},hl=function(e){return e=_i(e)[0]||Ir("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return _i(t,i.querySelectorAll?i:i===e?Ir("Invalid scope")||Gl.createElement("div"):e)}},Lu=function(e){return e.sort(function(){return .5-Math.random()})},Pu=function(e){if(At(e))return e;var t=Ji(e)?e:{each:e},i=jn(t.ease),n=t.from||0,s=parseFloat(t.base)||0,r={},a=n>0&&n<1,c=isNaN(n)||a,h=t.axis,d=n,l=n;return wt(n)?d=l={center:.5,edges:.5,end:1}[n]||0:!a&&c&&(d=n[0],l=n[1]),function(A,u,f){var p=(f||t).length,m=r[p],g,v,C,E,_,B,y,x,w;if(!m){if(w=t.grid==="auto"?0:(t.grid||[1,vi])[1],!w){for(y=-vi;y<(y=f[w++].getBoundingClientRect().left)&&w<p;);w<p&&w--}for(m=r[p]=[],g=c?Math.min(w,p)*d-.5:n%w,v=w===vi?0:c?p*l/w-.5:n/w|0,y=0,x=vi,B=0;B<p;B++)C=B%w-g,E=v-(B/w|0),m[B]=_=h?Math.abs(h==="y"?E:C):vu(C*C+E*E),_>y&&(y=_),_<x&&(x=_);n==="random"&&Lu(m),m.max=y-x,m.min=x,m.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(w>p?p-1:h?h==="y"?p/w:w:Math.max(w,p/w))||0)*(n==="edges"?-1:1),m.b=p<0?s-p:s,m.u=Ft(t.amount||t.each)||0,i=i&&p<0?Yu(i):i}return p=(m[A]-m.min)/m.max||0,vt(m.b+(i?i(p):p)*m.v)+m.u}},ul=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=vt(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(an(i)?0:Ft(i))}},Gu=function(e,t){var i=Lt(e),n,s;return!i&&Ji(e)&&(n=i=e.radius||vi,e.values?(e=_i(e.values),(s=!an(e[0]))&&(n*=n)):e=ul(e.increment)),Rn(t,i?At(e)?function(r){return s=e(r),Math.abs(s-r)<=n?s:r}:function(r){for(var a=parseFloat(s?r.x:r),c=parseFloat(s?r.y:0),h=vi,d=0,l=e.length,A,u;l--;)s?(A=e[l].x-a,u=e[l].y-c,A=A*A+u*u):A=Math.abs(e[l]-a),A<h&&(h=A,d=l);return d=!n||h<=n?e[d]:r,s||d===r||an(r)?d:d+Ft(r)}:ul(e))},Uu=function(e,t,i,n){return Rn(Lt(e)?!t:i===!0?!!(i=0):!n,function(){return Lt(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},LC=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(s,r){return r(s)},n)}},PC=function(e,t){return function(i){return e(parseFloat(i))+(t||Ft(i))}},GC=function(e,t,i){return Nu(e,t,0,1,i)},ku=function(e,t,i){return Rn(i,function(n){return e[~~t(n)]})},UC=function o(e,t,i){var n=t-e;return Lt(e)?ku(e,o(0,e.length),t):Rn(i,function(s){return(n+(s-e)%n)%n+e})},kC=function o(e,t,i){var n=t-e,s=n*2;return Lt(e)?ku(e,o(0,e.length-1),t):Rn(i,function(r){return r=(s+(r-e)%s)%s||0,e+(r>n?s-r:r)})},xr=function(e){for(var t=0,i="",n,s,r,a;~(n=e.indexOf("random(",t));)r=e.indexOf(")",n),a=e.charAt(n+7)==="[",s=e.substr(n+7,r-n-7).match(a?Bu:rl),i+=e.substr(t,n-t)+Uu(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=r+1;return i+e.substr(t,e.length-t)},Nu=function(e,t,i,n,s){var r=t-e,a=n-i;return Rn(s,function(c){return i+((c-e)/r*a||0)})},NC=function o(e,t,i,n){var s=isNaN(e+t)?0:function(u){return(1-u)*e+u*t};if(!s){var r=wt(e),a={},c,h,d,l,A;if(i===!0&&(n=1)&&(i=null),r)e={p:e},t={p:t};else if(Lt(e)&&!Lt(t)){for(d=[],l=e.length,A=l-2,h=1;h<l;h++)d.push(o(e[h-1],e[h]));l--,s=function(f){f*=l;var p=Math.min(A,~~f);return d[p](f-p)},i=t}else n||(e=Ts(Lt(e)?[]:{},e));if(!d){for(c in t)Jl.call(a,e,c,"get",t[c]);s=function(f){return ql(f,a)||(r?e.p:e)}}}return Rn(i,s)},wA=function(e,t,i){var n=e.labels,s=vi,r,a,c;for(r in n)a=n[r]-t,a<0==!!i&&a&&s>(a=Math.abs(a))&&(c=r,s=a);return c},ii=function(e,t,i){var n=e.vars,s=n[t],r=rt,a=e._ctx,c,h,d;if(s)return c=n[t+"Params"],h=n.callbackScope||e,i&&Mn.length&&_o(),a&&(rt=a),d=c?s.apply(h,c):s.call(h),rt=r,d},cr=function(e){return bn(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Tt),e.progress()<1&&ii(e,"onInterrupt"),e},Bs,Hu=[],zu=function(e){if(e)if(e=!e.name&&e.default||e,Pl()||e.headless){var t=e.name,i=At(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:wr,render:ql,add:Jl,kill:nE,modifier:iE,rawVars:0},r={targetTest:0,get:0,getSetter:Yl,aliases:{},register:0};if(Rs(),e!==n){if(ei[t])return;ri(n,ri(Co(e,s),r)),Ts(n.prototype,Ts(s,Co(e,r))),ei[n.prop=t]=n,e.targetTest&&(Ao.push(n),kl[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}wu(t,n),e.register&&e.register(Zt,n,Wt)}else Hu.push(e)},Ye=255,Ar={aqua:[0,Ye,Ye],lime:[0,Ye,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ye],navy:[0,0,128],white:[Ye,Ye,Ye],olive:[128,128,0],yellow:[Ye,Ye,0],orange:[Ye,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ye,0,0],pink:[Ye,192,203],cyan:[0,Ye,Ye],transparent:[Ye,Ye,Ye,0]},Sa=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*Ye+.5|0},Ju=function(e,t,i){var n=e?an(e)?[e>>16,e>>8&Ye,e&Ye]:0:Ar.black,s,r,a,c,h,d,l,A,u,f;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Ar[e])n=Ar[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),r=e.charAt(2),a=e.charAt(3),e="#"+s+s+r+r+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&Ye,n&Ye,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&Ye,e&Ye]}else if(e.substr(0,3)==="hsl"){if(n=f=e.match(rl),!t)c=+n[0]%360/360,h=+n[1]/100,d=+n[2]/100,r=d<=.5?d*(h+1):d+h-d*h,s=d*2-r,n.length>3&&(n[3]*=1),n[0]=Sa(c+1/3,s,r),n[1]=Sa(c,s,r),n[2]=Sa(c-1/3,s,r);else if(~e.indexOf("="))return n=e.match(Cu),i&&n.length<4&&(n[3]=1),n}else n=e.match(rl)||Ar.transparent;n=n.map(Number)}return t&&!f&&(s=n[0]/Ye,r=n[1]/Ye,a=n[2]/Ye,l=Math.max(s,r,a),A=Math.min(s,r,a),d=(l+A)/2,l===A?c=h=0:(u=l-A,h=d>.5?u/(2-l-A):u/(l+A),c=l===s?(r-a)/u+(r<a?6:0):l===r?(a-s)/u+2:(s-r)/u+4,c*=60),n[0]=~~(c+.5),n[1]=~~(h*100+.5),n[2]=~~(d*100+.5)),i&&n.length<4&&(n[3]=1),n},Vu=function(e){var t=[],i=[],n=-1;return e.split(Sn).forEach(function(s){var r=s.match(Es)||[];t.push.apply(t,r),i.push(n+=r.length+1)}),t.c=i,t},xA=function(e,t,i){var n="",s=(e+n).match(Sn),r=t?"hsla(":"rgba(",a=0,c,h,d,l;if(!s)return e;if(s=s.map(function(A){return(A=Ju(A,t,1))&&r+(t?A[0]+","+A[1]+"%,"+A[2]+"%,"+A[3]:A.join(","))+")"}),i&&(d=Vu(e),c=i.c,c.join(n)!==d.c.join(n)))for(h=e.replace(Sn,"1").split(Es),l=h.length-1;a<l;a++)n+=h[a]+(~c.indexOf(a)?s.shift()||r+"0,0,0,0)":(d.length?d:s.length?s:i).shift());if(!h)for(h=e.split(Sn),l=h.length-1;a<l;a++)n+=h[a]+s[a];return n+h[l]},Sn=function(){var o="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Ar)o+="|"+e+"\\b";return new RegExp(o+")","gi")}(),HC=/hsl[a]?\(/,Ku=function(e){var t=e.join(" "),i;if(Sn.lastIndex=0,Sn.test(t))return i=HC.test(t),e[1]=xA(e[1],i),e[0]=xA(e[0],i,Vu(e[1])),!0},Mr,ti=function(){var o=Date.now,e=500,t=33,i=o(),n=i,s=1e3/240,r=s,a=[],c,h,d,l,A,u,f=function p(m){var g=o()-n,v=m===!0,C,E,_,B;if((g>e||g<0)&&(i+=g-t),n+=g,_=n-i,C=_-r,(C>0||v)&&(B=++l.frame,A=_-l.time*1e3,l.time=_=_/1e3,r+=C+(C>=s?4:s-C),E=1),v||(c=h(p)),E)for(u=0;u<a.length;u++)a[u](_,A,B,m)};return l={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(m){return A/(1e3/(m||60))},wake:function(){yu&&(!ol&&Pl()&&(Ui=ol=window,Gl=Ui.document||{},si.gsap=Zt,(Ui.gsapVersions||(Ui.gsapVersions=[])).push(Zt.version),Iu(vo||Ui.GreenSockGlobals||!Ui.gsap&&Ui||{}),Hu.forEach(zu)),d=typeof requestAnimationFrame<"u"&&requestAnimationFrame,c&&l.sleep(),h=d||function(m){return setTimeout(m,r-l.time*1e3+1|0)},Mr=1,f(2))},sleep:function(){(d?cancelAnimationFrame:clearTimeout)(c),Mr=0,h=wr},lagSmoothing:function(m,g){e=m||1/0,t=Math.min(g||33,e)},fps:function(m){s=1e3/(m||240),r=l.time*1e3+s},add:function(m,g,v){var C=g?function(E,_,B,y){m(E,_,B,y),l.remove(C)}:m;return l.remove(m),a[v?"unshift":"push"](C),Rs(),C},remove:function(m,g){~(g=a.indexOf(m))&&a.splice(g,1)&&u>=g&&u--},_listeners:a},l}(),Rs=function(){return!Mr&&ti.wake()},Le={},zC=/^[\d.\-M][\d.\-,\s]/,JC=/["']/g,VC=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],s=1,r=i.length,a,c,h;s<r;s++)c=i[s],a=s!==r-1?c.lastIndexOf(","):c.length,h=c.substr(0,a),t[n]=isNaN(h)?h.replace(JC,"").trim():+h,n=c.substr(a+1).trim();return t},KC=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},YC=function(e){var t=(e+"").split("("),i=Le[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[VC(t[1])]:KC(e).split(",").map(Tu)):Le._CE&&zC.test(e)?Le._CE("",e):i},Yu=function(e){return function(t){return 1-e(1-t)}},qu=function o(e,t){for(var i=e._first,n;i;)i instanceof Ht?o(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?o(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},jn=function(e,t){return e&&(At(e)?e:Le[e]||YC(e))||t},ss=function(e,t,i,n){i===void 0&&(i=function(c){return 1-t(1-c)}),n===void 0&&(n=function(c){return c<.5?t(c*2)/2:1-t((1-c)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:n},r;return Xt(e,function(a){Le[a]=si[a]=s,Le[r=a.toLowerCase()]=i;for(var c in s)Le[r+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=Le[a+"."+c]=s[c]}),s},Xu=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Ta=function o(e,t,i){var n=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),r=s/sl*(Math.asin(1/n)||0),a=function(d){return d===1?1:n*Math.pow(2,-10*d)*EC((d-r)*s)+1},c=e==="out"?a:e==="in"?function(h){return 1-a(1-h)}:Xu(a);return s=sl/s,c.config=function(h,d){return o(e,h,d)},c},ba=function o(e,t){t===void 0&&(t=1.70158);var i=function(r){return r?--r*r*((t+1)*r+t)+1:0},n=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:Xu(i);return n.config=function(s){return o(e,s)},n};Xt("Linear,Quad,Cubic,Quart,Quint,Strong",function(o,e){var t=e<5?e+1:e;ss(o+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});Le.Linear.easeNone=Le.none=Le.Linear.easeIn;ss("Elastic",Ta("in"),Ta("out"),Ta());(function(o,e){var t=1/e,i=2*t,n=2.5*t,s=function(a){return a<t?o*a*a:a<i?o*Math.pow(a-1.5/e,2)+.75:a<n?o*(a-=2.25/e)*a+.9375:o*Math.pow(a-2.625/e,2)+.984375};ss("Bounce",function(r){return 1-s(1-r)},s)})(7.5625,2.75);ss("Expo",function(o){return Math.pow(2,10*(o-1))*o+o*o*o*o*o*o*(1-o)});ss("Circ",function(o){return-(vu(1-o*o)-1)});ss("Sine",function(o){return o===1?1:-CC(o*vC)+1});ss("Back",ba("in"),ba("out"),ba());Le.SteppedEase=Le.steps=si.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,r=1-qe;return function(a){return((n*Pr(0,r,a)|0)+s)*i}}};Ss.ease=Le["quad.out"];Xt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(o){return Nl+=o+","+o+"Params,"});var Wu=function(e,t){this.id=_C++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Mu,this.set=t?t.getSetter:Yl},Sr=function(){function o(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ds(this,+t.duration,1,1),this.data=t.data,rt&&(this._ctx=rt,rt.data.push(this)),Mr||ti.wake()}var e=o.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Ds(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(Rs(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Fo(this,i),!s._dp||s.parent||Ru(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&ki(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===qe||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Su(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+yA(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+yA(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,n){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,n):this._repeat?bs(this._tTime,s)+1:1},e.timeScale=function(i,n){if(!arguments.length)return this._rts===-qe?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?Eo(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-qe?0:this._rts,this.totalTime(Pr(-Math.abs(this._delay),this.totalDuration(),s),n!==!1),Qo(this),SC(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Rs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==qe&&(this._tTime-=qe)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&ki(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(qt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Eo(n.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=IC);var n=Tt;return Tt=i,zl(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),Tt=n,this},e.globalTime=function(i){for(var n=this,s=arguments.length?i:n.rawTime();n;)s=n._start+s/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,IA(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,IA(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(di(this,i),qt(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,qt(n)),this._dur||(this._zTime=-qe),this},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-qe:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-qe,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=n&&s<this.endTime(!0)-qe)},e.eventCallback=function(i,n,s){var r=this.vars;return arguments.length>1?(n?(r[i]=n,s&&(r[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=n)):delete r[i],this):r[i]},e.then=function(i){var n=this;return new Promise(function(s){var r=At(i)?i:bu,a=function(){var h=n.then;n.then=null,At(r)&&(r=r(n))&&(r.then||r===n)&&(n.then=h),s(r),n.then=h};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?a():n._prom=a})},e.kill=function(){cr(this)},o}();ri(Sr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-qe,_prom:0,_ps:!1,_rts:1});var Ht=function(o){mu(e,o);function e(i,n){var s;return i===void 0&&(i={}),s=o.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=qt(i.sortChildren),lt&&ki(i.parent||lt,en(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&Qu(en(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(n,s,r){return vr(0,arguments,this),this},t.from=function(n,s,r){return vr(1,arguments,this),this},t.fromTo=function(n,s,r,a){return vr(2,arguments,this),this},t.set=function(n,s,r){return s.duration=0,s.parent=this,mr(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new mt(n,s,di(this,r),1),this},t.call=function(n,s,r){return ki(this,mt.delayedCall(0,n,s),r)},t.staggerTo=function(n,s,r,a,c,h,d){return r.duration=s,r.stagger=r.stagger||a,r.onComplete=h,r.onCompleteParams=d,r.parent=this,new mt(n,r,di(this,c)),this},t.staggerFrom=function(n,s,r,a,c,h,d){return r.runBackwards=1,mr(r).immediateRender=qt(r.immediateRender),this.staggerTo(n,s,r,a,c,h,d)},t.staggerFromTo=function(n,s,r,a,c,h,d,l){return a.startAt=r,mr(a).immediateRender=qt(a.immediateRender),this.staggerTo(n,s,a,c,h,d,l)},t.render=function(n,s,r){var a=this._time,c=this._dirty?this.totalDuration():this._tDur,h=this._dur,d=n<=0?0:vt(n),l=this._zTime<0!=n<0&&(this._initted||!h),A,u,f,p,m,g,v,C,E,_,B,y;if(this!==lt&&d>c&&n>=0&&(d=c),d!==this._tTime||r||l){if(a!==this._time&&h&&(d+=this._time-a,n+=this._time-a),A=d,E=this._start,C=this._ts,g=!C,l&&(h||(a=this._zTime),(n||!s)&&(this._zTime=n)),this._repeat){if(B=this._yoyo,m=h+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(m*100+n,s,r);if(A=vt(d%m),d===c?(p=this._repeat,A=h):(_=vt(d/m),p=~~_,p&&p===_&&(A=h,p--),A>h&&(A=h)),_=bs(this._tTime,m),!a&&this._tTime&&_!==p&&this._tTime-_*m-this._dur<=0&&(_=p),B&&p&1&&(A=h-A,y=1),p!==_&&!this._lock){var x=B&&_&1,w=x===(B&&p&1);if(p<_&&(x=!x),a=x?0:d%h?h:d,this._lock=1,this.render(a||(y?0:vt(p*m)),s,!h)._lock=0,this._tTime=d,!s&&this.parent&&ii(this,"onRepeat"),this.vars.repeatRefresh&&!y&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,c=this._tDur,w&&(this._lock=2,a=x?h:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!y&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;qu(this,y)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=RC(this,vt(a),vt(A)),v&&(d-=A-(A=v._start))),this._tTime=d,this._time=A,this._act=!C,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,a=0),!a&&d&&!s&&!_&&(ii(this,"onStart"),this._tTime!==d))return this;if(A>=a&&n>=0)for(u=this._first;u;){if(f=u._next,(u._act||A>=u._start)&&u._ts&&v!==u){if(u.parent!==this)return this.render(n,s,r);if(u.render(u._ts>0?(A-u._start)*u._ts:(u._dirty?u.totalDuration():u._tDur)+(A-u._start)*u._ts,s,r),A!==this._time||!this._ts&&!g){v=0,f&&(d+=this._zTime=-qe);break}}u=f}else{u=this._last;for(var b=n<0?n:A;u;){if(f=u._prev,(u._act||b<=u._end)&&u._ts&&v!==u){if(u.parent!==this)return this.render(n,s,r);if(u.render(u._ts>0?(b-u._start)*u._ts:(u._dirty?u.totalDuration():u._tDur)+(b-u._start)*u._ts,s,r||Tt&&zl(u)),A!==this._time||!this._ts&&!g){v=0,f&&(d+=this._zTime=b?-qe:qe);break}}u=f}}if(v&&!s&&(this.pause(),v.render(A>=a?0:-qe)._zTime=A>=a?1:-1,this._ts))return this._start=E,Qo(this),this.render(n,s,r);this._onUpdate&&!s&&ii(this,"onUpdate",!0),(d===c&&this._tTime>=this.totalDuration()||!d&&a)&&(E===this._start||Math.abs(C)!==Math.abs(this._ts))&&(this._lock||((n||!h)&&(d===c&&this._ts>0||!d&&this._ts<0)&&bn(this,1),!s&&!(n<0&&!a)&&(d||a||!c)&&(ii(this,d===c&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(d<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,s){var r=this;if(an(s)||(s=di(this,s,n)),!(n instanceof Sr)){if(Lt(n))return n.forEach(function(a){return r.add(a,s)}),this;if(wt(n))return this.addLabel(n,s);if(At(n))n=mt.delayedCall(0,n);else return this}return this!==n?ki(this,n,s):this},t.getChildren=function(n,s,r,a){n===void 0&&(n=!0),s===void 0&&(s=!0),r===void 0&&(r=!0),a===void 0&&(a=-vi);for(var c=[],h=this._first;h;)h._start>=a&&(h instanceof mt?s&&c.push(h):(r&&c.push(h),n&&c.push.apply(c,h.getChildren(!0,s,r)))),h=h._next;return c},t.getById=function(n){for(var s=this.getChildren(1,1,1),r=s.length;r--;)if(s[r].vars.id===n)return s[r]},t.remove=function(n){return wt(n)?this.removeLabel(n):At(n)?this.killTweensOf(n):(n.parent===this&&Ro(this,n),n===this._recent&&(this._recent=this._last),Wn(this))},t.totalTime=function(n,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=vt(ti.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),o.prototype.totalTime.call(this,n,s),this._forcing=0,this):this._tTime},t.addLabel=function(n,s){return this.labels[n]=di(this,s),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,s,r){var a=mt.delayedCall(0,s||wr,r);return a.data="isPause",this._hasPause=1,ki(this,a,di(this,n))},t.removePause=function(n){var s=this._first;for(n=di(this,n);s;)s._start===n&&s.data==="isPause"&&bn(s),s=s._next},t.killTweensOf=function(n,s,r){for(var a=this.getTweensOf(n,r),c=a.length;c--;)yn!==a[c]&&a[c].kill(n,s);return this},t.getTweensOf=function(n,s){for(var r=[],a=_i(n),c=this._first,h=an(s),d;c;)c instanceof mt?wC(c._targets,a)&&(h?(!yn||c._initted&&c._ts)&&c.globalTime(0)<=s&&c.globalTime(c.totalDuration())>s:!s||c.isActive())&&r.push(c):(d=c.getTweensOf(a,s)).length&&r.push.apply(r,d),c=c._next;return r},t.tweenTo=function(n,s){s=s||{};var r=this,a=di(r,n),c=s,h=c.startAt,d=c.onStart,l=c.onStartParams,A=c.immediateRender,u,f=mt.to(r,ri({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(h&&"time"in h?h.time:r._time))/r.timeScale())||qe,onStart:function(){if(r.pause(),!u){var m=s.duration||Math.abs((a-(h&&"time"in h?h.time:r._time))/r.timeScale());f._dur!==m&&Ds(f,m,0,1).render(f._time,!0,!0),u=1}d&&d.apply(f,l||[])}},s));return A?f.render(0):f},t.tweenFromTo=function(n,s,r){return this.tweenTo(s,ri({startAt:{time:di(this,n)}},r))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),wA(this,di(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),wA(this,di(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+qe)},t.shiftChildren=function(n,s,r){r===void 0&&(r=0);for(var a=this._first,c=this.labels,h;a;)a._start>=r&&(a._start+=n,a._end+=n),a=a._next;if(s)for(h in c)c[h]>=r&&(c[h]+=n);return Wn(this)},t.invalidate=function(n){var s=this._first;for(this._lock=0;s;)s.invalidate(n),s=s._next;return o.prototype.invalidate.call(this,n)},t.clear=function(n){n===void 0&&(n=!0);for(var s=this._first,r;s;)r=s._next,this.remove(s),s=r;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),Wn(this)},t.totalDuration=function(n){var s=0,r=this,a=r._last,c=vi,h,d,l;if(arguments.length)return r.timeScale((r._repeat<0?r.duration():r.totalDuration())/(r.reversed()?-n:n));if(r._dirty){for(l=r.parent;a;)h=a._prev,a._dirty&&a.totalDuration(),d=a._start,d>c&&r._sort&&a._ts&&!r._lock?(r._lock=1,ki(r,a,d-a._delay,1)._lock=0):c=d,d<0&&a._ts&&(s-=d,(!l&&!r._dp||l&&l.smoothChildTiming)&&(r._start+=d/r._ts,r._time-=d,r._tTime-=d),r.shiftChildren(-d,!1,-1/0),c=0),a._end>s&&a._ts&&(s=a._end),a=h;Ds(r,r===lt&&r._time>s?r._time:s,1,1),r._dirty=0}return r._tDur},e.updateRoot=function(n){if(lt._ts&&(Su(lt,Eo(n,lt)),xu=ti.frame),ti.frame>=EA){EA+=ni.autoSleep||120;var s=lt._first;if((!s||!s._ts)&&ni.autoSleep&&ti._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||ti.sleep()}}},e}(Sr);ri(Ht.prototype,{_lock:0,_hasPause:0,_forcing:0});var qC=function(e,t,i,n,s,r,a){var c=new Wt(this._pt,e,t,0,1,id,null,s),h=0,d=0,l,A,u,f,p,m,g,v;for(c.b=i,c.e=n,i+="",n+="",(g=~n.indexOf("random("))&&(n=xr(n)),r&&(v=[i,n],r(v,e,t),i=v[0],n=v[1]),A=i.match(xa)||[];l=xa.exec(n);)f=l[0],p=n.substring(h,l.index),u?u=(u+1)%5:p.substr(-5)==="rgba("&&(u=1),f!==A[d++]&&(m=parseFloat(A[d-1])||0,c._pt={_next:c._pt,p:p||d===1?p:",",s:m,c:f.charAt(1)==="="?ws(m,f)-m:parseFloat(f)-m,m:u&&u<4?Math.round:0},h=xa.lastIndex);return c.c=h<n.length?n.substring(h,n.length):"",c.fp=a,(Eu.test(n)||g)&&(c.e=0),this._pt=c,c},Jl=function(e,t,i,n,s,r,a,c,h,d){At(n)&&(n=n(s||0,e,r));var l=e[t],A=i!=="get"?i:At(l)?h?e[t.indexOf("set")||!At(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():l,u=At(l)?h?$C:ed:Kl,f;if(wt(n)&&(~n.indexOf("random(")&&(n=xr(n)),n.charAt(1)==="="&&(f=ws(A,n)+(Ft(A)||0),(f||f===0)&&(n=f))),!d||A!==n||dl)return!isNaN(A*n)&&n!==""?(f=new Wt(this._pt,e,t,+A||0,n-(A||0),typeof l=="boolean"?tE:td,0,u),h&&(f.fp=h),a&&f.modifier(a,this,e),this._pt=f):(!l&&!(t in e)&&Ul(t,n),qC.call(this,e,t,A,n,u,c||ni.stringFilter,h))},XC=function(e,t,i,n,s){if(At(e)&&(e=_r(e,s,t,i,n)),!Ji(e)||e.style&&e.nodeType||Lt(e)||_u(e))return wt(e)?_r(e,s,t,i,n):e;var r={},a;for(a in e)r[a]=_r(e[a],s,t,i,n);return r},ju=function(e,t,i,n,s,r){var a,c,h,d;if(ei[e]&&(a=new ei[e]).init(s,a.rawVars?t[e]:XC(t[e],n,s,r,i),i,n,r)!==!1&&(i._pt=c=new Wt(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Bs))for(h=i._ptLookup[i._targets.indexOf(s)],d=a._props.length;d--;)h[a._props[d]]=c;return a},yn,dl,Vl=function o(e,t,i){var n=e.vars,s=n.ease,r=n.startAt,a=n.immediateRender,c=n.lazy,h=n.onUpdate,d=n.runBackwards,l=n.yoyoEase,A=n.keyframes,u=n.autoRevert,f=e._dur,p=e._startAt,m=e._targets,g=e.parent,v=g&&g.data==="nested"?g.vars.targets:m,C=e._overwrite==="auto"&&!Ol,E=e.timeline,_,B,y,x,w,b,P,O,S,D,Q,k,te;if(E&&(!A||!s)&&(s="none"),e._ease=jn(s,Ss.ease),e._yEase=l?Yu(jn(l===!0?s:l,Ss.ease)):0,l&&e._yoyo&&!e._repeat&&(l=e._yEase,e._yEase=e._ease,e._ease=l),e._from=!E&&!!n.runBackwards,!E||A&&!n.stagger){if(O=m[0]?Xn(m[0]).harness:0,k=O&&n[O.prop],_=Co(n,kl),p&&(p._zTime<0&&p.progress(1),t<0&&d&&a&&!u?p.render(-1,!0):p.revert(d&&f?co:yC),p._lazy=0),r){if(bn(e._startAt=mt.set(m,ri({data:"isStart",overwrite:!1,parent:g,immediateRender:!0,lazy:!p&&qt(c),startAt:null,delay:0,onUpdate:h&&function(){return ii(e,"onUpdate")},stagger:0},r))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Tt||!a&&!u)&&e._startAt.revert(co),a&&f&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(d&&f&&!p){if(t&&(a=!1),y=ri({overwrite:!1,data:"isFromStart",lazy:a&&!p&&qt(c),immediateRender:a,stagger:0,parent:g},_),k&&(y[O.prop]=k),bn(e._startAt=mt.set(m,y)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Tt?e._startAt.revert(co):e._startAt.render(-1,!0)),e._zTime=t,!a)o(e._startAt,qe,qe);else if(!t)return}for(e._pt=e._ptCache=0,c=f&&qt(c)||c&&!f,B=0;B<m.length;B++){if(w=m[B],P=w._gsap||Hl(m)[B]._gsap,e._ptLookup[B]=D={},al[P.id]&&Mn.length&&_o(),Q=v===m?B:v.indexOf(w),O&&(S=new O).init(w,k||_,e,Q,v)!==!1&&(e._pt=x=new Wt(e._pt,w,S.name,0,1,S.render,S,0,S.priority),S._props.forEach(function(W){D[W]=x}),S.priority&&(b=1)),!O||k)for(y in _)ei[y]&&(S=ju(y,_,e,Q,w,v))?S.priority&&(b=1):D[y]=x=Jl.call(e,w,y,"get",_[y],Q,v,0,n.stringFilter);e._op&&e._op[B]&&e.kill(w,e._op[B]),C&&e._pt&&(yn=e,lt.killTweensOf(w,D,e.globalTime(t)),te=!e.parent,yn=0),e._pt&&c&&(al[P.id]=1)}b&&nd(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!te,A&&t<=0&&E.render(vi,!0,!0)},WC=function(e,t,i,n,s,r,a,c){var h=(e._pt&&e._ptCache||(e._ptCache={}))[t],d,l,A,u;if(!h)for(h=e._ptCache[t]=[],A=e._ptLookup,u=e._targets.length;u--;){if(d=A[u][t],d&&d.d&&d.d._pt)for(d=d.d._pt;d&&d.p!==t&&d.fp!==t;)d=d._next;if(!d)return dl=1,e.vars[t]="+=0",Vl(e,a),dl=0,c?Ir(t+" not eligible for reset"):1;h.push(d)}for(u=h.length;u--;)l=h[u],d=l._pt||l,d.s=(n||n===0)&&!s?n:d.s+(n||0)+r*d.c,d.c=i-d.s,l.e&&(l.e=dt(i)+Ft(l.e)),l.b&&(l.b=d.s+Ft(l.b))},jC=function(e,t){var i=e[0]?Xn(e[0]).harness:0,n=i&&i.aliases,s,r,a,c;if(!n)return t;s=Ts({},t);for(r in n)if(r in s)for(c=n[r].split(","),a=c.length;a--;)s[c[a]]=s[r];return s},ZC=function(e,t,i,n){var s=t.ease||n||"power1.inOut",r,a;if(Lt(t))a=i[e]||(i[e]=[]),t.forEach(function(c,h){return a.push({t:h/(t.length-1)*100,v:c,e:s})});else for(r in t)a=i[r]||(i[r]=[]),r==="ease"||a.push({t:parseFloat(e),v:t[r],e:s})},_r=function(e,t,i,n,s){return At(e)?e.call(t,i,n,s):wt(e)&&~e.indexOf("random(")?xr(e):e},Zu=Nl+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",$u={};Xt(Zu+",id,stagger,delay,duration,paused,scrollTrigger",function(o){return $u[o]=1});var mt=function(o){mu(e,o);function e(i,n,s,r){var a;typeof n=="number"&&(s.duration=n,n=s,s=null),a=o.call(this,r?n:mr(n))||this;var c=a.vars,h=c.duration,d=c.delay,l=c.immediateRender,A=c.stagger,u=c.overwrite,f=c.keyframes,p=c.defaults,m=c.scrollTrigger,g=c.yoyoEase,v=n.parent||lt,C=(Lt(i)||_u(i)?an(i[0]):"length"in n)?[i]:_i(i),E,_,B,y,x,w,b,P;if(a._targets=C.length?Hl(C):Ir("GSAP target "+i+" not found. https://gsap.com",!ni.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=u,f||A||to(h)||to(d)){if(n=a.vars,E=a.timeline=new Ht({data:"nested",defaults:p||{},targets:v&&v.data==="nested"?v.vars.targets:C}),E.kill(),E.parent=E._dp=en(a),E._start=0,A||to(h)||to(d)){if(y=C.length,b=A&&Pu(A),Ji(A))for(x in A)~Zu.indexOf(x)&&(P||(P={}),P[x]=A[x]);for(_=0;_<y;_++)B=Co(n,$u),B.stagger=0,g&&(B.yoyoEase=g),P&&Ts(B,P),w=C[_],B.duration=+_r(h,en(a),_,w,C),B.delay=(+_r(d,en(a),_,w,C)||0)-a._delay,!A&&y===1&&B.delay&&(a._delay=d=B.delay,a._start+=d,B.delay=0),E.to(w,B,b?b(_,w,C):0),E._ease=Le.none;E.duration()?h=d=0:a.timeline=0}else if(f){mr(ri(E.vars.defaults,{ease:"none"})),E._ease=jn(f.ease||n.ease||"none");var O=0,S,D,Q;if(Lt(f))f.forEach(function(k){return E.to(C,k,">")}),E.duration();else{B={};for(x in f)x==="ease"||x==="easeEach"||ZC(x,f[x],B,f.easeEach);for(x in B)for(S=B[x].sort(function(k,te){return k.t-te.t}),O=0,_=0;_<S.length;_++)D=S[_],Q={ease:D.e,duration:(D.t-(_?S[_-1].t:0))/100*h},Q[x]=D.v,E.to(C,Q,O),O+=Q.duration;E.duration()<h&&E.to({},{duration:h-E.duration()})}}h||a.duration(h=E.duration())}else a.timeline=0;return u===!0&&!Ol&&(yn=en(a),lt.killTweensOf(C),yn=0),ki(v,en(a),s),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(l||!h&&!f&&a._start===vt(v._time)&&qt(l)&&TC(en(a))&&v.data!=="nested")&&(a._tTime=-qe,a.render(Math.max(0,-d)||0)),m&&Qu(en(a),m),a}var t=e.prototype;return t.render=function(n,s,r){var a=this._time,c=this._tDur,h=this._dur,d=n<0,l=n>c-qe&&!d?c:n<qe?0:n,A,u,f,p,m,g,v,C,E;if(!h)DC(this,n,s,r);else if(l!==this._tTime||!n||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==d||this._lazy){if(A=l,C=this.timeline,this._repeat){if(p=h+this._rDelay,this._repeat<-1&&d)return this.totalTime(p*100+n,s,r);if(A=vt(l%p),l===c?(f=this._repeat,A=h):(m=vt(l/p),f=~~m,f&&f===m?(A=h,f--):A>h&&(A=h)),g=this._yoyo&&f&1,g&&(E=this._yEase,A=h-A),m=bs(this._tTime,p),A===a&&!r&&this._initted&&f===m)return this._tTime=l,this;f!==m&&(C&&this._yEase&&qu(C,g),this.vars.repeatRefresh&&!g&&!this._lock&&A!==p&&this._initted&&(this._lock=r=1,this.render(vt(p*f),!0).invalidate()._lock=0))}if(!this._initted){if(Fu(this,d?n:A,r,s,l))return this._tTime=0,this;if(a!==this._time&&!(r&&this.vars.repeatRefresh&&f!==m))return this;if(h!==this._dur)return this.render(n,s,r)}if(this._tTime=l,this._time=A,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(E||this._ease)(A/h),this._from&&(this.ratio=v=1-v),!a&&l&&!s&&!m&&(ii(this,"onStart"),this._tTime!==l))return this;for(u=this._pt;u;)u.r(v,u.d),u=u._next;C&&C.render(n<0?n:C._dur*C._ease(A/this._dur),s,r)||this._startAt&&(this._zTime=n),this._onUpdate&&!s&&(d&&ll(this,n,s,r),ii(this,"onUpdate")),this._repeat&&f!==m&&this.vars.onRepeat&&!s&&this.parent&&ii(this,"onRepeat"),(l===this._tDur||!l)&&this._tTime===l&&(d&&!this._onUpdate&&ll(this,n,!0,!0),(n||!h)&&(l===this._tDur&&this._ts>0||!l&&this._ts<0)&&bn(this,1),!s&&!(d&&!a)&&(l||a||g)&&(ii(this,l===c?"onComplete":"onReverseComplete",!0),this._prom&&!(l<c&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),o.prototype.invalidate.call(this,n)},t.resetTo=function(n,s,r,a,c){Mr||ti.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),d;return this._initted||Vl(this,h),d=this._ease(h/this._dur),WC(this,n,s,r,a,d,h,c)?this.resetTo(n,s,r,a,1):(Fo(this,0),this.parent||Du(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,s){if(s===void 0&&(s="all"),!n&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?cr(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Tt),this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(n,s,yn&&yn.vars.overwrite!==!0)._first||cr(this),this.parent&&r!==this.timeline.totalDuration()&&Ds(this,this._dur*this.timeline._tDur/r,0,1),this}var a=this._targets,c=n?_i(n):a,h=this._ptLookup,d=this._pt,l,A,u,f,p,m,g;if((!s||s==="all")&&MC(a,c))return s==="all"&&(this._pt=0),cr(this);for(l=this._op=this._op||[],s!=="all"&&(wt(s)&&(p={},Xt(s,function(v){return p[v]=1}),s=p),s=jC(a,s)),g=a.length;g--;)if(~c.indexOf(a[g])){A=h[g],s==="all"?(l[g]=s,f=A,u={}):(u=l[g]=l[g]||{},f=s);for(p in f)m=A&&A[p],m&&((!("kill"in m.d)||m.d.kill(p)===!0)&&Ro(this,m,"_pt"),delete A[p]),u!=="all"&&(u[p]=1)}return this._initted&&!this._pt&&d&&cr(this),this},e.to=function(n,s){return new e(n,s,arguments[2])},e.from=function(n,s){return vr(1,arguments)},e.delayedCall=function(n,s,r,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:s,onReverseComplete:s,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:a})},e.fromTo=function(n,s,r){return vr(2,arguments)},e.set=function(n,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(n,s)},e.killTweensOf=function(n,s,r){return lt.killTweensOf(n,s,r)},e}(Sr);ri(mt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Xt("staggerTo,staggerFrom,staggerFromTo",function(o){mt[o]=function(){var e=new Ht,t=Al.call(arguments,0);return t.splice(o==="staggerFromTo"?5:4,0,0),e[o].apply(e,t)}});var Kl=function(e,t,i){return e[t]=i},ed=function(e,t,i){return e[t](i)},$C=function(e,t,i,n){return e[t](n.fp,i)},eE=function(e,t,i){return e.setAttribute(t,i)},Yl=function(e,t){return At(e[t])?ed:Ll(e[t])&&e.setAttribute?eE:Kl},td=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},tE=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},id=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},ql=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},iE=function(e,t,i,n){for(var s=this._pt,r;s;)r=s._next,s.p===n&&s.modifier(e,t,i),s=r},nE=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?Ro(this,t,"_pt"):t.dep||(i=1),t=n;return!i},sE=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},nd=function(e){for(var t=e._pt,i,n,s,r;t;){for(i=t._next,n=s;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:r)?t._prev._next=t:s=t,(t._next=n)?n._prev=t:r=t,t=i}e._pt=s},Wt=function(){function o(t,i,n,s,r,a,c,h,d){this.t=i,this.s=s,this.c=r,this.p=n,this.r=a||td,this.d=c||this,this.set=h||Kl,this.pr=d||0,this._next=t,t&&(t._prev=this)}var e=o.prototype;return e.modifier=function(i,n,s){this.mSet=this.mSet||this.set,this.set=sE,this.m=i,this.mt=s,this.tween=n},o}();Xt(Nl+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(o){return kl[o]=1});si.TweenMax=si.TweenLite=mt;si.TimelineLite=si.TimelineMax=Ht;lt=new Ht({sortChildren:!1,defaults:Ss,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ni.stringFilter=Ku;var Zn=[],ho={},rE=[],MA=0,oE=0,Da=function(e){return(ho[e]||rE).map(function(t){return t()})},fl=function(){var e=Date.now(),t=[];e-MA>2&&(Da("matchMediaInit"),Zn.forEach(function(i){var n=i.queries,s=i.conditions,r,a,c,h;for(a in n)r=Ui.matchMedia(n[a]).matches,r&&(c=1),r!==s[a]&&(s[a]=r,h=1);h&&(i.revert(),c&&t.push(i))}),Da("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(n){return i.add(null,n)})}),MA=e,Da("matchMedia"))},sd=function(){function o(t,i){this.selector=i&&hl(i),this.data=[],this._r=[],this.isReverted=!1,this.id=oE++,t&&this.add(t)}var e=o.prototype;return e.add=function(i,n,s){At(i)&&(s=n,n=i,i=At);var r=this,a=function(){var h=rt,d=r.selector,l;return h&&h!==r&&h.data.push(r),s&&(r.selector=hl(s)),rt=r,l=n.apply(r,arguments),At(l)&&r._r.push(l),rt=h,r.selector=d,r.isReverted=!1,l};return r.last=a,i===At?a(r,function(c){return r.add(null,c)}):i?r[i]=a:a},e.ignore=function(i){var n=rt;rt=null,i(this),rt=n},e.getTweens=function(){var i=[];return this.data.forEach(function(n){return n instanceof o?i.push.apply(i,n.getTweens()):n instanceof mt&&!(n.parent&&n.parent.data==="nested")&&i.push(n)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,n){var s=this;if(i?function(){for(var a=s.getTweens(),c=s.data.length,h;c--;)h=s.data[c],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(d){return a.splice(a.indexOf(d),1)}));for(a.map(function(d){return{g:d._dur||d._delay||d._sat&&!d._sat.vars.immediateRender?d.globalTime(0):-1/0,t:d}}).sort(function(d,l){return l.g-d.g||-1/0}).forEach(function(d){return d.t.revert(i)}),c=s.data.length;c--;)h=s.data[c],h instanceof Ht?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof mt)&&h.revert&&h.revert(i);s._r.forEach(function(d){return d(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),n)for(var r=Zn.length;r--;)Zn[r].id===this.id&&Zn.splice(r,1)},e.revert=function(i){this.kill(i||{})},o}(),aE=function(){function o(t){this.contexts=[],this.scope=t,rt&&rt.data.push(this)}var e=o.prototype;return e.add=function(i,n,s){Ji(i)||(i={matches:i});var r=new sd(0,s||this.scope),a=r.conditions={},c,h,d;rt&&!r.selector&&(r.selector=rt.selector),this.contexts.push(r),n=r.add("onMatch",n),r.queries=i;for(h in i)h==="all"?d=1:(c=Ui.matchMedia(i[h]),c&&(Zn.indexOf(r)<0&&Zn.push(r),(a[h]=c.matches)&&(d=1),c.addListener?c.addListener(fl):c.addEventListener("change",fl)));return d&&n(r,function(l){return r.add(null,l)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(n){return n.kill(i,!0)})},o}(),Bo={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return zu(n)})},timeline:function(e){return new Ht(e)},getTweensOf:function(e,t){return lt.getTweensOf(e,t)},getProperty:function(e,t,i,n){wt(e)&&(e=_i(e)[0]);var s=Xn(e||{}).get,r=i?bu:Tu;return i==="native"&&(i=""),e&&(t?r((ei[t]&&ei[t].get||s)(e,t,i,n)):function(a,c,h){return r((ei[a]&&ei[a].get||s)(e,a,c,h))})},quickSetter:function(e,t,i){if(e=_i(e),e.length>1){var n=e.map(function(d){return Zt.quickSetter(d,t,i)}),s=n.length;return function(d){for(var l=s;l--;)n[l](d)}}e=e[0]||{};var r=ei[t],a=Xn(e),c=a.harness&&(a.harness.aliases||{})[t]||t,h=r?function(d){var l=new r;Bs._pt=0,l.init(e,i?d+i:d,Bs,0,[e]),l.render(1,l),Bs._pt&&ql(1,Bs)}:a.set(e,c);return r?h:function(d){return h(e,c,i?d+i:d,a,1)}},quickTo:function(e,t,i){var n,s=Zt.to(e,ri((n={},n[t]="+=0.1",n.paused=!0,n.stagger=0,n),i||{})),r=function(c,h,d){return s.resetTo(t,c,h,d)};return r.tween=s,r},isTweening:function(e){return lt.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=jn(e.ease,Ss.ease)),BA(Ss,e||{})},config:function(e){return BA(ni,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,r=e.extendTimeline;(n||"").split(",").forEach(function(a){return a&&!ei[a]&&!si[a]&&Ir(t+" effect requires "+a+" plugin.")}),Ma[t]=function(a,c,h){return i(_i(a),ri(c||{},s),h)},r&&(Ht.prototype[t]=function(a,c,h){return this.add(Ma[t](a,Ji(c)?c:(h=c)&&{},this),h)})},registerEase:function(e,t){Le[e]=jn(t)},parseEase:function(e,t){return arguments.length?jn(e,t):Le},getById:function(e){return lt.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Ht(e),n,s;for(i.smoothChildTiming=qt(e.smoothChildTiming),lt.remove(i),i._dp=0,i._time=i._tTime=lt._time,n=lt._first;n;)s=n._next,(t||!(!n._dur&&n instanceof mt&&n.vars.onComplete===n._targets[0]))&&ki(i,n,n._start-n._delay),n=s;return ki(lt,i,0),i},context:function(e,t){return e?new sd(e,t):rt},matchMedia:function(e){return new aE(e)},matchMediaRefresh:function(){return Zn.forEach(function(e){var t=e.conditions,i,n;for(n in t)t[n]&&(t[n]=!1,i=1);i&&e.revert()})||fl()},addEventListener:function(e,t){var i=ho[e]||(ho[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=ho[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:UC,wrapYoyo:kC,distribute:Pu,random:Uu,snap:Gu,normalize:GC,getUnit:Ft,clamp:FC,splitColor:Ju,toArray:_i,selector:hl,mapRange:Nu,pipe:LC,unitize:PC,interpolate:NC,shuffle:Lu},install:Iu,effects:Ma,ticker:ti,updateRoot:Ht.updateRoot,plugins:ei,globalTimeline:lt,core:{PropTween:Wt,globals:wu,Tween:mt,Timeline:Ht,Animation:Sr,getCache:Xn,_removeLinkedListItem:Ro,reverting:function(){return Tt},context:function(e){return e&&rt&&(rt.data.push(e),e._ctx=rt),rt},suppressOverwrites:function(e){return Ol=e}}};Xt("to,from,fromTo,delayedCall,set,killTweensOf",function(o){return Bo[o]=mt[o]});ti.add(Ht.updateRoot);Bs=Bo.to({},{duration:0});var lE=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},cE=function(e,t){var i=e._targets,n,s,r;for(n in t)for(s=i.length;s--;)r=e._ptLookup[s][n],r&&(r=r.d)&&(r._pt&&(r=lE(r,n)),r&&r.modifier&&r.modifier(t[n],e,i[s],n))},Ra=function(e,t){return{name:e,headless:1,rawVars:1,init:function(n,s,r){r._onInit=function(a){var c,h;if(wt(s)&&(c={},Xt(s,function(d){return c[d]=1}),s=c),t){c={};for(h in s)c[h]=t(s[h]);s=c}cE(a,s)}}}},Zt=Bo.registerPlugin({name:"attr",init:function(e,t,i,n,s){var r,a,c;this.tween=i;for(r in t)c=e.getAttribute(r)||"",a=this.add(e,"setAttribute",(c||0)+"",t[r],n,s,0,0,r),a.op=r,a.b=c,this._props.push(r)},render:function(e,t){for(var i=t._pt;i;)Tt?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Ra("roundProps",ul),Ra("modifiers"),Ra("snap",Gu))||Bo;mt.version=Ht.version=Zt.version="3.13.0";yu=1;Pl()&&Rs();Le.Power0;Le.Power1;Le.Power2;Le.Power3;Le.Power4;Le.Linear;Le.Quad;Le.Cubic;Le.Quart;Le.Quint;Le.Strong;Le.Elastic;Le.Back;Le.SteppedEase;Le.Bounce;Le.Sine;Le.Expo;Le.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var SA,In,xs,Xl,Kn,TA,Wl,AE=function(){return typeof window<"u"},ln={},Nn=180/Math.PI,Ms=Math.PI/180,ps=Math.atan2,bA=1e8,jl=/([A-Z])/g,hE=/(left|right|width|margin|padding|x)/i,uE=/[\s,\(]\S/,Ni={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},pl=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},dE=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},fE=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},pE=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},rd=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},od=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},gE=function(e,t,i){return e.style[t]=i},mE=function(e,t,i){return e.style.setProperty(t,i)},vE=function(e,t,i){return e._gsap[t]=i},_E=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},CE=function(e,t,i,n,s){var r=e._gsap;r.scaleX=r.scaleY=i,r.renderTransform(s,r)},EE=function(e,t,i,n,s){var r=e._gsap;r[t]=i,r.renderTransform(s,r)},ct="transform",jt=ct+"Origin",BE=function o(e,t){var i=this,n=this.target,s=n.style,r=n._gsap;if(e in ln&&s){if(this.tfm=this.tfm||{},e!=="transform")e=Ni[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=tn(n,a)}):this.tfm[e]=r.x?r[e]:tn(n,e),e===jt&&(this.tfm.zOrigin=r.zOrigin);else return Ni.transform.split(",").forEach(function(a){return o.call(i,a,t)});if(this.props.indexOf(ct)>=0)return;r.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(jt,t,"")),e=ct}(s||t)&&this.props.push(e,t,s[e])},ad=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},yE=function(){var e=this.props,t=this.target,i=t.style,n=t._gsap,s,r;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(jl,"-$1").toLowerCase());if(this.tfm){for(r in this.tfm)n[r]=this.tfm[r];n.svg&&(n.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=Wl(),(!s||!s.isStart)&&!i[ct]&&(ad(i),n.zOrigin&&i[jt]&&(i[jt]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},ld=function(e,t){var i={target:e,props:[],revert:yE,save:BE};return e._gsap||Zt.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(n){return i.save(n)}),i},cd,gl=function(e,t){var i=In.createElementNS?In.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):In.createElement(e);return i&&i.style?i:In.createElement(e)},Ci=function o(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(jl,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&o(e,Qs(t)||t,1)||""},DA="O,Moz,ms,Ms,Webkit".split(","),Qs=function(e,t,i){var n=t||Kn,s=n.style,r=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(DA[r]+e in s););return r<0?null:(r===3?"ms":r>=0?DA[r]:"")+e},ml=function(){AE()&&window.document&&(SA=window,In=SA.document,xs=In.documentElement,Kn=gl("div")||{style:{}},gl("div"),ct=Qs(ct),jt=ct+"Origin",Kn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",cd=!!Qs("perspective"),Wl=Zt.core.reverting,Xl=1)},RA=function(e){var t=e.ownerSVGElement,i=gl("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=e.cloneNode(!0),s;n.style.display="block",i.appendChild(n),xs.appendChild(i);try{s=n.getBBox()}catch{}return i.removeChild(n),xs.removeChild(i),s},QA=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Ad=function(e){var t,i;try{t=e.getBBox()}catch{t=RA(e),i=1}return t&&(t.width||t.height)||i||(t=RA(e)),t&&!t.width&&!t.x&&!t.y?{x:+QA(e,["x","cx","x1"])||0,y:+QA(e,["y","cy","y1"])||0,width:0,height:0}:t},hd=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Ad(e))},is=function(e,t){if(t){var i=e.style,n;t in ln&&t!==jt&&(t=ct),i.removeProperty?(n=t.substr(0,2),(n==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(n==="--"?t:t.replace(jl,"-$1").toLowerCase())):i.removeAttribute(t)}},wn=function(e,t,i,n,s,r){var a=new Wt(e._pt,t,i,0,1,r?od:rd);return e._pt=a,a.b=n,a.e=s,e._props.push(i),a},FA={deg:1,rad:1,turn:1},IE={grid:1,flex:1},Dn=function o(e,t,i,n){var s=parseFloat(i)||0,r=(i+"").trim().substr((s+"").length)||"px",a=Kn.style,c=hE.test(t),h=e.tagName.toLowerCase()==="svg",d=(h?"client":"offset")+(c?"Width":"Height"),l=100,A=n==="px",u=n==="%",f,p,m,g;if(n===r||!s||FA[n]||FA[r])return s;if(r!=="px"&&!A&&(s=o(e,t,i,"px")),g=e.getCTM&&hd(e),(u||r==="%")&&(ln[t]||~t.indexOf("adius")))return f=g?e.getBBox()[c?"width":"height"]:e[d],dt(u?s/f*l:s/100*f);if(a[c?"width":"height"]=l+(A?r:n),p=n!=="rem"&&~t.indexOf("adius")||n==="em"&&e.appendChild&&!h?e:e.parentNode,g&&(p=(e.ownerSVGElement||{}).parentNode),(!p||p===In||!p.appendChild)&&(p=In.body),m=p._gsap,m&&u&&m.width&&c&&m.time===ti.time&&!m.uncache)return dt(s/m.width*l);if(u&&(t==="height"||t==="width")){var v=e.style[t];e.style[t]=l+n,f=e[d],v?e.style[t]=v:is(e,t)}else(u||r==="%")&&!IE[Ci(p,"display")]&&(a.position=Ci(e,"position")),p===e&&(a.position="static"),p.appendChild(Kn),f=Kn[d],p.removeChild(Kn),a.position="absolute";return c&&u&&(m=Xn(p),m.time=ti.time,m.width=p[d]),dt(A?f*s/l:f&&s?l/f*s:0)},tn=function(e,t,i,n){var s;return Xl||ml(),t in Ni&&t!=="transform"&&(t=Ni[t],~t.indexOf(",")&&(t=t.split(",")[0])),ln[t]&&t!=="transform"?(s=br(e,n),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:Io(Ci(e,jt))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||n||~(s+"").indexOf("calc("))&&(s=yo[t]&&yo[t](e,t,i)||Ci(e,t)||Mu(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?Dn(e,t,s,i)+i:s},wE=function(e,t,i,n){if(!i||i==="none"){var s=Qs(t,e,1),r=s&&Ci(e,s,1);r&&r!==i?(t=s,i=r):t==="borderColor"&&(i=Ci(e,"borderTopColor"))}var a=new Wt(this._pt,e.style,t,0,1,id),c=0,h=0,d,l,A,u,f,p,m,g,v,C,E,_;if(a.b=i,a.e=n,i+="",n+="",n.substring(0,6)==="var(--"&&(n=Ci(e,n.substring(4,n.indexOf(")")))),n==="auto"&&(p=e.style[t],e.style[t]=n,n=Ci(e,t)||n,p?e.style[t]=p:is(e,t)),d=[i,n],Ku(d),i=d[0],n=d[1],A=i.match(Es)||[],_=n.match(Es)||[],_.length){for(;l=Es.exec(n);)m=l[0],v=n.substring(c,l.index),f?f=(f+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(f=1),m!==(p=A[h++]||"")&&(u=parseFloat(p)||0,E=p.substr((u+"").length),m.charAt(1)==="="&&(m=ws(u,m)+E),g=parseFloat(m),C=m.substr((g+"").length),c=Es.lastIndex-C.length,C||(C=C||ni.units[t]||E,c===n.length&&(n+=C,a.e+=C)),E!==C&&(u=Dn(e,t,p,C)||0),a._pt={_next:a._pt,p:v||h===1?v:",",s:u,c:g-u,m:f&&f<4||t==="zIndex"?Math.round:0});a.c=c<n.length?n.substring(c,n.length):""}else a.r=t==="display"&&n==="none"?od:rd;return Eu.test(n)&&(a.e=0),this._pt=a,a},OA={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},xE=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=OA[i]||i,t[1]=OA[n]||n,t.join(" ")},ME=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,s=t.u,r=i._gsap,a,c,h;if(s==="all"||s===!0)n.cssText="",c=1;else for(s=s.split(","),h=s.length;--h>-1;)a=s[h],ln[a]&&(c=1,a=a==="transformOrigin"?jt:ct),is(i,a);c&&(is(i,ct),r&&(r.svg&&i.removeAttribute("transform"),n.scale=n.rotate=n.translate="none",br(i,1),r.uncache=1,ad(n)))}},yo={clearProps:function(e,t,i,n,s){if(s.data!=="isFromStart"){var r=e._pt=new Wt(e._pt,t,i,0,0,ME);return r.u=n,r.pr=-10,r.tween=s,e._props.push(i),1}}},Tr=[1,0,0,1,0,0],ud={},dd=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},LA=function(e){var t=Ci(e,ct);return dd(t)?Tr:t.substr(7).match(Cu).map(dt)},Zl=function(e,t){var i=e._gsap||Xn(e),n=e.style,s=LA(e),r,a,c,h;return i.svg&&e.getAttribute("transform")?(c=e.transform.baseVal.consolidate().matrix,s=[c.a,c.b,c.c,c.d,c.e,c.f],s.join(",")==="1,0,0,1,0,0"?Tr:s):(s===Tr&&!e.offsetParent&&e!==xs&&!i.svg&&(c=n.display,n.display="block",r=e.parentNode,(!r||!e.offsetParent&&!e.getBoundingClientRect().width)&&(h=1,a=e.nextElementSibling,xs.appendChild(e)),s=LA(e),c?n.display=c:is(e,"display"),h&&(a?r.insertBefore(e,a):r?r.appendChild(e):xs.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},vl=function(e,t,i,n,s,r){var a=e._gsap,c=s||Zl(e,!0),h=a.xOrigin||0,d=a.yOrigin||0,l=a.xOffset||0,A=a.yOffset||0,u=c[0],f=c[1],p=c[2],m=c[3],g=c[4],v=c[5],C=t.split(" "),E=parseFloat(C[0])||0,_=parseFloat(C[1])||0,B,y,x,w;i?c!==Tr&&(y=u*m-f*p)&&(x=E*(m/y)+_*(-p/y)+(p*v-m*g)/y,w=E*(-f/y)+_*(u/y)-(u*v-f*g)/y,E=x,_=w):(B=Ad(e),E=B.x+(~C[0].indexOf("%")?E/100*B.width:E),_=B.y+(~(C[1]||C[0]).indexOf("%")?_/100*B.height:_)),n||n!==!1&&a.smooth?(g=E-h,v=_-d,a.xOffset=l+(g*u+v*p)-g,a.yOffset=A+(g*f+v*m)-v):a.xOffset=a.yOffset=0,a.xOrigin=E,a.yOrigin=_,a.smooth=!!n,a.origin=t,a.originIsAbsolute=!!i,e.style[jt]="0px 0px",r&&(wn(r,a,"xOrigin",h,E),wn(r,a,"yOrigin",d,_),wn(r,a,"xOffset",l,a.xOffset),wn(r,a,"yOffset",A,a.yOffset)),e.setAttribute("data-svg-origin",E+" "+_)},br=function(e,t){var i=e._gsap||new Wu(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,s=i.scaleX<0,r="px",a="deg",c=getComputedStyle(e),h=Ci(e,jt)||"0",d,l,A,u,f,p,m,g,v,C,E,_,B,y,x,w,b,P,O,S,D,Q,k,te,W,J,ee,ae,j,Ee,Be,H;return d=l=A=p=m=g=v=C=E=0,u=f=1,i.svg=!!(e.getCTM&&hd(e)),c.translate&&((c.translate!=="none"||c.scale!=="none"||c.rotate!=="none")&&(n[ct]=(c.translate!=="none"?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(c.rotate!=="none"?"rotate("+c.rotate+") ":"")+(c.scale!=="none"?"scale("+c.scale.split(" ").join(",")+") ":"")+(c[ct]!=="none"?c[ct]:"")),n.scale=n.rotate=n.translate="none"),y=Zl(e,i.svg),i.svg&&(i.uncache?(W=e.getBBox(),h=i.xOrigin-W.x+"px "+(i.yOrigin-W.y)+"px",te=""):te=!t&&e.getAttribute("data-svg-origin"),vl(e,te||h,!!te||i.originIsAbsolute,i.smooth!==!1,y)),_=i.xOrigin||0,B=i.yOrigin||0,y!==Tr&&(P=y[0],O=y[1],S=y[2],D=y[3],d=Q=y[4],l=k=y[5],y.length===6?(u=Math.sqrt(P*P+O*O),f=Math.sqrt(D*D+S*S),p=P||O?ps(O,P)*Nn:0,v=S||D?ps(S,D)*Nn+p:0,v&&(f*=Math.abs(Math.cos(v*Ms))),i.svg&&(d-=_-(_*P+B*S),l-=B-(_*O+B*D))):(H=y[6],Ee=y[7],ee=y[8],ae=y[9],j=y[10],Be=y[11],d=y[12],l=y[13],A=y[14],x=ps(H,j),m=x*Nn,x&&(w=Math.cos(-x),b=Math.sin(-x),te=Q*w+ee*b,W=k*w+ae*b,J=H*w+j*b,ee=Q*-b+ee*w,ae=k*-b+ae*w,j=H*-b+j*w,Be=Ee*-b+Be*w,Q=te,k=W,H=J),x=ps(-S,j),g=x*Nn,x&&(w=Math.cos(-x),b=Math.sin(-x),te=P*w-ee*b,W=O*w-ae*b,J=S*w-j*b,Be=D*b+Be*w,P=te,O=W,S=J),x=ps(O,P),p=x*Nn,x&&(w=Math.cos(x),b=Math.sin(x),te=P*w+O*b,W=Q*w+k*b,O=O*w-P*b,k=k*w-Q*b,P=te,Q=W),m&&Math.abs(m)+Math.abs(p)>359.9&&(m=p=0,g=180-g),u=dt(Math.sqrt(P*P+O*O+S*S)),f=dt(Math.sqrt(k*k+H*H)),x=ps(Q,k),v=Math.abs(x)>2e-4?x*Nn:0,E=Be?1/(Be<0?-Be:Be):0),i.svg&&(te=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!dd(Ci(e,ct)),te&&e.setAttribute("transform",te))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(u*=-1,v+=p<=0?180:-180,p+=p<=0?180:-180):(f*=-1,v+=v<=0?180:-180)),t=t||i.uncache,i.x=d-((i.xPercent=d&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-d)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+r,i.y=l-((i.yPercent=l&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-l)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+r,i.z=A+r,i.scaleX=dt(u),i.scaleY=dt(f),i.rotation=dt(p)+a,i.rotationX=dt(m)+a,i.rotationY=dt(g)+a,i.skewX=v+a,i.skewY=C+a,i.transformPerspective=E+r,(i.zOrigin=parseFloat(h.split(" ")[2])||!t&&i.zOrigin||0)&&(n[jt]=Io(h)),i.xOffset=i.yOffset=0,i.force3D=ni.force3D,i.renderTransform=i.svg?TE:cd?fd:SE,i.uncache=0,i},Io=function(e){return(e=e.split(" "))[0]+" "+e[1]},Qa=function(e,t,i){var n=Ft(t);return dt(parseFloat(t)+parseFloat(Dn(e,"x",i+"px",n)))+n},SE=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,fd(e,t)},Gn="0deg",rr="0px",Un=") ",fd=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,r=i.x,a=i.y,c=i.z,h=i.rotation,d=i.rotationY,l=i.rotationX,A=i.skewX,u=i.skewY,f=i.scaleX,p=i.scaleY,m=i.transformPerspective,g=i.force3D,v=i.target,C=i.zOrigin,E="",_=g==="auto"&&e&&e!==1||g===!0;if(C&&(l!==Gn||d!==Gn)){var B=parseFloat(d)*Ms,y=Math.sin(B),x=Math.cos(B),w;B=parseFloat(l)*Ms,w=Math.cos(B),r=Qa(v,r,y*w*-C),a=Qa(v,a,-Math.sin(B)*-C),c=Qa(v,c,x*w*-C+C)}m!==rr&&(E+="perspective("+m+Un),(n||s)&&(E+="translate("+n+"%, "+s+"%) "),(_||r!==rr||a!==rr||c!==rr)&&(E+=c!==rr||_?"translate3d("+r+", "+a+", "+c+") ":"translate("+r+", "+a+Un),h!==Gn&&(E+="rotate("+h+Un),d!==Gn&&(E+="rotateY("+d+Un),l!==Gn&&(E+="rotateX("+l+Un),(A!==Gn||u!==Gn)&&(E+="skew("+A+", "+u+Un),(f!==1||p!==1)&&(E+="scale("+f+", "+p+Un),v.style[ct]=E||"translate(0, 0)"},TE=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,r=i.x,a=i.y,c=i.rotation,h=i.skewX,d=i.skewY,l=i.scaleX,A=i.scaleY,u=i.target,f=i.xOrigin,p=i.yOrigin,m=i.xOffset,g=i.yOffset,v=i.forceCSS,C=parseFloat(r),E=parseFloat(a),_,B,y,x,w;c=parseFloat(c),h=parseFloat(h),d=parseFloat(d),d&&(d=parseFloat(d),h+=d,c+=d),c||h?(c*=Ms,h*=Ms,_=Math.cos(c)*l,B=Math.sin(c)*l,y=Math.sin(c-h)*-A,x=Math.cos(c-h)*A,h&&(d*=Ms,w=Math.tan(h-d),w=Math.sqrt(1+w*w),y*=w,x*=w,d&&(w=Math.tan(d),w=Math.sqrt(1+w*w),_*=w,B*=w)),_=dt(_),B=dt(B),y=dt(y),x=dt(x)):(_=l,x=A,B=y=0),(C&&!~(r+"").indexOf("px")||E&&!~(a+"").indexOf("px"))&&(C=Dn(u,"x",r,"px"),E=Dn(u,"y",a,"px")),(f||p||m||g)&&(C=dt(C+f-(f*_+p*y)+m),E=dt(E+p-(f*B+p*x)+g)),(n||s)&&(w=u.getBBox(),C=dt(C+n/100*w.width),E=dt(E+s/100*w.height)),w="matrix("+_+","+B+","+y+","+x+","+C+","+E+")",u.setAttribute("transform",w),v&&(u.style[ct]=w)},bE=function(e,t,i,n,s){var r=360,a=wt(s),c=parseFloat(s)*(a&&~s.indexOf("rad")?Nn:1),h=c-n,d=n+h+"deg",l,A;return a&&(l=s.split("_")[1],l==="short"&&(h%=r,h!==h%(r/2)&&(h+=h<0?r:-r)),l==="cw"&&h<0?h=(h+r*bA)%r-~~(h/r)*r:l==="ccw"&&h>0&&(h=(h-r*bA)%r-~~(h/r)*r)),e._pt=A=new Wt(e._pt,t,i,n,h,dE),A.e=d,A.u="deg",e._props.push(i),A},PA=function(e,t){for(var i in t)e[i]=t[i];return e},DE=function(e,t,i){var n=PA({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",r=i.style,a,c,h,d,l,A,u,f;n.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),r[ct]=t,a=br(i,1),is(i,ct),i.setAttribute("transform",h)):(h=getComputedStyle(i)[ct],r[ct]=t,a=br(i,1),r[ct]=h);for(c in ln)h=n[c],d=a[c],h!==d&&s.indexOf(c)<0&&(u=Ft(h),f=Ft(d),l=u!==f?Dn(i,c,h,f):parseFloat(h),A=parseFloat(d),e._pt=new Wt(e._pt,a,c,l,A-l,pl),e._pt.u=f||0,e._props.push(c));PA(a,n)};Xt("padding,margin,Width,Radius",function(o,e){var t="Top",i="Right",n="Bottom",s="Left",r=(e<3?[t,i,n,s]:[t+s,t+i,n+i,n+s]).map(function(a){return e<2?o+a:"border"+a+o});yo[e>1?"border"+o:o]=function(a,c,h,d,l){var A,u;if(arguments.length<4)return A=r.map(function(f){return tn(a,f,h)}),u=A.join(" "),u.split(A[0]).length===5?A[0]:u;A=(d+"").split(" "),u={},r.forEach(function(f,p){return u[f]=A[p]=A[p]||A[(p-1)/2|0]}),a.init(c,u,l)}});var pd={name:"css",register:ml,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var r=this._props,a=e.style,c=i.vars.startAt,h,d,l,A,u,f,p,m,g,v,C,E,_,B,y,x;Xl||ml(),this.styles=this.styles||ld(e),x=this.styles.props,this.tween=i;for(p in t)if(p!=="autoRound"&&(d=t[p],!(ei[p]&&ju(p,t,i,n,e,s)))){if(u=typeof d,f=yo[p],u==="function"&&(d=d.call(i,n,e,s),u=typeof d),u==="string"&&~d.indexOf("random(")&&(d=xr(d)),f)f(this,e,p,d,i)&&(y=1);else if(p.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(p)+"").trim(),d+="",Sn.lastIndex=0,Sn.test(h)||(m=Ft(h),g=Ft(d)),g?m!==g&&(h=Dn(e,p,h,g)+g):m&&(d+=m),this.add(a,"setProperty",h,d,n,s,0,0,p),r.push(p),x.push(p,0,a[p]);else if(u!=="undefined"){if(c&&p in c?(h=typeof c[p]=="function"?c[p].call(i,n,e,s):c[p],wt(h)&&~h.indexOf("random(")&&(h=xr(h)),Ft(h+"")||h==="auto"||(h+=ni.units[p]||Ft(tn(e,p))||""),(h+"").charAt(1)==="="&&(h=tn(e,p))):h=tn(e,p),A=parseFloat(h),v=u==="string"&&d.charAt(1)==="="&&d.substr(0,2),v&&(d=d.substr(2)),l=parseFloat(d),p in Ni&&(p==="autoAlpha"&&(A===1&&tn(e,"visibility")==="hidden"&&l&&(A=0),x.push("visibility",0,a.visibility),wn(this,a,"visibility",A?"inherit":"hidden",l?"inherit":"hidden",!l)),p!=="scale"&&p!=="transform"&&(p=Ni[p],~p.indexOf(",")&&(p=p.split(",")[0]))),C=p in ln,C){if(this.styles.save(p),u==="string"&&d.substring(0,6)==="var(--"&&(d=Ci(e,d.substring(4,d.indexOf(")"))),l=parseFloat(d)),E||(_=e._gsap,_.renderTransform&&!t.parseTransform||br(e,t.parseTransform),B=t.smoothOrigin!==!1&&_.smooth,E=this._pt=new Wt(this._pt,a,ct,0,1,_.renderTransform,_,0,-1),E.dep=1),p==="scale")this._pt=new Wt(this._pt,_,"scaleY",_.scaleY,(v?ws(_.scaleY,v+l):l)-_.scaleY||0,pl),this._pt.u=0,r.push("scaleY",p),p+="X";else if(p==="transformOrigin"){x.push(jt,0,a[jt]),d=xE(d),_.svg?vl(e,d,0,B,0,this):(g=parseFloat(d.split(" ")[2])||0,g!==_.zOrigin&&wn(this,_,"zOrigin",_.zOrigin,g),wn(this,a,p,Io(h),Io(d)));continue}else if(p==="svgOrigin"){vl(e,d,1,B,0,this);continue}else if(p in ud){bE(this,_,p,A,v?ws(A,v+d):d);continue}else if(p==="smoothOrigin"){wn(this,_,"smooth",_.smooth,d);continue}else if(p==="force3D"){_[p]=d;continue}else if(p==="transform"){DE(this,d,e);continue}}else p in a||(p=Qs(p)||p);if(C||(l||l===0)&&(A||A===0)&&!uE.test(d)&&p in a)m=(h+"").substr((A+"").length),l||(l=0),g=Ft(d)||(p in ni.units?ni.units[p]:m),m!==g&&(A=Dn(e,p,h,g)),this._pt=new Wt(this._pt,C?_:a,p,A,(v?ws(A,v+l):l)-A,!C&&(g==="px"||p==="zIndex")&&t.autoRound!==!1?pE:pl),this._pt.u=g||0,m!==g&&g!=="%"&&(this._pt.b=h,this._pt.r=fE);else if(p in a)wE.call(this,e,p,h,v?v+d:d);else if(p in e)this.add(e,p,h||e[p],v?v+d:d,n,s);else if(p!=="parseTransform"){Ul(p,d);continue}C||(p in a?x.push(p,0,a[p]):typeof e[p]=="function"?x.push(p,2,e[p]()):x.push(p,1,h||e[p])),r.push(p)}}y&&nd(this)},render:function(e,t){if(t.tween._time||!Wl())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:tn,aliases:Ni,getSetter:function(e,t,i){var n=Ni[t];return n&&n.indexOf(",")<0&&(t=n),t in ln&&t!==jt&&(e._gsap.x||tn(e,"x"))?i&&TA===i?t==="scale"?_E:vE:(TA=i||{})&&(t==="scale"?CE:EE):e.style&&!Ll(e.style[t])?gE:~t.indexOf("-")?mE:Yl(e,t)},core:{_removeProperty:is,_getMatrix:Zl}};Zt.utils.checkPrefix=Qs;Zt.core.getStyleSaver=ld;(function(o,e,t,i){var n=Xt(o+","+e+","+t,function(s){ln[s]=1});Xt(e,function(s){ni.units[s]="deg",ud[s]=1}),Ni[n[13]]=o+","+e,Xt(i,function(s){var r=s.split(":");Ni[r[1]]=n[r[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Xt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(o){ni.units[o]="px"});Zt.registerPlugin(pd);var pi=Zt.registerPlugin(pd)||Zt;pi.core.Tween;/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.20.0
 * @author George Michael Brower
 * @license MIT
 */class zi{constructor(e,t,i,n,s="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(s),this.domElement.classList.add("controller"),this.domElement.classList.add(n),this.$name=document.createElement("div"),this.$name.classList.add("name"),zi.nextNameID=zi.nextNameID||0,this.$name.id=`lil-gui-name-${++zi.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",r=>r.stopPropagation()),this.domElement.addEventListener("keyup",r=>r.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.textContent=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled?this:(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e),this)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.getValue()!==e&&(this.object[this.property]=e,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class RE extends zi{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function _l(o){let e,t;return(e=o.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=o.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=o.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t?"#"+t:!1}const QE={isPrimitive:!0,match:o=>typeof o=="string",fromHexString:_l,toHexString:_l},Dr={isPrimitive:!0,match:o=>typeof o=="number",fromHexString:o=>parseInt(o.substring(1),16),toHexString:o=>"#"+o.toString(16).padStart(6,0)},FE={isPrimitive:!1,match:o=>Array.isArray(o),fromHexString(o,e,t=1){const i=Dr.fromHexString(o);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(i&255)/255*t},toHexString([o,e,t],i=1){i=255/i;const n=o*i<<16^e*i<<8^t*i<<0;return Dr.toHexString(n)}},OE={isPrimitive:!1,match:o=>Object(o)===o,fromHexString(o,e,t=1){const i=Dr.fromHexString(o);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(i&255)/255*t},toHexString({r:o,g:e,b:t},i=1){i=255/i;const n=o*i<<16^e*i<<8^t*i<<0;return Dr.toHexString(n)}},LE=[QE,Dr,FE,OE];function PE(o){return LE.find(e=>e.match(o))}class GE extends zi{constructor(e,t,i,n){super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=PE(this.initialValue),this._rgbScale=n,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=_l(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Fa extends zi{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",n=>{n.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class UE extends zi{constructor(e,t,i,n,s,r){super(e,t,i,"number"),this._initInput(),this.min(n),this.max(s);const a=r!==void 0;this.step(a?r:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=t*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=()=>{let v=parseFloat(this.$input.value);isNaN(v)||(this._stepExplicit&&(v=this._snap(v)),this.setValue(this._clamp(v)))},i=v=>{const C=parseFloat(this.$input.value);isNaN(C)||(this._snapClampSetValue(C+v),this.$input.value=this.getValue())},n=v=>{v.key==="Enter"&&this.$input.blur(),v.code==="ArrowUp"&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v))),v.code==="ArrowDown"&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v)*-1))},s=v=>{this._inputFocused&&(v.preventDefault(),i(this._step*this._normalizeMouseWheel(v)))};let r=!1,a,c,h,d,l;const A=5,u=v=>{a=v.clientX,c=h=v.clientY,r=!0,d=this.getValue(),l=0,window.addEventListener("mousemove",f),window.addEventListener("mouseup",p)},f=v=>{if(r){const C=v.clientX-a,E=v.clientY-c;Math.abs(E)>A?(v.preventDefault(),this.$input.blur(),r=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(C)>A&&p()}if(!r){const C=v.clientY-h;l-=C*this._step*this._arrowKeyMultiplier(v),d+l>this._max?l=this._max-d:d+l<this._min&&(l=this._min-d),this._snapClampSetValue(d+l)}h=v.clientY},p=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p)},m=()=>{this._inputFocused=!0},g=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",n),this.$input.addEventListener("wheel",s,{passive:!1}),this.$input.addEventListener("mousedown",u),this.$input.addEventListener("focus",m),this.$input.addEventListener("blur",g)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=(g,v,C,E,_)=>(g-v)/(C-v)*(_-E)+E,t=g=>{const v=this.$slider.getBoundingClientRect();let C=e(g,v.left,v.right,this._min,this._max);this._snapClampSetValue(C)},i=g=>{this._setDraggingStyle(!0),t(g.clientX),window.addEventListener("mousemove",n),window.addEventListener("mouseup",s)},n=g=>{t(g.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",s)};let r=!1,a,c;const h=g=>{g.preventDefault(),this._setDraggingStyle(!0),t(g.touches[0].clientX),r=!1},d=g=>{g.touches.length>1||(this._hasScrollBar?(a=g.touches[0].clientX,c=g.touches[0].clientY,r=!0):h(g),window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",A))},l=g=>{if(r){const v=g.touches[0].clientX-a,C=g.touches[0].clientY-c;Math.abs(v)>Math.abs(C)?h(g):(window.removeEventListener("touchmove",l),window.removeEventListener("touchend",A))}else g.preventDefault(),t(g.touches[0].clientX)},A=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",A)},u=this._callOnFinishChange.bind(this),f=400;let p;const m=g=>{if(Math.abs(g.deltaX)<Math.abs(g.deltaY)&&this._hasScrollBar)return;g.preventDefault();const C=this._normalizeMouseWheel(g)*this._step;this._snapClampSetValue(this.getValue()+C),this.$input.value=this.getValue(),clearTimeout(p),p=setTimeout(u,f)};this.$slider.addEventListener("mousedown",i),this.$slider.addEventListener("touchstart",d,{passive:!1}),this.$slider.addEventListener("wheel",m,{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){let t=0;return this._hasMin?t=this._min:this._hasMax&&(t=this._max),e-=t,e=Math.round(e/this._step)*this._step,e+=t,e=parseFloat(e.toPrecision(15)),e}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class kE extends zi{constructor(e,t,i,n){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(n)}options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(t=>{const i=document.createElement("option");i.textContent=t,this.$select.appendChild(i)}),this.updateDisplay(),this}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.textContent=t===-1?e:this._names[t],this}}class NE extends zi{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",n=>{n.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}var HE=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  font-weight: 600;
  padding: 0 var(--padding);
  width: 100%;
  text-align: left;
  background: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  border: none;
}
.lil-gui .controller button {
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
}
@media (hover: hover) {
  .lil-gui .controller button:hover {
    background: var(--hover-color);
  }
  .lil-gui .controller button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui .controller button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function zE(o){const e=document.createElement("style");e.innerHTML=o;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}let GA=!1;class $l{constructor({parent:e,autoPlace:t=e===void 0,container:i,width:n,title:s="Controls",closeFolders:r=!1,injectStyles:a=!0,touchStyles:c=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("button"),this.$title.classList.add("title"),this.$title.setAttribute("aria-expanded",!0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),c&&this.domElement.classList.add("allow-touch-styles"),!GA&&a&&(zE(HE),GA=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),n&&this.domElement.style.setProperty("--width",n+"px"),this._closeFolders=r}add(e,t,i,n,s){if(Object(i)===i)return new kE(this,e,t,i);const r=e[t];switch(typeof r){case"number":return new UE(this,e,t,i,n,s);case"boolean":return new RE(this,e,t);case"string":return new NE(this,e,t);case"function":return new Fa(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,r)}addColor(e,t,i=1){return new GE(this,e,t,i)}addFolder(e){const t=new $l({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof Fa||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof Fa)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const n=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=n+"px"})}),this}title(e){return this._title=e,this.$title.textContent=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}var Oa={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var UA;function JE(){return UA||(UA=1,function(o){(function(){var e=function(){this.init()};e.prototype={init:function(){var l=this||t;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var A=this||t;if(l=parseFloat(l),A.ctx||d(),typeof l<"u"&&l>=0&&l<=1){if(A._volume=l,A._muted)return A;A.usingWebAudio&&A.masterGain.gain.setValueAtTime(l,t.ctx.currentTime);for(var u=0;u<A._howls.length;u++)if(!A._howls[u]._webAudio)for(var f=A._howls[u]._getSoundIds(),p=0;p<f.length;p++){var m=A._howls[u]._soundById(f[p]);m&&m._node&&(m._node.volume=m._volume*l)}return A}return A._volume},mute:function(l){var A=this||t;A.ctx||d(),A._muted=l,A.usingWebAudio&&A.masterGain.gain.setValueAtTime(l?0:A._volume,t.ctx.currentTime);for(var u=0;u<A._howls.length;u++)if(!A._howls[u]._webAudio)for(var f=A._howls[u]._getSoundIds(),p=0;p<f.length;p++){var m=A._howls[u]._soundById(f[p]);m&&m._node&&(m._node.muted=l?!0:m._muted)}return A},stop:function(){for(var l=this||t,A=0;A<l._howls.length;A++)l._howls[A].stop();return l},unload:function(){for(var l=this||t,A=l._howls.length-1;A>=0;A--)l._howls[A].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,d()),l},codecs:function(l){return(this||t)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||t;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var A=new Audio;typeof A.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var A=new Audio;A.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||t,A=null;try{A=typeof Audio<"u"?new Audio:null}catch{return l}if(!A||typeof A.canPlayType!="function")return l;var u=A.canPlayType("audio/mpeg;").replace(/^no$/,""),f=l._navigator?l._navigator.userAgent:"",p=f.match(/OPR\/(\d+)/g),m=p&&parseInt(p[0].split("/")[1],10)<33,g=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,v=f.match(/Version\/(.*?) /),C=g&&v&&parseInt(v[1],10)<15;return l._codecs={mp3:!!(!m&&(u||A.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!u,opus:!!A.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!A.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!A.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(A.canPlayType('audio/wav; codecs="1"')||A.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!A.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!A.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(A.canPlayType("audio/x-m4a;")||A.canPlayType("audio/m4a;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(A.canPlayType("audio/x-m4b;")||A.canPlayType("audio/m4b;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(A.canPlayType("audio/x-mp4;")||A.canPlayType("audio/mp4;")||A.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!C&&A.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!C&&A.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!A.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(A.canPlayType("audio/x-flac;")||A.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||t;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var A=function(u){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,l._releaseHtml5Audio(f)}catch{l.noAudio=!0;break}for(var p=0;p<l._howls.length;p++)if(!l._howls[p]._webAudio)for(var m=l._howls[p]._getSoundIds(),g=0;g<m.length;g++){var v=l._howls[p]._soundById(m[g]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}l._autoResume();var C=l.ctx.createBufferSource();C.buffer=l._scratchBuffer,C.connect(l.ctx.destination),typeof C.start>"u"?C.noteOn(0):C.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),C.onended=function(){C.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",A,!0),document.removeEventListener("touchend",A,!0),document.removeEventListener("click",A,!0),document.removeEventListener("keydown",A,!0);for(var E=0;E<l._howls.length;E++)l._howls[E]._emit("unlock")}};return document.addEventListener("touchstart",A,!0),document.addEventListener("touchend",A,!0),document.addEventListener("click",A,!0),document.addEventListener("keydown",A,!0),l}},_obtainHtml5Audio:function(){var l=this||t;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var A=new Audio().play();return A&&typeof Promise<"u"&&(A instanceof Promise||typeof A.then=="function")&&A.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var A=this||t;return l._unlocked&&A._html5AudioPool.push(l),A},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!t.usingWebAudio)){for(var A=0;A<l._howls.length;A++)if(l._howls[A]._webAudio){for(var u=0;u<l._howls[A]._sounds.length;u++)if(!l._howls[A]._sounds[u]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var f=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(f,f)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!t.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var A=0;A<l._howls.length;A++)l._howls[A]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var t=new e,i=function(l){var A=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}A.init(l)};i.prototype={init:function(l){var A=this;return t.ctx||d(),A._autoplay=l.autoplay||!1,A._format=typeof l.format!="string"?l.format:[l.format],A._html5=l.html5||!1,A._muted=l.mute||!1,A._loop=l.loop||!1,A._pool=l.pool||5,A._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,A._rate=l.rate||1,A._sprite=l.sprite||{},A._src=typeof l.src!="string"?l.src:[l.src],A._volume=l.volume!==void 0?l.volume:1,A._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},A._duration=0,A._state="unloaded",A._sounds=[],A._endTimers={},A._queue=[],A._playLock=!1,A._onend=l.onend?[{fn:l.onend}]:[],A._onfade=l.onfade?[{fn:l.onfade}]:[],A._onload=l.onload?[{fn:l.onload}]:[],A._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],A._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],A._onpause=l.onpause?[{fn:l.onpause}]:[],A._onplay=l.onplay?[{fn:l.onplay}]:[],A._onstop=l.onstop?[{fn:l.onstop}]:[],A._onmute=l.onmute?[{fn:l.onmute}]:[],A._onvolume=l.onvolume?[{fn:l.onvolume}]:[],A._onrate=l.onrate?[{fn:l.onrate}]:[],A._onseek=l.onseek?[{fn:l.onseek}]:[],A._onunlock=l.onunlock?[{fn:l.onunlock}]:[],A._onresume=[],A._webAudio=t.usingWebAudio&&!A._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(A),A._autoplay&&A._queue.push({event:"play",action:function(){A.play()}}),A._preload&&A._preload!=="none"&&A.load(),A},load:function(){var l=this,A=null;if(t.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var u=0;u<l._src.length;u++){var f,p;if(l._format&&l._format[u])f=l._format[u];else{if(p=l._src[u],typeof p!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(p),f||(f=/\.([^.]+)$/.exec(p.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&t.codecs(f)){A=l._src[u];break}}if(!A){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=A,l._state="loading",window.location.protocol==="https:"&&A.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new n(l),l._webAudio&&r(l),l},play:function(l,A){var u=this,f=null;if(typeof l=="number")f=l,l=null;else{if(typeof l=="string"&&u._state==="loaded"&&!u._sprite[l])return null;if(typeof l>"u"&&(l="__default",!u._playLock)){for(var p=0,m=0;m<u._sounds.length;m++)u._sounds[m]._paused&&!u._sounds[m]._ended&&(p++,f=u._sounds[m]._id);p===1?l=null:f=null}}var g=f?u._soundById(f):u._inactiveSound();if(!g)return null;if(f&&!l&&(l=g._sprite||"__default"),u._state!=="loaded"){g._sprite=l,g._ended=!1;var v=g._id;return u._queue.push({event:"play",action:function(){u.play(v)}}),v}if(f&&!g._paused)return A||u._loadQueue("play"),g._id;u._webAudio&&t._autoResume();var C=Math.max(0,g._seek>0?g._seek:u._sprite[l][0]/1e3),E=Math.max(0,(u._sprite[l][0]+u._sprite[l][1])/1e3-C),_=E*1e3/Math.abs(g._rate),B=u._sprite[l][0]/1e3,y=(u._sprite[l][0]+u._sprite[l][1])/1e3;g._sprite=l,g._ended=!1;var x=function(){g._paused=!1,g._seek=C,g._start=B,g._stop=y,g._loop=!!(g._loop||u._sprite[l][2])};if(C>=y){u._ended(g);return}var w=g._node;if(u._webAudio){var b=function(){u._playLock=!1,x(),u._refreshBuffer(g);var D=g._muted||u._muted?0:g._volume;w.gain.setValueAtTime(D,t.ctx.currentTime),g._playStart=t.ctx.currentTime,typeof w.bufferSource.start>"u"?g._loop?w.bufferSource.noteGrainOn(0,C,86400):w.bufferSource.noteGrainOn(0,C,E):g._loop?w.bufferSource.start(0,C,86400):w.bufferSource.start(0,C,E),_!==1/0&&(u._endTimers[g._id]=setTimeout(u._ended.bind(u,g),_)),A||setTimeout(function(){u._emit("play",g._id),u._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?b():(u._playLock=!0,u.once("resume",b),u._clearTimer(g._id))}else{var P=function(){w.currentTime=C,w.muted=g._muted||u._muted||t._muted||w.muted,w.volume=g._volume*t.volume(),w.playbackRate=g._rate;try{var D=w.play();if(D&&typeof Promise<"u"&&(D instanceof Promise||typeof D.then=="function")?(u._playLock=!0,x(),D.then(function(){u._playLock=!1,w._unlocked=!0,A?u._loadQueue():u._emit("play",g._id)}).catch(function(){u._playLock=!1,u._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):A||(u._playLock=!1,x(),u._emit("play",g._id)),w.playbackRate=g._rate,w.paused){u._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||g._loop?u._endTimers[g._id]=setTimeout(u._ended.bind(u,g),_):(u._endTimers[g._id]=function(){u._ended(g),w.removeEventListener("ended",u._endTimers[g._id],!1)},w.addEventListener("ended",u._endTimers[g._id],!1))}catch(Q){u._emit("playerror",g._id,Q)}};w.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(w.src=u._src,w.load());var O=window&&window.ejecta||!w.readyState&&t._navigator.isCocoonJS;if(w.readyState>=3||O)P();else{u._playLock=!0,u._state="loading";var S=function(){u._state="loaded",P(),w.removeEventListener(t._canPlayEvent,S,!1)};w.addEventListener(t._canPlayEvent,S,!1),u._clearTimer(g._id)}}return g._id},pause:function(l){var A=this;if(A._state!=="loaded"||A._playLock)return A._queue.push({event:"pause",action:function(){A.pause(l)}}),A;for(var u=A._getSoundIds(l),f=0;f<u.length;f++){A._clearTimer(u[f]);var p=A._soundById(u[f]);if(p&&!p._paused&&(p._seek=A.seek(u[f]),p._rateSeek=0,p._paused=!0,A._stopFade(u[f]),p._node))if(A._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),A._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||A._emit("pause",p?p._id:null)}return A},stop:function(l,A){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"stop",action:function(){u.stop(l)}}),u;for(var f=u._getSoundIds(l),p=0;p<f.length;p++){u._clearTimer(f[p]);var m=u._soundById(f[p]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,u._stopFade(f[p]),m._node&&(u._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),u._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&u._clearSound(m._node))),A||u._emit("stop",m._id))}return u},mute:function(l,A){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"mute",action:function(){u.mute(l,A)}}),u;if(typeof A>"u")if(typeof l=="boolean")u._muted=l;else return u._muted;for(var f=u._getSoundIds(A),p=0;p<f.length;p++){var m=u._soundById(f[p]);m&&(m._muted=l,m._interval&&u._stopFade(m._id),u._webAudio&&m._node?m._node.gain.setValueAtTime(l?0:m._volume,t.ctx.currentTime):m._node&&(m._node.muted=t._muted?!0:l),u._emit("mute",m._id))}return u},volume:function(){var l=this,A=arguments,u,f;if(A.length===0)return l._volume;if(A.length===1||A.length===2&&typeof A[1]>"u"){var p=l._getSoundIds(),m=p.indexOf(A[0]);m>=0?f=parseInt(A[0],10):u=parseFloat(A[0])}else A.length>=2&&(u=parseFloat(A[0]),f=parseInt(A[1],10));var g;if(typeof u<"u"&&u>=0&&u<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,A)}}),l;typeof f>"u"&&(l._volume=u),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)g=l._soundById(f[v]),g&&(g._volume=u,A[2]||l._stopFade(f[v]),l._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(u,t.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=u*t.volume()),l._emit("volume",g._id))}else return g=f?l._soundById(f):l._sounds[0],g?g._volume:0;return l},fade:function(l,A,u,f){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(l,A,u,f)}}),p;l=Math.min(Math.max(0,parseFloat(l)),1),A=Math.min(Math.max(0,parseFloat(A)),1),u=parseFloat(u),p.volume(l,f);for(var m=p._getSoundIds(f),g=0;g<m.length;g++){var v=p._soundById(m[g]);if(v){if(f||p._stopFade(m[g]),p._webAudio&&!v._muted){var C=t.ctx.currentTime,E=C+u/1e3;v._volume=l,v._node.gain.setValueAtTime(l,C),v._node.gain.linearRampToValueAtTime(A,E)}p._startFadeInterval(v,l,A,u,m[g],typeof f>"u")}}return p},_startFadeInterval:function(l,A,u,f,p,m){var g=this,v=A,C=u-A,E=Math.abs(C/.01),_=Math.max(4,E>0?f/E:f),B=Date.now();l._fadeTo=u,l._interval=setInterval(function(){var y=(Date.now()-B)/f;B=Date.now(),v+=C*y,v=Math.round(v*100)/100,C<0?v=Math.max(u,v):v=Math.min(u,v),g._webAudio?l._volume=v:g.volume(v,l._id,!0),m&&(g._volume=v),(u<A&&v<=u||u>A&&v>=u)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,g.volume(u,l._id),g._emit("fade",l._id))},_)},_stopFade:function(l){var A=this,u=A._soundById(l);return u&&u._interval&&(A._webAudio&&u._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(u._interval),u._interval=null,A.volume(u._fadeTo,l),u._fadeTo=null,A._emit("fade",l)),A},loop:function(){var l=this,A=arguments,u,f,p;if(A.length===0)return l._loop;if(A.length===1)if(typeof A[0]=="boolean")u=A[0],l._loop=u;else return p=l._soundById(parseInt(A[0],10)),p?p._loop:!1;else A.length===2&&(u=A[0],f=parseInt(A[1],10));for(var m=l._getSoundIds(f),g=0;g<m.length;g++)p=l._soundById(m[g]),p&&(p._loop=u,l._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=u,u&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,l.playing(m[g])&&(l.pause(m[g],!0),l.play(m[g],!0)))));return l},rate:function(){var l=this,A=arguments,u,f;if(A.length===0)f=l._sounds[0]._id;else if(A.length===1){var p=l._getSoundIds(),m=p.indexOf(A[0]);m>=0?f=parseInt(A[0],10):u=parseFloat(A[0])}else A.length===2&&(u=parseFloat(A[0]),f=parseInt(A[1],10));var g;if(typeof u=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,A)}}),l;typeof f>"u"&&(l._rate=u),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)if(g=l._soundById(f[v]),g){l.playing(f[v])&&(g._rateSeek=l.seek(f[v]),g._playStart=l._webAudio?t.ctx.currentTime:g._playStart),g._rate=u,l._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(u,t.ctx.currentTime):g._node&&(g._node.playbackRate=u);var C=l.seek(f[v]),E=(l._sprite[g._sprite][0]+l._sprite[g._sprite][1])/1e3-C,_=E*1e3/Math.abs(g._rate);(l._endTimers[f[v]]||!g._paused)&&(l._clearTimer(f[v]),l._endTimers[f[v]]=setTimeout(l._ended.bind(l,g),_)),l._emit("rate",g._id)}}else return g=l._soundById(f),g?g._rate:l._rate;return l},seek:function(){var l=this,A=arguments,u,f;if(A.length===0)l._sounds.length&&(f=l._sounds[0]._id);else if(A.length===1){var p=l._getSoundIds(),m=p.indexOf(A[0]);m>=0?f=parseInt(A[0],10):l._sounds.length&&(f=l._sounds[0]._id,u=parseFloat(A[0]))}else A.length===2&&(u=parseFloat(A[0]),f=parseInt(A[1],10));if(typeof f>"u")return 0;if(typeof u=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,A)}}),l;var g=l._soundById(f);if(g)if(typeof u=="number"&&u>=0){var v=l.playing(f);v&&l.pause(f,!0),g._seek=u,g._ended=!1,l._clearTimer(f),!l._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=u);var C=function(){v&&l.play(f,!0),l._emit("seek",f)};if(v&&!l._webAudio){var E=function(){l._playLock?setTimeout(E,0):C()};setTimeout(E,0)}else C()}else if(l._webAudio){var _=l.playing(f)?t.ctx.currentTime-g._playStart:0,B=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(B+_*Math.abs(g._rate))}else return g._node.currentTime;return l},playing:function(l){var A=this;if(typeof l=="number"){var u=A._soundById(l);return u?!u._paused:!1}for(var f=0;f<A._sounds.length;f++)if(!A._sounds[f]._paused)return!0;return!1},duration:function(l){var A=this,u=A._duration,f=A._soundById(l);return f&&(u=A._sprite[f._sprite][1]/1e3),u},state:function(){return this._state},unload:function(){for(var l=this,A=l._sounds,u=0;u<A.length;u++)A[u]._paused||l.stop(A[u]._id),l._webAudio||(l._clearSound(A[u]._node),A[u]._node.removeEventListener("error",A[u]._errorFn,!1),A[u]._node.removeEventListener(t._canPlayEvent,A[u]._loadFn,!1),A[u]._node.removeEventListener("ended",A[u]._endFn,!1),t._releaseHtml5Audio(A[u]._node)),delete A[u]._node,l._clearTimer(A[u]._id);var f=t._howls.indexOf(l);f>=0&&t._howls.splice(f,1);var p=!0;for(u=0;u<t._howls.length;u++)if(t._howls[u]._src===l._src||l._src.indexOf(t._howls[u]._src)>=0){p=!1;break}return s&&p&&delete s[l._src],t.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,A,u,f){var p=this,m=p["_on"+l];return typeof A=="function"&&m.push(f?{id:u,fn:A,once:f}:{id:u,fn:A}),p},off:function(l,A,u){var f=this,p=f["_on"+l],m=0;if(typeof A=="number"&&(u=A,A=null),A||u)for(m=0;m<p.length;m++){var g=u===p[m].id;if(A===p[m].fn&&g||!A&&g){p.splice(m,1);break}}else if(l)f["_on"+l]=[];else{var v=Object.keys(f);for(m=0;m<v.length;m++)v[m].indexOf("_on")===0&&Array.isArray(f[v[m]])&&(f[v[m]]=[])}return f},once:function(l,A,u){var f=this;return f.on(l,A,u,1),f},_emit:function(l,A,u){for(var f=this,p=f["_on"+l],m=p.length-1;m>=0;m--)(!p[m].id||p[m].id===A||l==="load")&&(setTimeout((function(g){g.call(this,A,u)}).bind(f,p[m].fn),0),p[m].once&&f.off(l,p[m].fn,p[m].id));return f._loadQueue(l),f},_loadQueue:function(l){var A=this;if(A._queue.length>0){var u=A._queue[0];u.event===l&&(A._queue.shift(),A._loadQueue()),l||u.action()}return A},_ended:function(l){var A=this,u=l._sprite;if(!A._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(A._ended.bind(A,l),100),A;var f=!!(l._loop||A._sprite[u][2]);if(A._emit("end",l._id),!A._webAudio&&f&&A.stop(l._id,!0).play(l._id),A._webAudio&&f){A._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=t.ctx.currentTime;var p=(l._stop-l._start)*1e3/Math.abs(l._rate);A._endTimers[l._id]=setTimeout(A._ended.bind(A,l),p)}return A._webAudio&&!f&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,A._clearTimer(l._id),A._cleanBuffer(l._node),t._autoSuspend()),!A._webAudio&&!f&&A.stop(l._id,!0),A},_clearTimer:function(l){var A=this;if(A._endTimers[l]){if(typeof A._endTimers[l]!="function")clearTimeout(A._endTimers[l]);else{var u=A._soundById(l);u&&u._node&&u._node.removeEventListener("ended",A._endTimers[l],!1)}delete A._endTimers[l]}return A},_soundById:function(l){for(var A=this,u=0;u<A._sounds.length;u++)if(l===A._sounds[u]._id)return A._sounds[u];return null},_inactiveSound:function(){var l=this;l._drain();for(var A=0;A<l._sounds.length;A++)if(l._sounds[A]._ended)return l._sounds[A].reset();return new n(l)},_drain:function(){var l=this,A=l._pool,u=0,f=0;if(!(l._sounds.length<A)){for(f=0;f<l._sounds.length;f++)l._sounds[f]._ended&&u++;for(f=l._sounds.length-1;f>=0;f--){if(u<=A)return;l._sounds[f]._ended&&(l._webAudio&&l._sounds[f]._node&&l._sounds[f]._node.disconnect(0),l._sounds.splice(f,1),u--)}}},_getSoundIds:function(l){var A=this;if(typeof l>"u"){for(var u=[],f=0;f<A._sounds.length;f++)u.push(A._sounds[f]._id);return u}else return[l]},_refreshBuffer:function(l){var A=this;return l._node.bufferSource=t.ctx.createBufferSource(),l._node.bufferSource.buffer=s[A._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,t.ctx.currentTime),A},_cleanBuffer:function(l){var A=this,u=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!l.bufferSource)return A;if(t._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),u))try{l.bufferSource.buffer=t._scratchBuffer}catch{}return l.bufferSource=null,A},_clearSound:function(l){var A=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);A||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(l){this._parent=l,this.init()};n.prototype={init:function(){var l=this,A=l._parent;return l._muted=A._muted,l._loop=A._loop,l._volume=A._volume,l._rate=A._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,A._sounds.push(l),l.create(),l},create:function(){var l=this,A=l._parent,u=t._muted||l._muted||l._parent._muted?0:l._volume;return A._webAudio?(l._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),l._node.gain.setValueAtTime(u,t.ctx.currentTime),l._node.paused=!0,l._node.connect(t.masterGain)):t.noAudio||(l._node=t._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(t._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=A._src,l._node.preload=A._preload===!0?"auto":A._preload,l._node.volume=u*t.volume(),l._node.load()),l},reset:function(){var l=this,A=l._parent;return l._muted=A._muted,l._loop=A._loop,l._volume=A._volume,l._rate=A._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,A=l._parent;A._duration=Math.ceil(l._node.duration*10)/10,Object.keys(A._sprite).length===0&&(A._sprite={__default:[0,A._duration*1e3]}),A._state!=="loaded"&&(A._state="loaded",A._emit("load"),A._loadQueue()),l._node.removeEventListener(t._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,A=l._parent;A._duration===1/0&&(A._duration=Math.ceil(l._node.duration*10)/10,A._sprite.__default[1]===1/0&&(A._sprite.__default[1]=A._duration*1e3),A._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var s={},r=function(l){var A=l._src;if(s[A]){l._duration=s[A].duration,h(l);return}if(/^data:[^;]+;base64,/.test(A)){for(var u=atob(A.split(",")[1]),f=new Uint8Array(u.length),p=0;p<u.length;++p)f[p]=u.charCodeAt(p);c(f.buffer,l)}else{var m=new XMLHttpRequest;m.open(l._xhr.method,A,!0),m.withCredentials=l._xhr.withCredentials,m.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(g){m.setRequestHeader(g,l._xhr.headers[g])}),m.onload=function(){var g=(m.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}c(m.response,l)},m.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete s[A],l.load())},a(m)}},a=function(l){try{l.send()}catch{l.onerror()}},c=function(l,A){var u=function(){A._emit("loaderror",null,"Decoding audio data failed.")},f=function(p){p&&A._sounds.length>0?(s[A._src]=p,h(A,p)):u()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(l).then(f).catch(u):t.ctx.decodeAudioData(l,f,u)},h=function(l,A){A&&!l._duration&&(l._duration=A.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},d=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),A=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),u=A?parseInt(A[1],10):null;if(l&&u&&u<9){var f=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!f&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};o.Howler=t,o.Howl=i,typeof Ks<"u"?(Ks.HowlerGlobal=e,Ks.Howler=t,Ks.Howl=i,Ks.Sound=n):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=n)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var n=i._howls.length-1;n>=0;n--)i._howls[n].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,n=typeof n!="number"?s._pos[2]:n,typeof t=="number")s._pos=[t,i,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,i,n,s,r,a){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(i=typeof i!="number"?h[1]:i,n=typeof n!="number"?h[2]:n,s=typeof s!="number"?h[3]:s,r=typeof r!="number"?h[4]:r,a=typeof a!="number"?h[5]:a,typeof t=="number")c._orientation=[t,i,n,s,r,a],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(t,i,n,s,r,a);else return h;return c},Howl.prototype.init=function(t){return function(i){var n=this;return n._orientation=i.orientation||[1,0,0],n._stereo=i.stereo||null,n._pos=i.pos||null,n._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},n._onstereo=i.onstereo?[{fn:i.onstereo}]:[],n._onpos=i.onpos?[{fn:i.onpos}]:[],n._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(t,i)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")n._stereo=t,n._pos=[t,0,0];else return n._stereo;for(var r=n._getSoundIds(i),a=0;a<r.length;a++){var c=n._soundById(r[a]);if(c)if(typeof t=="number")c._stereo=t,c._pos=[t,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&e(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(t,0,0):c._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),n._emit("stereo",c._id);else return c._stereo}return n},Howl.prototype.pos=function(t,i,n,s){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"pos",action:function(){r.pos(t,i,n,s)}}),r;if(i=typeof i!="number"?0:i,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof t=="number")r._pos=[t,i,n];else return r._pos;for(var a=r._getSoundIds(s),c=0;c<a.length;c++){var h=r._soundById(a[c]);if(h)if(typeof t=="number")h._pos=[t,i,n],h._node&&((!h._panner||h._panner.pan)&&e(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(t,i,n)),r._emit("pos",h._id);else return h._pos}return r},Howl.prototype.orientation=function(t,i,n,s){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"orientation",action:function(){r.orientation(t,i,n,s)}}),r;if(i=typeof i!="number"?r._orientation[1]:i,n=typeof n!="number"?r._orientation[2]:n,typeof s>"u")if(typeof t=="number")r._orientation=[t,i,n];else return r._orientation;for(var a=r._getSoundIds(s),c=0;c<a.length;c++){var h=r._soundById(a[c]);if(h)if(typeof t=="number")h._orientation=[t,i,n],h._node&&(h._panner||(h._pos||(h._pos=r._pos||[0,0,-.5]),e(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(t,i,n)),r._emit("orientation",h._id);else return h._orientation}return r},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,n,s,r;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")n=i[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),t._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:t._panningModel});else return r=t._soundById(parseInt(i[0],10)),r?r._pannerAttr:t._pannerAttr;else i.length===2&&(n=i[0],s=parseInt(i[1],10));for(var a=t._getSoundIds(s),c=0;c<a.length;c++)if(r=t._soundById(a[c]),r){var h=r._pannerAttr;h={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:h.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:h.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:h.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:h.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:h.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:h.panningModel};var d=r._panner;d||(r._pos||(r._pos=t._pos||[0,0,-.5]),e(r,"spatial"),d=r._panner),d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel}return t},Sound.prototype.init=function(t){return function(){var i=this,n=i._parent;i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,t.call(this),i._stereo?n.stereo(i._stereo):i._pos&&n.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,n=i._parent;return i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,i._stereo?n.stereo(i._stereo):i._pos?n.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,n._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var e=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()}(Oa)),Oa}var VE=JE(),KE=`precision highp float;

varying vec2 vUv;

void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,YE=`precision highp float;

uniform sampler2D uEnvmap1;
uniform sampler2D uEnvmap2;
uniform float uWeight;
uniform float uIntensity;

varying vec2 vUv;

void main() {
	vec3 envmap1 = texture2D(uEnvmap1, vUv).rgb;
	vec3 envmap2 = texture2D(uEnvmap2, vUv).rgb;
	vec3 col = mix(envmap1, envmap2, clamp(uWeight, 0.0, 1.0)) * uIntensity;
	col = col / (col + vec3(1.0)); 
	gl_FragColor = vec4(col, 1.0);
}`;const qE=pi.timeline();class XE extends xt{constructor(t){super(t);N(this,"rt");N(this,"material");N(this,"quad");const i=sA(this.base.renderer,t.am.items.ut_env_night),n=sA(this.base.renderer,this.base.am.items.ut_env_light),s=i==null?void 0:i.source.data,r=new Bi(s.width,s.height,{minFilter:Pt,magFilter:Pt,type:Ot});r.texture.mapping=Tf,this.rt=r;const a=new Qt({vertexShader:KE,fragmentShader:YE,uniforms:{uEnvmap1:{value:i},uEnvmap2:{value:n},uWeight:{value:this.base.params.envWeight},uIntensity:{value:this.base.params.envIntensity}}});this.material=a;const c=new qa(a);this.quad=c;const h=this.base.debug.addFolder("DynamicEnv");h.add(this.base.params,"envWeight",0,1,.01).name("weight").onChange(d=>{this.setWeight(d)}),h.add(this.base.params,"envIntensity",0,1,.01).name("intensity").onChange(d=>{this.setIntensity(d)})}update(){this.base.renderer.setRenderTarget(this.rt),this.quad.render(this.base.renderer),this.base.renderer.setRenderTarget(null)}get envmap(){return this.rt.texture}setWeight(t){this.material.uniforms.uWeight.value=t}setIntensity(t){this.material.uniforms.uIntensity.value=t}lerpWeight(t,i){qE.to(this.material.uniforms.uWeight,{value:t,duration:i,ease:"power2.out"})}}var WE=`uniform float iTime;
uniform vec2 iResolution;
uniform vec2 iMouse;

varying vec2 vUv_;
varying vec4 vWorldPosition;

void main(){
    vec3 p=position;
    
    csm_Position=p;
    
    vUv_=uv;
    vWorldPosition=modelMatrix*vec4(p,1);
}`,jE=`#ifndef FNC_POW5
#define FNC_POW5

float pow5(const in float v) {
    float v2 = v * v;
    return v2 * v2 * v;
}

vec2 pow5(const in vec2 v) {
    vec2 v2 = v * v;
    return v2 * v2 * v;
}

vec3 pow5(const in vec3 v) {
    vec3 v2 = v * v;
    return v2 * v2 * v;
}

vec4 pow5(const in vec4 v) {
    vec4 v2 = v * v;
    return v2 * v2 * v;
}

#endif

#ifndef FNC_SCHLICK
#define FNC_SCHLICK

vec3 schlick(const in vec3 f0, const in float f90, const in float VoH) {
    float f = pow5(1.0 - VoH);
    return f + f0 * (f90 - f);
}

vec3 schlick(const in vec3 f0, const in vec3 f90, const in float VoH) {
    return f0 + (f90 - f0) * pow5(1.0 - VoH);
}

float schlick(const in float f0, const in float f90, const in float VoH) {
    return f0 + (f90 - f0) * pow5(1.0 - VoH);
}

#endif

#ifndef FNC_POW5
#define FNC_POW5

float pow5(const in float v) {
    float v2 = v * v;
    return v2 * v2 * v;
}

vec2 pow5(const in vec2 v) {
    vec2 v2 = v * v;
    return v2 * v2 * v;
}

vec3 pow5(const in vec3 v) {
    vec3 v2 = v * v;
    return v2 * v2 * v;
}

vec4 pow5(const in vec4 v) {
    vec4 v2 = v * v;
    return v2 * v2 * v;
}

#endif
#ifndef EIGHTH_PI
#define EIGHTH_PI 0.39269908169
#endif
#ifndef QTR_PI
#define QTR_PI 0.78539816339
#endif
#ifndef HALF_PI
#define HALF_PI 1.5707963267948966192313216916398
#endif
#ifndef PI
#define PI 3.1415926535897932384626433832795
#endif
#ifndef TWO_PI
#define TWO_PI 6.2831853071795864769252867665590
#endif
#ifndef TAU
#define TAU 6.2831853071795864769252867665590
#endif
#ifndef INV_PI
#define INV_PI 0.31830988618379067153776752674503
#endif
#ifndef INV_SQRT_TAU
#define INV_SQRT_TAU 0.39894228040143267793994605993439  
#endif
#ifndef SQRT_HALF_PI
#define SQRT_HALF_PI 1.25331413732
#endif
#ifndef PHI
#define PHI 1.618033988749894848204586834
#endif
#ifndef EPSILON
#define EPSILON 0.0000001
#endif
#ifndef GOLDEN_RATIO
#define GOLDEN_RATIO 1.6180339887
#endif
#ifndef GOLDEN_RATIO_CONJUGATE 
#define GOLDEN_RATIO_CONJUGATE 0.61803398875
#endif
#ifndef GOLDEN_ANGLE 
#define GOLDEN_ANGLE 2.39996323
#endif
#ifndef DEG2RAD
#define DEG2RAD (PI / 180.0)
#endif
#ifndef RAD2DEG
#define RAD2DEG (180.0 / PI)
#endif
#if !defined(FNC_SATURATE) && !defined(saturate)
#define FNC_SATURATE
#define saturate(V) clamp(V, 0.0, 1.0)
#endif

#ifndef FNC_FRESNEL
#define FNC_FRESNEL

vec3 fresnel(const in vec3 f0, vec3 normal, vec3 view) {
   return schlick(f0, 1.0, dot(view, normal));
}

vec3 fresnel(const in vec3 f0, const in float NoV) {
#if defined(TARGET_MOBILE) || defined(PLATFORM_RPI)
    return schlick(f0, 1.0, NoV);
#else
    float f90 = saturate(dot(f0, vec3(50.0 * 0.33)));
    return schlick(f0, f90, NoV);
#endif
}

float fresnel(const in float f0, const in float NoV) {
    return schlick(f0, 1.0, NoV);
}

vec3 fresnel(vec3 f0, float NoV, float roughness) {
    return f0 + (max(vec3(1.0 - roughness), f0) - f0) * pow5(1.0 - NoV);
}

#endif
#ifndef SAMPLER_FNC
#if __VERSION__ >= 300
#define SAMPLER_FNC(TEX, UV) texture(TEX, UV)
#else
#define SAMPLER_FNC(TEX, UV) texture2D(TEX, UV)
#endif
#endif

#ifndef SAMPLER_TYPE
#define SAMPLER_TYPE sampler2D
#endif

#ifndef FNC_SAMPLEBICUBIC
#define FNC_SAMPLEBICUBIC

vec4 sampleBicubic(float v) {
    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;
    vec4 s = n * n * n;
    vec4 o;
    o.x = s.x;
    o.y = s.y - 4.0 * s.x;
    o.z = s.z - 4.0 * s.y + 6.0 * s.x;
    o.w = 6.0 - o.x - o.y - o.z;
    return o;
}

vec4 sampleBicubic(SAMPLER_TYPE tex, vec2 st, vec2 texResolution) {
    vec2 pixel = 1.0 / texResolution;
    st = st * texResolution - 0.5;

    vec2 fxy = fract(st);
    st -= fxy;

    vec4 xcubic = sampleBicubic(fxy.x);
    vec4 ycubic = sampleBicubic(fxy.y);

    vec4 c = st.xxyy + vec2 (-0.5, 1.5).xyxy;

    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);
    vec4 offset = c + vec4 (xcubic.yw, ycubic.yw) / s;

    offset *= pixel.xxyy;

    vec4 sample0 = SAMPLER_FNC(tex, offset.xz);
    vec4 sample1 = SAMPLER_FNC(tex, offset.yz);
    vec4 sample2 = SAMPLER_FNC(tex, offset.xw);
    vec4 sample3 = SAMPLER_FNC(tex, offset.yw);

    float sx = s.x / (s.x + s.y);
    float sy = s.z / (s.z + s.w);

    return mix( mix(sample3, sample2, sx), 
                mix(sample1, sample0, sx), 
                sy);
}

#endif
vec4 packedTexture2DLOD(sampler2D tex,vec2 uv,int level,vec2 originalPixelSize){\r
    float floatLevel=float(level);\r
    vec2 atlasSize;\r
    atlasSize.x=floor(originalPixelSize.x*1.5);\r
    atlasSize.y=originalPixelSize.y;\r
    
    float maxLevel=min(floor(log2(originalPixelSize.x)),floor(log2(originalPixelSize.y)));\r
    floatLevel=min(floatLevel,maxLevel);\r
    
    vec2 currentPixelDimensions=floor(originalPixelSize/pow(2.,floatLevel));\r
    vec2 pixelOffset=vec2(\r
        floatLevel>0.?originalPixelSize.x:0.,\r
        floatLevel>0.?currentPixelDimensions.y:0.\r
    );\r
    
    
    vec2 minPixel=pixelOffset;\r
    vec2 maxPixel=pixelOffset+currentPixelDimensions;\r
    vec2 samplePoint=mix(minPixel,maxPixel,uv);\r
    samplePoint/=atlasSize;\r
    vec2 halfPixelSize=1./(2.*atlasSize);\r
    samplePoint=min(samplePoint,maxPixel/atlasSize-halfPixelSize);\r
    samplePoint=max(samplePoint,minPixel/atlasSize+halfPixelSize);\r
    return sampleBicubic(tex,samplePoint,originalPixelSize);\r
}

vec4 packedTexture2DLOD(sampler2D tex,vec2 uv,float level,vec2 originalPixelSize){\r
    float ratio=mod(level,1.);\r
    int minLevel=int(floor(level));\r
    int maxLevel=int(ceil(level));\r
    vec4 minValue=packedTexture2DLOD(tex,uv,minLevel,originalPixelSize);\r
    vec4 maxValue=packedTexture2DLOD(tex,uv,maxLevel,originalPixelSize);\r
    return mix(minValue,maxValue,ratio);\r
}

uniform float iTime;
uniform vec2 iResolution;
uniform vec2 iMouse;

varying vec2 vUv_;
varying vec4 vWorldPosition;

uniform vec3 uColor;
uniform float uSpeed;
uniform mat4 uReflectMatrix;
uniform sampler2D uReflectTexture;
uniform float uReflectIntensity;
uniform vec2 uMipmapTextureSize;

void main(){
    vec2 p=vUv_;
    
    vec2 surfaceNormalUv=vWorldPosition.xz;
    surfaceNormalUv.x+=iTime*uSpeed;
    vec3 surfaceNormal=texture(normalMap,surfaceNormalUv).rgb*2.-1.;
    surfaceNormal=surfaceNormal.rbg;
    surfaceNormal=normalize(surfaceNormal);
    
    vec3 viewDir=vViewPosition;
    float d=length(viewDir);
    viewDir=normalize(viewDir);
    
    vec2 distortion=surfaceNormal.xz*(.001+1./d);
    
    vec4 reflectPoint=uReflectMatrix*vWorldPosition;
    reflectPoint=reflectPoint/reflectPoint.w;
    
    
    vec2 roughnessUv=vWorldPosition.xz;
    roughnessUv.x+=iTime*uSpeed;
    float roughnessValue=texture(roughnessMap,roughnessUv).r;
    roughnessValue=roughnessValue*(1.7-.7*roughnessValue);
    roughnessValue*=4.;
    float level=roughnessValue;
    vec2 finalUv=reflectPoint.xy+distortion;
    vec3 reflectionSample=packedTexture2DLOD(uReflectTexture,finalUv,level,uMipmapTextureSize).rgb;
    reflectionSample*=uReflectIntensity;
    
    vec3 col=uColor;
    
    col*=3.;
    vec3 fres=fresnel(vec3(0.),vNormal,viewDir);
    col=mix(col,reflectionSample,fres);
    
    csm_DiffuseColor=vec4(col,1.);
}`;class ZE extends xt{constructor(t,i,n={}){super(t);N(this,"parent");N(this,"ignoreObjects");N(this,"_camera");N(this,"reflectPlane");N(this,"_reflectMatrix");N(this,"_renderTexture");N(this,"mipmapper");N(this,"mirrorFBO");N(this,"mipmapFBO");this.parent=i;let{resolution:s=256,ignoreObjects:r=[]}=n;this.ignoreObjects=r,this._camera=new rn,this.reflectPlane=new ih,this._reflectMatrix=new He,this._renderTexture=new CA(this.base,{width:s,height:s,options:{type:gt}});const a=new Qg;this.mipmapper=a;const c=this._renderTexture.rt;this.mirrorFBO=c;const h=new CA(this.base);this.mipmapFBO=h}update(){this.beforeRender(),this.mipmapper.update(this.mirrorFBO.texture,this.mipmapFBO.rt,this.base.renderer)}beforeRender(){this.reflectPlane.set(new xe(0,1,0),0),this.reflectPlane.applyMatrix4(this.parent.matrixWorld),this._camera.copy(this.base.camera);const t=new xe(0,0,1).clone().negate(),i=this.base.camera.getWorldPosition(new xe);t.reflect(this.reflectPlane.normal);const n=new xe;this.reflectPlane.projectPoint(i,n);const s=n.clone();s.sub(i),s.add(n),this._camera.position.copy(s);const r=new xe(0,0,-1);r.applyQuaternion(this.base.camera.getWorldQuaternion(new _n)),r.add(i);const a=new xe;this.parent.getWorldPosition(a),a.sub(r),a.reflect(this.reflectPlane.normal).negate(),a.add(this.parent.getWorldPosition(new xe)),this._camera.up.set(0,1,0),this._camera.applyQuaternion(this.base.camera.getWorldQuaternion(new _n)),this._camera.up.reflect(this.reflectPlane.normal),this._camera.lookAt(a),this._camera.updateMatrixWorld();const c=new He;c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),c.multiply(this._camera.projectionMatrix),c.multiply(this._camera.matrixWorldInverse),this._reflectMatrix.copy(c),this.reflectPlane.applyMatrix4(this._camera.matrixWorldInverse);const h=new Yt(this.reflectPlane.normal.x,this.reflectPlane.normal.y,this.reflectPlane.normal.z,this.reflectPlane.constant),d=this._camera.projectionMatrix,l=new Yt;l.x=(Math.sign(h.x)+d.elements[8])/d.elements[0],l.y=(Math.sign(h.y)+d.elements[9])/d.elements[5],l.z=-1,l.w=(1+d.elements[10])/d.elements[14],h.multiplyScalar(2/h.dot(l)),d.elements[2]=h.x,d.elements[6]=h.y,d.elements[10]=h.z+1,d.elements[14]=h.w;const A=this.base.renderer.getRenderTarget();this.base.renderer.setRenderTarget(this._renderTexture.rt),this.base.renderer.state.buffers.depth.setMask(!0),this.base.renderer.autoClear===!1&&this.base.renderer.clear(),this.ignoreObjects.forEach(u=>u.visible=!1),this.base.renderer.render(this.base.scene,this._camera),this.ignoreObjects.forEach(u=>u.visible=!0),this.base.renderer.setRenderTarget(A)}}class $E extends xt{constructor(t){super(t);N(this,"model");N(this,"uj");N(this,"lightMat");N(this,"ReflecFloor");N(this,"floorMat");N(this,"customFloorMat");const i=this.base.am.items.sm_startroom;this.model=i;const n=Do(i.scene),s=n[1],r=s.material;r.emissive=new Te(0),r.emissiveIntensity=0,r.toneMapped=!1,r.transparent=!0,r.alphaTest=.1,this.lightMat=r;const a=n[2];this.ReflecFloor=a;const c=a.material;c.aoMap=this.base.am.items.ut_startroom_ao,c.lightMap=this.base.am.items.ut_startroom_light,c.normalMap=this.base.am.items.ut_floor_normal,c.roughnessMap=this.base.am.items.ut_floor_roughness,c.envMapIntensity=0,this.floorMat=c.clone();const h=new du(this.base);this.uj=h;const d=new sm({baseMaterial:c,vertexShader:WE,fragmentShader:jE,uniforms:{...h.shadertoyUniforms,uColor:{value:new Te(0)},uSpeed:{value:this.base.params.speed},uReflectMatrix:{value:new He},uReflectTexture:{value:null},uReflectIntensity:{value:0},uMipmapTextureSize:{value:new Ce(window.innerWidth,window.innerHeight)}}});this.customFloorMat=d,a.material=this.customFloorMat,this.base.resizer.on("resize",()=>{this.customFloorMat.uniforms.uMipmapTextureSize.value=new Ce(window.innerWidth,window.innerHeight)});const l=new ZE(this.base,a,{resolution:1024,ignoreObjects:[s,a]});d.uniforms.uReflectMatrix.value=l._reflectMatrix,d.uniforms.uReflectTexture.value=l.mipmapFBO.rt.texture,this.base.debug.addFolder("StartRoom").add(this.base.params,"startRoomReflector").name("reflector").onChange(u=>{u?this.ReflecFloor.material=this.customFloorMat:this.ReflecFloor.material=this.floorMat})}addExisting(){this.container.add(this.model.scene)}update(){this.customFloorMat.uniforms.uSpeed.value=this.base.params.speed,this.uj.injectShadertoyUniforms(this.customFloorMat.uniforms)}}class eB extends xt{constructor(t){super(t);N(this,"model");N(this,"modelParts");N(this,"bodyMat");N(this,"wheelModel");const i=this.base.am.items.sm_car;this.model=i;const n=Do(i.scene);this.modelParts=n,this.handleModel();const s=this.base.debug.addFolder("Car");s.add(this.base.params,"carBodyEnvIntensity",0,1,.01).name("bodyEnvIntensity").onChange(r=>{this.setBodyEnvIntensity(r)}),s.addColor(this.base.params,"carBodyColor").name("bodyColor").onChange(r=>{this.bodyMat.color=new Te(r)})}addExisting(){this.container.add(this.model.scene)}update(){var t;(t=this.wheelModel)==null||t.children.forEach(i=>{i.rotateZ(-this.base.params.speed*.03)})}handleModel(){const i=this.modelParts[2].material;this.base.params.isFurina?(i.color=new Te(16777215),i.map=this.base.am.items.decal):i.color=new Te(2545385),this.bodyMat=i,this.modelParts.forEach(s=>{if(s instanceof Ei){const r=s.material;r.aoMap=this.base.am.items.ut_car_body_ao}});const n=this.modelParts[35];this.wheelModel=n}setBodyEnvIntensity(t){this.bodyMat&&(this.bodyMat.envMapIntensity=t)}}var tB=`uniform float iTime;
uniform vec3 iResolution;
uniform vec4 iMouse;

varying vec2 vUv;

void main(){
    vec3 p=position;
    gl_Position=projectionMatrix*modelViewMatrix*vec4(p,1.);
    
    vUv=uv;
}`,iB=`vec2 hash(vec2 p)
{\r
    p=vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3)));\r
    return-1.+2.*fract(sin(p)*43758.5453123);\r
}

float noise(in vec2 p)\r
{\r
    const float K1=.366025404;
    const float K2=.211324865;
    \r
    vec2 i=floor(p+(p.x+p.y)*K1);\r
    vec2 a=p-i+(i.x+i.y)*K2;\r
    float m=step(a.y,a.x);\r
    vec2 o=vec2(m,1.-m);\r
    vec2 b=a-o+K2;\r
    vec2 c=a-1.+2.*K2;\r
    vec3 h=max(.5-vec3(dot(a,a),dot(b,b),dot(c,c)),0.);\r
    vec3 n=h*h*h*h*vec3(dot(a,hash(i+0.)),dot(b,hash(i+o)),dot(c,hash(i+1.)));\r
    return dot(n,vec3(70.));\r
}
#ifndef RANDOM_SCALE
#ifdef RANDOM_HIGHER_RANGE
#define RANDOM_SCALE vec4(.1031, .1030, .0973, .1099)
#else
#define RANDOM_SCALE vec4(443.897, 441.423, .0973, .1099)
#endif
#endif

#ifndef FNC_RANDOM
#define FNC_RANDOM
float random(in float x) {
#ifdef RANDOM_SINLESS
    x = fract(x * RANDOM_SCALE.x);
    x *= x + 33.33;
    x *= x + x;
    return fract(x);
#else
    return fract(sin(x) * 43758.5453);
#endif
}

float random(in vec2 st) {
#ifdef RANDOM_SINLESS
    vec3 p3  = fract(vec3(st.xyx) * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yzx + 33.33);
    return fract((p3.x + p3.y) * p3.z);
#else
    return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453);
#endif
}

float random(in vec3 pos) {
#ifdef RANDOM_SINLESS
    pos  = fract(pos * RANDOM_SCALE.xyz);
    pos += dot(pos, pos.zyx + 31.32);
    return fract((pos.x + pos.y) * pos.z);
#else
    return fract(sin(dot(pos.xyz, vec3(70.9898, 78.233, 32.4355))) * 43758.5453123);
#endif
}

float random(in vec4 pos) {
#ifdef RANDOM_SINLESS
    pos = fract(pos * RANDOM_SCALE);
    pos += dot(pos, pos.wzxy + 33.33);
    return fract((pos.x + pos.y) * (pos.z + pos.w));
#else
    float dot_product = dot(pos, vec4(12.9898,78.233,45.164,94.673));
    return fract(sin(dot_product) * 43758.5453);
#endif
}

vec2 random2(float p) {
    vec3 p3 = fract(vec3(p) * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.xx + p3.yz) * p3.zy);
}

vec2 random2(vec2 p) {
    vec3 p3 = fract(p.xyx * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.xx + p3.yz) * p3.zy);
}

vec2 random2(vec3 p3) {
    p3 = fract(p3 * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.xx + p3.yz) * p3.zy);
}

vec3 random3(float p) {
    vec3 p3 = fract(vec3(p) * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.xxy + p3.yzz) * p3.zyx); 
}

vec3 random3(vec2 p) {
    vec3 p3 = fract(vec3(p.xyx) * RANDOM_SCALE.xyz);
    p3 += dot(p3, p3.yxz + 19.19);
    return fract((p3.xxy + p3.yzz) * p3.zyx);
}

vec3 random3(vec3 p) {
    p = fract(p * RANDOM_SCALE.xyz);
    p += dot(p, p.yxz + 19.19);
    return fract((p.xxy + p.yzz) * p.zyx);
}

vec4 random4(float p) {
    vec4 p4 = fract(p * RANDOM_SCALE);
    p4 += dot(p4, p4.wzxy + 19.19);
    return fract((p4.xxyz + p4.yzzw) * p4.zywx);   
}

vec4 random4(vec2 p) {
    vec4 p4 = fract(p.xyxy * RANDOM_SCALE);
    p4 += dot(p4, p4.wzxy + 19.19);
    return fract((p4.xxyz + p4.yzzw) * p4.zywx);
}

vec4 random4(vec3 p) {
    vec4 p4 = fract(p.xyzx * RANDOM_SCALE);
    p4 += dot(p4, p4.wzxy + 19.19);
    return fract((p4.xxyz + p4.yzzw) * p4.zywx);
}

vec4 random4(vec4 p4) {
    p4 = fract(p4  * RANDOM_SCALE);
    p4 += dot(p4, p4.wzxy + 19.19);
    return fract((p4.xxyz + p4.yzzw) * p4.zywx);
}
#endif
#if !defined(FNC_SATURATE) && !defined(saturate)
#define FNC_SATURATE
#define saturate(V) clamp(V, 0.0, 1.0)
#endif
#ifndef FNC_MAP
#define FNC_MAP
float map(float v, float iMin, float iMax ) { return (v-iMin)/(iMax-iMin); }
vec2 map(vec2 v, vec2 iMin, vec2 iMax ) { return (v-iMin)/(iMax-iMin); }
vec3 map(vec3 v, vec3 iMin, vec3 iMax ) { return (v-iMin)/(iMax-iMin); }
vec4 map(vec4 v, vec4 iMin, vec4 iMax ) { return (v-iMin)/(iMax-iMin); }

float map(in float v, in float iMin, in float iMax, in float oMin, in float oMax) { return oMin + (oMax - oMin) * (v - iMin) / (iMax - iMin); }
vec2 map(in vec2 v, in vec2 iMin, in vec2 iMax, in vec2 oMin, in vec2 oMax) { return oMin + (oMax - oMin) * (v - iMin) / (iMax - iMin); }
vec3 map(in vec3 v, in vec3 iMin, in vec3 iMax, in vec3 oMin, in vec3 oMax) { return oMin + (oMax - oMin) * (v - iMin) / (iMax - iMin); }
vec4 map(in vec4 v, in vec4 iMin, in vec4 iMax, in vec4 oMin, in vec4 oMax) { return oMin + (oMax - oMin) * (v - iMin) / (iMax - iMin); }
#endif
#ifndef EIGHTH_PI
#define EIGHTH_PI 0.39269908169
#endif
#ifndef QTR_PI
#define QTR_PI 0.78539816339
#endif
#ifndef HALF_PI
#define HALF_PI 1.5707963267948966192313216916398
#endif
#ifndef PI
#define PI 3.1415926535897932384626433832795
#endif
#ifndef TWO_PI
#define TWO_PI 6.2831853071795864769252867665590
#endif
#ifndef TAU
#define TAU 6.2831853071795864769252867665590
#endif
#ifndef INV_PI
#define INV_PI 0.31830988618379067153776752674503
#endif
#ifndef INV_SQRT_TAU
#define INV_SQRT_TAU 0.39894228040143267793994605993439  
#endif
#ifndef SQRT_HALF_PI
#define SQRT_HALF_PI 1.25331413732
#endif
#ifndef PHI
#define PHI 1.618033988749894848204586834
#endif
#ifndef EPSILON
#define EPSILON 0.0000001
#endif
#ifndef GOLDEN_RATIO
#define GOLDEN_RATIO 1.6180339887
#endif
#ifndef GOLDEN_RATIO_CONJUGATE 
#define GOLDEN_RATIO_CONJUGATE 0.61803398875
#endif
#ifndef GOLDEN_ANGLE 
#define GOLDEN_ANGLE 2.39996323
#endif
#ifndef DEG2RAD
#define DEG2RAD (PI / 180.0)
#endif
#ifndef RAD2DEG
#define RAD2DEG (180.0 / PI)
#endif

#ifndef FNC_PALETTE
#define FNC_PALETTE
vec3 palette (in float t, in vec3 a, in vec3 b, in vec3 c, in vec3 d) { return a + b * cos(TAU * ( c * t + d )); }
vec4 palette (in float t, in vec4 a, in vec4 b, in vec4 c, in vec4 d) { return a + b * cos(TAU * ( c * t + d )); }
#endif

uniform float iTime;
uniform vec3 iResolution;
uniform vec4 iMouse;

varying vec2 vUv;

uniform float uSpeed;
uniform float uOpacity;

vec3 pos2col(vec2 i){
    i+=vec2(9.,0.);
    
    float r=random(i+vec2(12.,2.));
    float g=random(i+vec2(7.,5.));
    float b=random(i);
    
    vec3 col=vec3(r,g,b);
    return col;
}

vec3 colorNoise(vec2 uv){
    vec2 size=vec2(1.);
    vec2 pc=uv*size;
    vec2 base=floor(pc);
    
    vec3 v1=pos2col((base+vec2(0.,0.))/size);
    vec3 v2=pos2col((base+vec2(1.,0.))/size);
    vec3 v3=pos2col((base+vec2(0.,1.))/size);
    vec3 v4=pos2col((base+vec2(1.,1.))/size);
    
    vec2 f=fract(pc);
    
    f=smoothstep(0.,1.,f);
    
    vec3 px1=mix(v1,v2,f.x);
    vec3 px2=mix(v3,v4,f.x);
    vec3 v=mix(px1,px2,f.y);
    return v;
}

void main(){
    vec2 uv=vUv;
    
    vec3 col=vec3(1.);
    
    float mask=1.;
    
    vec2 noiseUv=uv;
    noiseUv.x+=-iTime*.5;
    float noiseValue=noise(noiseUv*vec2(3.,100.));
    mask=noiseValue;
    mask=map(mask,-1.,1.,0.,1.);
    mask=pow(saturate(mask-.1),11.);
    mask=smoothstep(0.,.04,mask);
    
    
    col=colorNoise(noiseUv*vec2(10.,100.));
    col*=vec3(1.5,1.,400.);
    
    mask*=smoothstep(.02,.5,uv.x)*smoothstep(.02,.5,1.-uv.x);
    mask*=smoothstep(.01,.1,uv.y)*smoothstep(.01,.1,1.-uv.y);
    mask*=smoothstep(1.,10.,uSpeed);
    
    gl_FragColor=vec4(col,mask*uOpacity);
}`;class nB extends xt{constructor(t){super(t);N(this,"model");N(this,"uj");N(this,"material");this.model=this.base.am.items.sm_speedup;const i=Do(this.model.scene);this.uj=new du(this.base),this.material=new Qt({vertexShader:tB,fragmentShader:iB,transparent:!0,depthWrite:!1,uniforms:{...this.uj.shadertoyUniforms,uSpeed:{value:this.base.params.speed},uOpacity:{value:this.base.params.speedUpOpacity}}});const n=i[1];n.material=this.material}addExisting(){this.container.add(this.model.scene)}update(){this.material.uniforms.uSpeed.value=this.base.params.speed,this.uj.injectShadertoyUniforms(this.material.uniforms)}}const sB=N_(),La=({octave:o=3,frequency:e=2,amplitude:t=.5,lacunarity:i=2,persistance:n=.5}={})=>{let s=0;for(let r=0;r<o;r++){const a=sB(e,e);s+=a*t,e*=i,t*=n}return s};class rB extends xt{constructor(t,i={}){super(t);N(this,"intensity");N(this,"tweenedPosOffset");this.intensity=i.intensity??1,this.tweenedPosOffset=new xe(0,0,0),this.base.debug.addFolder("CameraShake").add(this.base.params,"cameraShakeIntensity",0,2,.01).name("intensity").onChange(s=>{this.setIntensity(s)})}update(){const t=this.base.clock.elapsedTime,i=new xe(La({frequency:t*.5+Mt.randFloat(-1e4,0),amplitude:2}),La({frequency:t*.5+Mt.randFloat(-1e4,0),amplitude:2}),La({frequency:t*.5+Mt.randFloat(-1e4,0),amplitude:2})).multiplyScalar(.1*this.intensity);pi.to(this.tweenedPosOffset,{x:i.x,y:i.y,z:i.z,duration:1.2}),this.base.camera.position.add(this.tweenedPosOffset)}setIntensity(t){this.intensity=Math.max(0,t)}}class oB extends xt{constructor(t){super(t);N(this,"model",new qn);N(this,"realModel");N(this,"modelParts");N(this,"mixer");N(this,"actions",{});N(this,"currentAction",null);N(this,"isPaused",!0);this.realModel=this.base.am.items.driving,this.model.add(this.realModel),this.modelParts=Do(this.realModel),this.modelParts.forEach(n=>{if(n instanceof Ei&&n.material.isMeshPhongMaterial){const s=new gs({transparent:!0,map:n.material.map||null,color:new Te(0)});n.material=s}}),this.model.scale.setScalar(.074),this.model.rotation.y=Math.PI*.5,this.model.position.set(.225,.15,-.4),this.mixer=new bf(this.model),this.addAction("driving","driving"),this.playAction("driving"),this.mixer.update(1),this.base.debug.addFolder("Furina").add(this.base.params,"isFurina").name("furina")}addExisting(){this.container.add(this.model)}update(){this.isPaused||this.mixer.update(this.base.clock.deltaTime)}addAction(t,i){var r;const n=((r=this.base.am)==null?void 0:r.items[t]).animations[0],s=this.mixer.clipAction(n);this.actions[i]=s}playAction(t){this.currentAction&&this.currentAction.fadeOut(.5);const i=this.actions[t];return i.weight=1,i.reset().fadeIn(.5).play(),this.currentAction=i,i}setColor(t){this.modelParts.forEach(i=>{i instanceof Ei&&i.material.color.set(t)})}pause(){this.isPaused=!0}drive(){this.isPaused=!1}}const kA=rh(),aB=[{name:"bgm",type:"audio",path:"su7/audio/bgm.mp3"},{name:"sm_car",type:"gltfModel",path:"su7/mesh/sm_car.gltf"},{name:"sm_startroom",type:"gltfModel",path:"su7/mesh/sm_startroom.raw.gltf"},{name:"sm_speedup",type:"gltfModel",path:"su7/mesh/sm_speedup.gltf"},{name:"ut_car_body_ao",type:"texture",path:"su7/texture/t_car_body_AO.raw.jpg"},{name:"ut_startroom_ao",type:"texture",path:"su7/texture/t_startroom_ao.raw.jpg"},{name:"ut_startroom_light",type:"texture",path:"su7/texture/t_startroom_light.raw.jpg"},{name:"ut_floor_normal",type:"texture",path:"su7/texture/t_floor_normal.webp"},{name:"ut_floor_roughness",type:"texture",path:"su7/texture/t_floor_roughness.webp"},{name:"ut_env_night",type:"hdrTexture",path:"su7/texture/t_env_night.hdr"},{name:"ut_env_light",type:"hdrTexture",path:"su7/texture/t_env_light.hdr"},{name:"driving",type:"fbxModel",path:"su7/mesh/Driving.fbx"},{name:"decal",type:"texture",path:"su7/texture/decal.png"}];/**
 * postprocessing v6.37.4 build Sat Jun 07 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var Pa=1/1e3,lB=1e3,cB=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(o){typeof document<"u"&&document.hidden!==void 0&&(o?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=o)}get delta(){return this._delta*Pa}get fixedDelta(){return this._fixedDelta*Pa}set fixedDelta(o){this._fixedDelta=o*lB}get elapsed(){return this._elapsed*Pa}update(o){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(o!==void 0?o:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(o){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},AB=(()=>{const o=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new sn;return t.setAttribute("position",new Yn(o,3)),t.setAttribute("uv",new Yn(e,2)),t})(),bi=class Cl{static get fullscreenGeometry(){return AB}constructor(e="Pass",t=new fo,i=new Ff){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ei(Cl.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new fo),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=So){}render(e,t,i,n,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Bi||t instanceof xn||t instanceof ts||t instanceof Cl)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},hB=class extends bi{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(o,e,t,i,n){const s=o.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},uB=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,gd="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",md=class extends Qt{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Xe(null),opacity:new Xe(1)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:uB,vertexShader:gd})}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}getOpacity(o){return this.uniforms.opacity.value}setOpacity(o){this.uniforms.opacity.value=o}},dB=class extends bi{constructor(o,e=!0){super("CopyPass"),this.fullscreenMaterial=new md,this.needsSwap=!1,this.renderTarget=o,o===void 0&&(this.renderTarget=new Bi(1,1,{minFilter:Pt,magFilter:Pt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(o){this.autoResize=o}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(o){this.autoResize=o}render(o,e,t,i,n){this.fullscreenMaterial.inputBuffer=e.texture,o.setRenderTarget(this.renderToScreen?null:this.renderTarget),o.render(this.scene,this.camera)}setSize(o,e){this.autoResize&&this.renderTarget.setSize(o,e)}initialize(o,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==gt?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":o!==null&&o.outputColorSpace===St&&(this.renderTarget.texture.colorSpace=St))}},NA=new Te,vd=class extends bi{constructor(o=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=o,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(o,e,t){this.color=o,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(o){this.overrideClearColor=o}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(o){this.overrideClearAlpha=o}render(o,e,t,i,n){const s=this.overrideClearColor,r=this.overrideClearAlpha,a=o.getClearAlpha(),c=s!==null,h=r>=0;c?(o.getClearColor(NA),o.setClearColor(s,h?r:a)):h&&o.setClearAlpha(r),o.setRenderTarget(this.renderToScreen?null:e),o.clear(this.color,this.depth,this.stencil),c?o.setClearColor(NA,a):h&&o.setClearAlpha(a)}},fB=class extends bi{constructor(o,e){super("MaskPass",o,e),this.needsSwap=!1,this.clearPass=new vd(!1,!1,!0),this.inverse=!1}set mainScene(o){this.scene=o}set mainCamera(o){this.camera=o}get inverted(){return this.inverse}set inverted(o){this.inverse=o}get clear(){return this.clearPass.enabled}set clear(o){this.clearPass.enabled=o}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(o){this.inverted=o}render(o,e,t,i,n){const s=o.getContext(),r=o.state.buffers,a=this.scene,c=this.camera,h=this.clearPass,d=this.inverted?0:1,l=1-d;r.color.setMask(!1),r.depth.setMask(!1),r.color.setLocked(!0),r.depth.setLocked(!0),r.stencil.setTest(!0),r.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),r.stencil.setFunc(s.ALWAYS,d,4294967295),r.stencil.setClear(l),r.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(o,null):(h.render(o,e),h.render(o,t))),this.renderToScreen?(o.setRenderTarget(null),o.render(a,c)):(o.setRenderTarget(e),o.render(a,c),o.setRenderTarget(t),o.render(a,c)),r.color.setLocked(!1),r.depth.setLocked(!1),r.stencil.setLocked(!1),r.stencil.setFunc(s.EQUAL,1,4294967295),r.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),r.stencil.setLocked(!0)}},pB=class{constructor(o=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:i=0,frameBufferType:n}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,n,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new dB,this.depthTexture=null,this.passes=[],this.timer=new cB,this.autoRenderToScreen=!0,this.setRenderer(o)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(o){const e=this.inputBuffer,t=this.multisampling;t>0&&o>0?(this.inputBuffer.samples=o,this.outputBuffer.samples=o,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==o&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,o),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(o){if(this.renderer=o,o!==null){const e=o.getSize(new Ce),t=o.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===gt&&o.outputColorSpace===St&&(this.inputBuffer.texture.colorSpace=St,this.outputBuffer.texture.colorSpace=St,this.inputBuffer.dispose(),this.outputBuffer.dispose()),o.autoClear=!1,this.setSize(e.width,e.height);for(const n of this.passes)n.initialize(o,t,i)}}replaceRenderer(o,e=!0){const t=this.renderer,i=t.domElement.parentNode;return this.setRenderer(o),e&&i!==null&&(i.removeChild(t.domElement),i.appendChild(o.domElement)),t}createDepthTexture(){const o=this.depthTexture=new nh;return this.inputBuffer.depthTexture=o,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(o.format=Df,o.type=Rf):o.type=Qf,o}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const o of this.passes)o.setDepthTexture(null)}}createBuffer(o,e,t,i){const n=this.renderer,s=n===null?new Ce:n.getDrawingBufferSize(new Ce),r={minFilter:Pt,magFilter:Pt,stencilBuffer:e,depthBuffer:o,type:t},a=new Bi(s.width,s.height,r);return i>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=i),t===gt&&n!==null&&n.outputColorSpace===St&&(a.texture.colorSpace=St),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(o){for(const e of this.passes)e.mainScene=o}setMainCamera(o){for(const e of this.passes)e.mainCamera=o}addPass(o,e){const t=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new Ce),s=i.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;if(o.setRenderer(i),o.setSize(n.width,n.height),o.initialize(i,s,r),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),o.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,o):t.push(o),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),o.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const a=this.createDepthTexture();for(o of t)o.setDepthTexture(a)}else o.setDepthTexture(this.depthTexture)}removePass(o){const e=this.passes,t=e.indexOf(o);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const s=(a,c)=>a||c.needsDepthTexture;e.reduce(s,!1)||(o.getDepthTexture()===this.depthTexture&&o.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(o.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const o=this.passes;this.deleteDepthTexture(),o.length>0&&(this.autoRenderToScreen&&(o[o.length-1].renderToScreen=!1),this.passes=[])}render(o){const e=this.renderer,t=this.copyPass;let i=this.inputBuffer,n=this.outputBuffer,s=!1,r,a,c;o===void 0&&(this.timer.update(),o=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(e,i,n,o,s),h.needsSwap&&(s&&(t.renderToScreen=h.renderToScreen,r=e.getContext(),a=e.state.buffers.stencil,a.setFunc(r.NOTEQUAL,1,4294967295),t.render(e,i,n,o,s),a.setFunc(r.EQUAL,1,4294967295)),c=i,i=n,n=c),h instanceof fB?s=!0:h instanceof hB&&(s=!1))}setSize(o,e,t){const i=this.renderer,n=i.getSize(new Ce);(o===void 0||e===void 0)&&(o=n.width,e=n.height),(n.width!==o||n.height!==e)&&i.setSize(o,e,t);const s=i.getDrawingBufferSize(new Ce);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const r of this.passes)r.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const o of this.passes)o.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),bi.fullscreenGeometry.dispose()}},$n={NONE:0,DEPTH:1,CONVOLUTION:2},Ge={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},gB=class{constructor(){this.shaderParts=new Map([[Ge.FRAGMENT_HEAD,null],[Ge.FRAGMENT_MAIN_UV,null],[Ge.FRAGMENT_MAIN_IMAGE,null],[Ge.VERTEX_HEAD,null],[Ge.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=$n.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Hn}},Ga=!1,HA=class{constructor(o=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(o),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case ar:t=this.materialsFlatShadedDoubleSide;break;case Nr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case ar:t=this.materialsDoubleSide;break;case Nr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(o){if(!(o instanceof Qt))return o.clone();const e=o.uniforms,t=new Map;for(const n in e){const s=e[n].value;s.isRenderTargetTexture&&(e[n].value=null,t.set(n,s))}const i=o.clone();for(const n of t)e[n[0]].value=n[1],i.uniforms[n[0]].value=n[1];return i}setMaterial(o){if(this.disposeMaterials(),this.material=o,o!==null){const e=this.materials=[this.cloneMaterial(o),this.cloneMaterial(o),this.cloneMaterial(o)];for(const t of e)t.uniforms=Object.assign({},o.uniforms),t.side=ZA;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},o.uniforms),i.side=Nr,i}),this.materialsDoubleSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},o.uniforms),i.side=ar,i}),this.materialsFlatShaded=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},o.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},o.uniforms),i.flatShading=!0,i.side=Nr,i}),this.materialsFlatShadedDoubleSide=e.map(t=>{const i=this.cloneMaterial(t);return i.uniforms=Object.assign({},o.uniforms),i.flatShading=!0,i.side=ar,i})}}render(o,e,t){const i=o.shadowMap.enabled;if(o.shadowMap.enabled=!1,Ga){const n=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),o.render(e,t);for(const s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{const n=e.overrideMaterial;e.overrideMaterial=this.material,o.render(e,t),e.overrideMaterial=n}o.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const o=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of o)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Ga}static set workaroundEnabled(o){Ga=o}},gn=-1,Hi=class extends Il{constructor(o,e=gn,t=gn,i=1){super(),this.resizable=o,this.baseSize=new Ce(1,1),this.preferredSize=new Ce(e,t),this.target=this.preferredSize,this.s=i,this.effectiveSize=new Ce,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const o=this.baseSize,e=this.preferredSize,t=this.effectiveSize,i=this.scale;e.width!==gn?t.width=e.width:e.height!==gn?t.width=Math.round(e.height*(o.width/Math.max(o.height,1))):t.width=Math.round(o.width*i),e.height!==gn?t.height=e.height:e.width!==gn?t.height=Math.round(e.width/Math.max(o.width/Math.max(o.height,1),1)):t.height=Math.round(o.height*i)}get width(){return this.effectiveSize.width}set width(o){this.preferredWidth=o}get height(){return this.effectiveSize.height}set height(o){this.preferredHeight=o}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(o){this.s!==o&&(this.s=o,this.preferredSize.setScalar(gn),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(o){this.scale=o}get baseWidth(){return this.baseSize.width}set baseWidth(o){this.baseSize.width!==o&&(this.baseSize.width=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(o){this.baseWidth=o}get baseHeight(){return this.baseSize.height}set baseHeight(o){this.baseSize.height!==o&&(this.baseSize.height=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(o){this.baseHeight=o}setBaseSize(o,e){(this.baseSize.width!==o||this.baseSize.height!==e)&&(this.baseSize.set(o,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(o){this.preferredSize.width!==o&&(this.preferredSize.width=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(o){this.preferredWidth=o}get preferredHeight(){return this.preferredSize.height}set preferredHeight(o){this.preferredSize.height!==o&&(this.preferredSize.height=o,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(o){this.preferredHeight=o}setPreferredSize(o,e){(this.preferredSize.width!==o||this.preferredSize.height!==e)&&(this.preferredSize.set(o,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(o){this.s=o.scale,this.baseSize.set(o.baseWidth,o.baseHeight),this.preferredSize.set(o.preferredWidth,o.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return gn}},De={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},mB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",vB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",_B="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",CB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",EB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",BB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",yB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",IB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",wB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",xB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",MB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",SB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",TB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",bB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",DB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",RB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",QB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",FB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",OB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",LB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",PB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",GB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",UB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",kB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",NB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",HB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",zB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",JB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",VB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",KB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",YB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",qB="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",XB=new Map([[De.ADD,mB],[De.ALPHA,vB],[De.AVERAGE,_B],[De.COLOR,CB],[De.COLOR_BURN,EB],[De.COLOR_DODGE,BB],[De.DARKEN,yB],[De.DIFFERENCE,IB],[De.DIVIDE,wB],[De.DST,null],[De.EXCLUSION,xB],[De.HARD_LIGHT,MB],[De.HARD_MIX,SB],[De.HUE,TB],[De.INVERT,bB],[De.INVERT_RGB,DB],[De.LIGHTEN,RB],[De.LINEAR_BURN,QB],[De.LINEAR_DODGE,FB],[De.LINEAR_LIGHT,OB],[De.LUMINOSITY,LB],[De.MULTIPLY,PB],[De.NEGATION,GB],[De.NORMAL,UB],[De.OVERLAY,kB],[De.PIN_LIGHT,NB],[De.REFLECT,HB],[De.SATURATION,zB],[De.SCREEN,JB],[De.SOFT_LIGHT,VB],[De.SRC,KB],[De.SUBTRACT,YB],[De.VIVID_LIGHT,qB]]),WB=class extends Il{constructor(o,e=1){super(),this._blendFunction=o,this.opacity=new Xe(e)}getOpacity(){return this.opacity.value}setOpacity(o){this.opacity.value=o}get blendFunction(){return this._blendFunction}set blendFunction(o){this._blendFunction=o,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(o){this.blendFunction=o}getShaderCode(){return XB.get(this.blendFunction)}},jB=class extends Il{constructor(o,e,{attributes:t=$n.NONE,blendFunction:i=De.NORMAL,defines:n=new Map,uniforms:s=new Map,extensions:r=null,vertexShader:a=null}={}){super(),this.name=o,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=a,this.defines=n,this.uniforms=s,this.extensions=r,this.blendMode=new WB(i),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=Hn,this._outputColorSpace=sh}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(o){this._inputColorSpace=o,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(o){this._outputColorSpace=o,this.setChanged()}set mainScene(o){}set mainCamera(o){}getName(){return this.name}setRenderer(o){this.renderer=o}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(o){this.attributes=o,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(o){this.fragmentShader=o,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(o){this.vertexShader=o,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(o,e=So){}update(o,e,t){}setSize(o,e){}initialize(o,e,t){}dispose(){for(const o of Object.keys(this)){const e=this[o];(e instanceof Bi||e instanceof xn||e instanceof ts||e instanceof bi)&&this[o].dispose()}}},ec={MEDIUM:2,LARGE:3},ZB=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,$B="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",ey=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],ty=class extends Qt{constructor(o=new Yt){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Xe(null),texelSize:new Xe(new Yt),scale:new Xe(1),kernel:new Xe(0)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ZB,vertexShader:$B}),this.setTexelSize(o.x,o.y),this.kernelSize=ec.MEDIUM}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.inputBuffer=o}get kernelSequence(){return ey[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(o){this.uniforms.scale.value=o}getScale(){return this.uniforms.scale.value}setScale(o){this.uniforms.scale.value=o}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(o){this.uniforms.kernel.value=o}setKernel(o){this.kernel=o}setTexelSize(o,e){this.uniforms.texelSize.value.set(o,e,o*.5,e*.5)}setSize(o,e){const t=1/o,i=1/e;this.uniforms.texelSize.value.set(t,i,t*.5,i*.5)}},iy=class extends bi{constructor({kernelSize:o=ec.MEDIUM,resolutionScale:e=.5,width:t=Hi.AUTO_SIZE,height:i=Hi.AUTO_SIZE,resolutionX:n=t,resolutionY:s=i}={}){super("KawaseBlurPass"),this.renderTargetA=new Bi(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const r=this.resolution=new Hi(this,n,s,e);r.addEventListener("change",a=>this.setSize(r.baseWidth,r.baseHeight)),this._blurMaterial=new ty,this._blurMaterial.kernelSize=o,this.copyMaterial=new md}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(o){this._blurMaterial=o}get dithering(){return this.copyMaterial.dithering}set dithering(o){this.copyMaterial.dithering=o}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(o){this.blurMaterial.kernelSize=o}get width(){return this.resolution.width}set width(o){this.resolution.preferredWidth=o}get height(){return this.resolution.height}set height(o){this.resolution.preferredHeight=o}get scale(){return this.blurMaterial.scale}set scale(o){this.blurMaterial.scale=o}getScale(){return this.blurMaterial.scale}setScale(o){this.blurMaterial.scale=o}getKernelSize(){return this.kernelSize}setKernelSize(o){this.kernelSize=o}getResolutionScale(){return this.resolution.scale}setResolutionScale(o){this.resolution.scale=o}render(o,e,t,i,n){const s=this.scene,r=this.camera,a=this.renderTargetA,c=this.renderTargetB,h=this.blurMaterial,d=h.kernelSequence;let l=e;this.fullscreenMaterial=h;for(let A=0,u=d.length;A<u;++A){const f=(A&1)===0?a:c;h.kernel=d[A],h.inputBuffer=l.texture,o.setRenderTarget(f),o.render(s,r),l=f}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=l.texture,o.setRenderTarget(this.renderToScreen?null:t),o.render(s,r)}setSize(o,e){const t=this.resolution;t.setBaseSize(o,e);const i=t.width,n=t.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(o,e)}initialize(o,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==gt?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):o!==null&&o.outputColorSpace===St&&(this.renderTargetA.texture.colorSpace=St,this.renderTargetB.texture.colorSpace=St))}static get AUTO_SIZE(){return Hi.AUTO_SIZE}},ny=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,sy=class extends Qt{constructor(o=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:El.replace(/\D+/g,"")},uniforms:{inputBuffer:new Xe(null),threshold:new Xe(0),smoothing:new Xe(1),range:new Xe(null)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ny,vertexShader:gd}),this.colorOutput=o,this.luminanceRange=e}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}get threshold(){return this.uniforms.threshold.value}set threshold(o){this.smoothing>0||o>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=o}getThreshold(){return this.threshold}setThreshold(o){this.threshold=o}get smoothing(){return this.uniforms.smoothing.value}set smoothing(o){this.threshold>0||o>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=o}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(o){this.smoothing=o}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(o){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(o){o?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(o){return this.colorOutput}setColorOutputEnabled(o){this.colorOutput=o}get useRange(){return this.luminanceRange!==null}set useRange(o){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(o){o!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=o,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(o){this.luminanceRange=o}},ry=class extends bi{constructor({renderTarget:o,luminanceRange:e,colorOutput:t,resolutionScale:i=1,width:n=Hi.AUTO_SIZE,height:s=Hi.AUTO_SIZE,resolutionX:r=n,resolutionY:a=s}={}){super("LuminancePass"),this.fullscreenMaterial=new sy(t,e),this.needsSwap=!1,this.renderTarget=o,this.renderTarget===void 0&&(this.renderTarget=new Bi(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new Hi(this,r,a,i);c.addEventListener("change",h=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(o,e,t,i,n){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,o.setRenderTarget(this.renderToScreen?null:this.renderTarget),o.render(this.scene,this.camera)}setSize(o,e){const t=this.resolution;t.setBaseSize(o,e),this.renderTarget.setSize(t.width,t.height)}initialize(o,e,t){t!==void 0&&t!==gt&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},oy=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,ay="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",ly=class extends Qt{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Xe(null),texelSize:new Xe(new Ce)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:oy,vertexShader:ay})}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setSize(o,e){this.uniforms.texelSize.value.set(1/o,1/e)}},cy=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Ay="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",hy=class extends Qt{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Xe(null),supportBuffer:new Xe(null),texelSize:new Xe(new Ce),radius:new Xe(.85)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:cy,vertexShader:Ay})}set inputBuffer(o){this.uniforms.inputBuffer.value=o}set supportBuffer(o){this.uniforms.supportBuffer.value=o}get radius(){return this.uniforms.radius.value}set radius(o){this.uniforms.radius.value=o}setSize(o,e){this.uniforms.texelSize.value.set(1/o,1/e)}},uy=class extends bi{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Bi(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new ly,this.upsamplingMaterial=new hy,this.resolution=new Ce}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(o){if(this.levels!==o){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<o;++t){const i=e.clone();i.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(i)}this.upsamplingMipmaps.push(e);for(let t=1,i=o-1;t<i;++t){const n=e.clone();n.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(n)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(o){this.upsamplingMaterial.radius=o}render(o,e,t,i,n){const{scene:s,camera:r}=this,{downsamplingMaterial:a,upsamplingMaterial:c}=this,{downsamplingMipmaps:h,upsamplingMipmaps:d}=this;let l=e;this.fullscreenMaterial=a;for(let A=0,u=h.length;A<u;++A){const f=h[A];a.setSize(l.width,l.height),a.inputBuffer=l.texture,o.setRenderTarget(f),o.render(s,r),l=f}this.fullscreenMaterial=c;for(let A=d.length-1;A>=0;--A){const u=d[A];c.setSize(l.width,l.height),c.inputBuffer=l.texture,c.supportBuffer=h[A].texture,o.setRenderTarget(u),o.render(s,r),l=u}}setSize(o,e){const t=this.resolution;t.set(o,e);let i=t.width,n=t.height;for(let s=0,r=this.downsamplingMipmaps.length;s<r;++s)i=Math.round(i*.5),n=Math.round(n*.5),this.downsamplingMipmaps[s].setSize(i,n),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(i,n)}initialize(o,e,t){if(t!==void 0){const i=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const n of i)n.texture.type=t;if(t!==gt)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(o!==null&&o.outputColorSpace===St)for(const n of i)n.texture.colorSpace=St}}dispose(){super.dispose();for(const o of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))o.dispose()}},dy=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,fy=class extends jB{constructor({blendFunction:o=De.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:t=.025,mipmapBlur:i=!1,intensity:n=1,radius:s=.85,levels:r=8,kernelSize:a=ec.LARGE,resolutionScale:c=.5,width:h=Hi.AUTO_SIZE,height:d=Hi.AUTO_SIZE,resolutionX:l=h,resolutionY:A=d}={}){super("BloomEffect",dy,{blendFunction:o,uniforms:new Map([["map",new Xe(null)],["intensity",new Xe(n)]])}),this.renderTarget=new Bi(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new iy({kernelSize:a}),this.luminancePass=new ry({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new uy,this.mipmapBlurPass.enabled=i,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=r,this.uniforms.get("map").value=i?this.mipmapBlurPass.texture:this.renderTarget.texture;const u=this.resolution=new Hi(this,l,A,c);u.addEventListener("change",f=>this.setSize(u.baseWidth,u.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(o){this.resolution.preferredWidth=o}get height(){return this.resolution.height}set height(o){this.resolution.preferredHeight=o}get dithering(){return this.blurPass.dithering}set dithering(o){this.blurPass.dithering=o}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(o){this.blurPass.kernelSize=o}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(o){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(o){this.uniforms.get("intensity").value=o}getIntensity(){return this.intensity}setIntensity(o){this.intensity=o}getResolutionScale(){return this.resolution.scale}setResolutionScale(o){this.resolution.scale=o}update(o,e,t){const i=this.renderTarget,n=this.luminancePass;n.enabled?(n.render(o,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(o,n.renderTarget):this.blurPass.render(o,n.renderTarget,i)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(o,e):this.blurPass.render(o,e,i)}setSize(o,e){const t=this.resolution;t.setBaseSize(o,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(o,e),this.mipmapBlurPass.setSize(o,e)}initialize(o,e,t){this.blurPass.initialize(o,e,t),this.luminancePass.initialize(o,e,t),this.mipmapBlurPass.initialize(o,e,t),t!==void 0&&(this.renderTarget.texture.type=t,o!==null&&o.outputColorSpace===St&&(this.renderTarget.texture.colorSpace=St))}},py=class extends bi{constructor(o,e,t=null){super("RenderPass",o,e),this.needsSwap=!1,this.clearPass=new vd,this.overrideMaterialManager=t===null?null:new HA(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(o){this.scene=o}set mainCamera(o){this.camera=o}get renderToScreen(){return super.renderToScreen}set renderToScreen(o){super.renderToScreen=o,this.clearPass.renderToScreen=o}get overrideMaterial(){const o=this.overrideMaterialManager;return o!==null?o.material:null}set overrideMaterial(o){const e=this.overrideMaterialManager;o!==null?e!==null?e.setMaterial(o):this.overrideMaterialManager=new HA(o):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(o){this.overrideMaterial=o}get clear(){return this.clearPass.enabled}set clear(o){this.clearPass.enabled=o}getSelection(){return this.selection}setSelection(o){this.selection=o}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(o){this.ignoreBackground=o}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(o){this.skipShadowMapUpdate=o}getClearPass(){return this.clearPass}render(o,e,t,i,n){const s=this.scene,r=this.camera,a=this.selection,c=r.layers.mask,h=s.background,d=o.shadowMap.autoUpdate,l=this.renderToScreen?null:e;a!==null&&r.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(o.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(o,e),o.setRenderTarget(l),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(o,s,r):o.render(s,r),r.layers.mask=c,s.background=h,o.shadowMap.autoUpdate=d}},gy=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,my="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",vy=class extends Qt{constructor(o,e,t,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:El.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Xe(null),depthBuffer:new Xe(null),resolution:new Xe(new Ce),texelSize:new Xe(new Ce),cameraNear:new Xe(.3),cameraFar:new Xe(1e3),aspect:new Xe(1),time:new Xe(0)},blending:Fs,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:n}),o&&this.setShaderParts(o),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(i)}set inputBuffer(o){this.uniforms.inputBuffer.value=o}setInputBuffer(o){this.uniforms.inputBuffer.value=o}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(o){this.uniforms.depthBuffer.value=o}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(o){this.defines.DEPTH_PACKING=o.toFixed(0),this.needsUpdate=!0}setDepthBuffer(o,e=So){this.depthBuffer=o,this.depthPacking=e}setShaderData(o){this.setShaderParts(o.shaderParts),this.setDefines(o.defines),this.setUniforms(o.uniforms),this.setExtensions(o.extensions)}setShaderParts(o){return this.fragmentShader=gy.replace(Ge.FRAGMENT_HEAD,o.get(Ge.FRAGMENT_HEAD)||"").replace(Ge.FRAGMENT_MAIN_UV,o.get(Ge.FRAGMENT_MAIN_UV)||"").replace(Ge.FRAGMENT_MAIN_IMAGE,o.get(Ge.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=my.replace(Ge.VERTEX_HEAD,o.get(Ge.VERTEX_HEAD)||"").replace(Ge.VERTEX_MAIN_SUPPORT,o.get(Ge.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(o){for(const e of o.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(o){for(const e of o.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(o){this.extensions={};for(const e of o)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(o){this.encodeOutput!==o&&(o?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(o){return this.encodeOutput}setOutputEncodingEnabled(o){this.encodeOutput=o}get time(){return this.uniforms.time.value}set time(o){this.uniforms.time.value=o}setDeltaTime(o){this.uniforms.time.value+=o}adoptCameraSettings(o){this.copyCameraSettings(o)}copyCameraSettings(o){o&&(this.uniforms.cameraNear.value=o.near,this.uniforms.cameraFar.value=o.far,o instanceof rn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(o,e){const t=this.uniforms;t.resolution.value.set(o,e),t.texelSize.value.set(1/o,1/e),t.aspect.value=o/e}static get Section(){return Ge}};function zA(o,e,t){for(const i of e){const n="$1"+o+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const r of t.entries())r[1]!==null&&t.set(r[0],r[1].replace(s,n))}}function _y(o,e,t){let i=e.getFragmentShader(),n=e.getVertexShader();const s=i!==void 0&&/mainImage/.test(i),r=i!==void 0&&/mainUv/.test(i);if(t.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(r&&(t.attributes&$n.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!r)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=t.shaderParts;let h=c.get(Ge.FRAGMENT_HEAD)||"",d=c.get(Ge.FRAGMENT_MAIN_UV)||"",l=c.get(Ge.FRAGMENT_MAIN_IMAGE)||"",A=c.get(Ge.VERTEX_HEAD)||"",u=c.get(Ge.VERTEX_MAIN_SUPPORT)||"";const f=new Set,p=new Set;if(r&&(d+=`	${o}MainUv(UV);
`,t.uvTransformation=!0),n!==null&&/mainSupport/.test(n)){const v=/mainSupport *\([\w\s]*?uv\s*?\)/.test(n);u+=`	${o}MainSupport(`,u+=v?`vUv);
`:`);
`;for(const C of n.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const E of C[1].split(/\s*,\s*/))t.varyings.add(E),f.add(E),p.add(E);for(const C of n.matchAll(a))p.add(C[1])}for(const v of i.matchAll(a))p.add(v[1]);for(const v of e.defines.keys())p.add(v.replace(/\([\w\s,]*\)/g,""));for(const v of e.uniforms.keys())p.add(v);p.delete("while"),p.delete("for"),p.delete("if"),e.uniforms.forEach((v,C)=>t.uniforms.set(o+C.charAt(0).toUpperCase()+C.slice(1),v)),e.defines.forEach((v,C)=>t.defines.set(o+C.charAt(0).toUpperCase()+C.slice(1),v));const m=new Map([["fragment",i],["vertex",n]]);zA(o,p,t.defines),zA(o,p,m),i=m.get("fragment"),n=m.get("vertex");const g=e.blendMode;if(t.blendModes.set(g.blendFunction,g),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(l+=e.inputColorSpace===St?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==sh?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;l+=`${o}MainImage(color0, UV, `,(t.attributes&$n.DEPTH)!==0&&v.test(i)&&(l+="depth, ",t.readDepth=!0),l+=`color1);
	`;const C=o+"BlendOpacity";t.uniforms.set(C,g.opacity),l+=`color0 = blend${g.blendFunction}(color0, color1, ${C});

	`,h+=`uniform float ${C};

`}if(h+=i+`
`,n!==null&&(A+=n+`
`),c.set(Ge.FRAGMENT_HEAD,h),c.set(Ge.FRAGMENT_MAIN_UV,d),c.set(Ge.FRAGMENT_MAIN_IMAGE,l),c.set(Ge.VERTEX_HEAD,A),c.set(Ge.VERTEX_MAIN_SUPPORT,u),e.extensions!==null)for(const v of e.extensions)t.extensions.add(v)}}var Cy=class extends bi{constructor(o,...e){super("EffectPass"),this.fullscreenMaterial=new vy(null,null,null,o),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(o){for(const e of this.effects)e.mainScene=o}set mainCamera(o){this.fullscreenMaterial.copyCameraSettings(o);for(const e of this.effects)e.mainCamera=o}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(o){this.fullscreenMaterial.encodeOutput=o}get dithering(){return this.fullscreenMaterial.dithering}set dithering(o){const e=this.fullscreenMaterial;e.dithering=o,e.needsUpdate=!0}setEffects(o){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=o.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const o=new gB;let e=0;for(const r of this.effects)if(r.blendMode.blendFunction===De.DST)o.attributes|=r.getAttributes()&$n.DEPTH;else{if((o.attributes&r.getAttributes()&$n.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${r.name})`);_y("e"+e++,r,o)}let t=o.shaderParts.get(Ge.FRAGMENT_HEAD),i=o.shaderParts.get(Ge.FRAGMENT_MAIN_IMAGE),n=o.shaderParts.get(Ge.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const r of o.blendModes.values())t+=r.getShaderCode().replace(s,`blend${r.blendFunction}`)+`
`;(o.attributes&$n.DEPTH)!==0?(o.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,o.colorSpace===St&&(i+=`color0 = sRGBToLinear(color0);
	`),o.uvTransformation?(n=`vec2 transformedUv = vUv;
`+n,o.defines.set("UV","transformedUv")):o.defines.set("UV","vUv"),o.shaderParts.set(Ge.FRAGMENT_HEAD,t),o.shaderParts.set(Ge.FRAGMENT_MAIN_IMAGE,i),o.shaderParts.set(Ge.FRAGMENT_MAIN_UV,n);for(const[r,a]of o.shaderParts)a!==null&&o.shaderParts.set(r,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(o)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(o,e=So){this.fullscreenMaterial.depthBuffer=o,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(o,e)}render(o,e,t,i,n){for(const s of this.effects)s.update(o,e,i);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i*this.timeScale,o.setRenderTarget(this.renderToScreen?null:t),o.render(this.scene,this.camera)}}setSize(o,e){this.fullscreenMaterial.setSize(o,e);for(const t of this.effects)t.setSize(o,e)}initialize(o,e,t){this.renderer=o;for(const i of this.effects)i.initialize(o,e,t);this.updateMaterial(),t!==void 0&&t!==gt&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const o of this.effects)o.removeEventListener("change",this.listener),o.dispose()}handleEvent(o){switch(o.type){case"change":this.recompile();break}}};class Ey extends xt{constructor(t){super(t);N(this,"params");N(this,"bloom");this.params={};const i=new pB(this.base.renderer,{multisampling:8});this.base.composer=i,i.addPass(new py(this.base.scene,this.base.camera));const n=new fy({blendFunction:De.ADD,mipmapBlur:!0,luminanceThreshold:0,luminanceSmoothing:this.base.params.bloomLuminanceSmoothing});this.bloom=n;const s=new Cy(this.base.camera,n);i.addPass(s)}setLuminanceSmoothing(t){this.bloom.luminanceMaterial.smoothing=t}setIntensity(t){this.bloom.intensity=t}}class By extends uC{constructor(t=".container"){super(t,{autoAdaptMobile:!0});N(this,"dynamicEnv");N(this,"startRoom");N(this,"car");N(this,"furina");N(this,"speedup");N(this,"environment");N(this,"cameraShake");N(this,"bgm");N(this,"am");N(this,"post");N(this,"controls");N(this,"debug");N(this,"stats");N(this,"params");N(this,"t1",pi.timeline());N(this,"t2",pi.timeline());N(this,"t3",pi.timeline());N(this,"t4",pi.timeline());N(this,"t5",pi.timeline());N(this,"t6",pi.timeline());N(this,"t7",pi.timeline());N(this,"t8",pi.timeline());N(this,"t9",pi.timeline());window.world=this,this.params={bloomIntensity:1,bloomLuminanceSmoothing:1.6,cameraFov:33.4,cameraPos:{x:0,y:.8,z:-11},cameraShakeIntensity:0,carBodyColor:2545385,carBodyEnvIntensity:1,disableInteract:!1,envIntensity:0,envWeight:0,floorLerpColor:0,furinaLerpColor:0,isCameraMoving:!1,isRushing:!1,lightAlpha:0,lightIntensity:0,lightOpacity:1,startRoomReflector:!0,reflectIntensity:0,speed:0,speedUpOpacity:0,isFurina:!1},this.renderer.toneMapping=Of,this.scene.background=new Te(0);const i=this.camera;i.fov=this.params.cameraFov,i.updateProjectionMatrix();const n=new xe(this.params.cameraPos.x,this.params.cameraPos.y,this.params.cameraPos.z);i.position.copy(n);const s=new xe(0,.8,0);i.lookAt(s);const r=new gC(this);r.controls.setTarget(s.x,s.y,s.z),this.controls=r,this.initHelpers(),this.am=new z_(this,aB,{useMeshoptDecoder:!0}),this.am.on("ready",()=>{this.initWorld()}),this.post=new Ey(this),this.update(()=>{this.params.isCameraMoving?(this.controls.controls.enabled=!1,this.controls.controls.setPosition(this.params.cameraPos.x,this.params.cameraPos.y,this.params.cameraPos.z)):this.controls.controls.enabled=!0})}initWorld(){this.handleAssets(),this.dynamicEnv=new XE(this),this.scene.environment=this.dynamicEnv.envmap,this.startRoom=new $E(this),this.startRoom.addExisting(),this.car=new eB(this),this.car.addExisting(),this.furina=new oB(this),this.furina.addExisting(),this.speedup=new nB(this),this.speedup.addExisting(),this.environment=new mC(this,{resolution:512,scene:this.scene,options:{minFilter:Lf,anisotropy:0,depthBuffer:!1,generateMipmaps:!0},textureType:gt,ignoreObjects:[this.car.model.scene]}),this.cameraShake=new rB(this),this.cameraShake.setIntensity(0),this.interactionManager.add(this.car.model.scene),this.car.model.scene.addEventListener("click",()=>{this.rush()}),kA.on("enter",()=>{this.params.disableInteract=!1}),this.enter(),this.bgm=new VE.Howl({src:"su7/audio/bgm.mp3",loop:!0,volume:.5}),this.bgm.play()}enter(){var s;this.params.disableInteract=!0,(s=document.querySelector(".loader-screen"))==null||s.classList.add("hollow"),this.t1.to(this.params.cameraPos,{x:0,y:.8,z:-7,duration:4,ease:"power2.inOut",onStart:()=>{this.params.isCameraMoving=!0},onComplete:()=>{this.params.isCameraMoving=!1,kA.emit("enter")}});const t=new Te,i=new Te(0),n=new Te(16777215);this.t2.to(this.params,{lightAlpha:1,lightIntensity:1,reflectIntensity:25,furinaLerpColor:1,delay:1,ease:"power2.inOut",onUpdate:()=>{var r;t.copy(i).lerp(n,this.params.lightAlpha),this.startRoom.lightMat.emissive.set(t),this.startRoom.lightMat.emissiveIntensity=this.params.lightIntensity,this.startRoom.customFloorMat.uniforms.uColor.value.set(t),this.startRoom.customFloorMat.uniforms.uReflectIntensity.value=this.params.reflectIntensity,(r=this.furina)==null||r.setColor(t)}}),this.t3.to(this.params,{envIntensity:1,duration:4,delay:.5,ease:"power2.inOut",onUpdate:()=>{this.dynamicEnv.setIntensity(this.params.envIntensity)}}).to(this.params,{envWeight:1,duration:4,ease:"power2.inOut",onUpdate:()=>{this.dynamicEnv.setWeight(this.params.envWeight)}},"-=2.5")}async rush(){var r;if(this.params.isRushing){this.rushDone();return}if(this.params.disableInteract)return;this.params.disableInteract=!0,this.clearAllTweens();const t=new Te,i=new Te(0),n=new Te,s=new Te(6710886);(r=this.furina)==null||r.drive(),this.t4.to(this.params,{speed:4,duration:2,ease:"power2.out",onComplete:()=>{this.params.isRushing=!0,this.params.disableInteract=!1}}).to(this.params,{speed:10,duration:4,ease:"power2.out"}),this.t5.to(this.params,{lightOpacity:0,duration:1,ease:"power2.out",onUpdate:()=>{this.startRoom.lightMat.opacity=this.params.lightOpacity}}),this.t6.fromTo(this.params,{floorLerpColor:0,furinaLerpColor:0},{floorLerpColor:1,furinaLerpColor:1,duration:4,ease:"none",onUpdate:()=>{var a;t.lerp(i,this.params.floorLerpColor),this.startRoom.customFloorMat.uniforms.uColor.value.set(t),n.lerp(s,this.params.furinaLerpColor),(a=this.furina)==null||a.setColor(n)}}),this.t7.to(this.params,{envIntensity:.01,duration:1,ease:"power2.out",onUpdate:()=>{this.dynamicEnv.setIntensity(this.params.envIntensity)}}),this.t8.to(this.params,{speedUpOpacity:1,cameraFov:36,duration:2,ease:"power2.out",onUpdate:()=>{this.speedup.material.uniforms.uOpacity.value=this.params.speedUpOpacity;const a=this.camera;a.fov=this.params.cameraFov,a.updateProjectionMatrix()}}),await G_(1e3),this.scene.environment=this.environment.texture,this.t9.to(this.params,{carBodyEnvIntensity:10,cameraShakeIntensity:1,bloomLuminanceSmoothing:.4,bloomIntensity:2,duration:4,ease:"power2.out",onUpdate:()=>{this.car.setBodyEnvIntensity(this.params.carBodyEnvIntensity),this.cameraShake.setIntensity(this.params.cameraShakeIntensity),this.post.setLuminanceSmoothing(this.params.bloomLuminanceSmoothing),this.post.setIntensity(this.params.bloomIntensity)}})}rushDone(){var a;if(this.params.disableInteract)return;this.params.disableInteract=!0,this.clearAllTweens();const t=new Te,i=new Te("#ffffff"),n=this.camera,s=new Te,r=new Te("#ffffff");(a=this.furina)==null||a.pause(),this.t4.to(this.params,{speed:0,duration:2,ease:"power2.out",onComplete:()=>{this.params.isRushing=!1,this.params.disableInteract=!1}}),this.t5.to(this.params,{lightOpacity:1,duration:1,ease:"power2.out",onUpdate:()=>{this.startRoom.lightMat.opacity=this.params.lightOpacity}}),this.t6.fromTo(this.params,{floorLerpColor:0,furinaLerpColor:0},{floorLerpColor:1,furinaLerpColor:1,duration:4,ease:"none",onUpdate:()=>{var c;t.lerp(i,this.params.floorLerpColor),this.startRoom.customFloorMat.uniforms.uColor.value.set(t),s.lerp(r,this.params.furinaLerpColor),(c=this.furina)==null||c.setColor(s)}}),this.t7.to(this.params,{envIntensity:1,duration:1,ease:"power2.out",onUpdate:()=>{this.dynamicEnv.setIntensity(this.params.envIntensity)}}),this.t8.to(this.params,{speedUpOpacity:0,cameraFov:33.4,duration:2,ease:"power2.out",onUpdate:()=>{this.speedup.material.uniforms.uOpacity.value=this.params.speedUpOpacity,n.fov=this.params.cameraFov,n.updateProjectionMatrix()}}),this.t9.to(this.params,{carBodyEnvIntensity:1,cameraShakeIntensity:0,bloomLuminanceSmoothing:1.6,bloomIntensity:1,duration:4,ease:"power2.out",onUpdate:()=>{this.car.setBodyEnvIntensity(this.params.carBodyEnvIntensity),this.cameraShake.setIntensity(this.params.cameraShakeIntensity),this.post.setLuminanceSmoothing(this.params.bloomLuminanceSmoothing),this.post.setIntensity(this.params.bloomIntensity)}}),this.scene.environment=this.dynamicEnv.envmap}handleAssets(){const t=this.am.items.ut_car_body_ao;t.flipY=!1,t.colorSpace=Hn,t.minFilter=es,t.magFilter=es,t.channel=1;const i=this.am.items.ut_startroom_ao;i.flipY=!1,i.colorSpace=Hn,i.channel=1;const n=this.am.items.ut_startroom_light;n.flipY=!1,n.colorSpace=St,n.channel=1;const s=this.am.items.ut_floor_normal;s.flipY=!1,s.colorSpace=Hn,s.wrapS=nn,s.wrapT=nn;const r=this.am.items.ut_floor_roughness;r.flipY=!1,r.colorSpace=Hn,r.wrapS=nn,r.wrapT=nn;const a=this.am.items.decal;a.flipY=!1,a.colorSpace=Hn}clearAllTweens(){this.t1.clear(),this.t2.clear(),this.t3.clear(),this.t4.clear(),this.t5.clear(),this.t6.clear(),this.t7.clear(),this.t8.clear(),this.t9.clear()}initHelpers(){this.stats=new hC(this),this.debug=new $l}}const yy={class:"container"},by=Pf({__name:"index",setup(o){return Gf(()=>{new By(".container"),document.title="SU7 - Three.js"}),(e,t)=>(Nf(),Uf("div",yy,t[0]||(t[0]=[kf('<div class="loader-screen"><div class="loading-container"><div class="loading"><span style="--i:0;">L</span><span style="--i:1;">O</span><span style="--i:2;">A</span><span style="--i:3;">D</span><span style="--i:4;">I</span><span style="--i:5;">N</span><span style="--i:6;">G</span></div></div></div>',1)])))}});export{by as default};
