import{S as ne,F as oe,V as M,T as g,k as G,B as ae,n as x,p as se,e as y,m as F,q as re,l as ie,G as le,r as H,f as ce,s as de,g as pe,t as U,h as me,C as ue,u as he,A as we,a as ge,b as fe,P as Se,W as be,v as Me,i as ye}from"./three.module-DmlE-t8v.js";import{O as ve}from"./OrbitControls--HqJHdGn.js";import{d as _e,r as Ce,o as Pe,c as xe,f as He}from"./index-DizvUXn5.js";const Fe=_e({__name:"demo3",setup(Ae){const A=Ce();let a,i,m,p=1400,v,u,f,B=[],z,S,b,T,_,L,k,j,R,E,D,d,l;const V=()=>{const e=i/2/Math.tan(Math.PI/12);u=Math.floor(e-p/2),a=new ne,a.fog=new oe(0,0,1e4),Z(),N(),_=-u-p/2,S=_,b=_*2,T=O(S),L=O(b),k=W([new M(-i/10,0,-p/2),new M(-i/4,m/8,0),new M(-i/4,0,u)],400,200),j=W([new M(i/8,m/8,-p/2),new M(i/8,m/8,u)],200,100),R=q(k,2e-4),E=q(j,8e-4,.001),D=J()},Z=()=>{new g().load("/threejs-demo/demo3/images/sky.png",e=>{e.colorSpace=G;const t=new ae(i,m,p),o=new x({map:e,side:se}),n=new y(t,o);a.add(n)}),new g().load("/threejs-demo/demo3/images/ground.png",e=>{e.colorSpace=G;const t=new F(i,400),o=new x({map:e,transparent:!0}),n=new y(t,o);n.position.set(0,-200,0),a.add(n)})},N=()=>{new g().load("/threejs-demo/demo3/images/earth_bg.png",e=>{const t=new re(50,64,32),o=new ie({map:e,blendDstAlpha:1}),n=new y(t,o);f=new le,f.position.set(-400,200,-200),f.add(n),a.add(f)})},O=(e,t=50)=>{z=[{color:[.6,1,.75],sprite:new g().load("/threejs-demo/demo3/images/starflake1.png"),size:50},{color:[0,0,1],sprite:new g().load("/threejs-demo/demo3/images/starflake2.png"),size:20}];const o=[];for(let r=0;r<t;r++){const C=H.randFloatSpread(i),P=Math.random()*m*.5,h=H.randFloatSpread(p*.5)+(u-p*.25);o.push(C,P,h)}const n=new ce;n.setAttribute("position",new de(o,3)),n.computeBoundingSphere();const c=[],s={x:H.randFloatSpread(.3),y:H.randFloatSpread(.3),z:H.randFloatSpread(.3)};return z.forEach(({color:r,sprite:C,size:P},h)=>{B[h]=new pe({size:P,map:C,blending:U,depthTest:!0,transparent:!0,alphaTest:.01}),B[h].color.setHSL(...r);const w=new me(n,B[h]);w.rotation.set(s.x,s.y,s.z),w.position.z=e,c.push(w),a.add(w)}),c},Y=()=>{const e=Date.now()*5e-5;S+=1,b+=1,S>=u+p/2&&(S=_),b>=u+p/2&&(b=_*2),T.forEach(t=>{t.position.setZ(S)}),L.forEach(t=>{t.position.setZ(b)}),B.forEach((t,o)=>{const[n,c,s]=z[o].color,r=(n+e)%1;t.color.setHSL(r,c,s)})},W=(e,t,o)=>{const n=new ue(e,!1),c=new he(n,100,2,50,!1),s=new x({opacity:0,transparent:!0}),r=new y(c,s);a.add(r);const C=new F(t,o),P=new g().load("/threejs-demo/demo3/images/cloud.png"),h=new x({map:P,blending:U,depthTest:!1,transparent:!0}),w=new y(C,h);return a.add(w),{cloud:w,curve:n}},q=(e,t,o=6e-4,n=1,c=0)=>{let s=0;return()=>{if(c<n&&(c+=o,e.cloud.scale.setScalar(c)),s>1)s=0,c=0;else if(s+=t,e.curve){const r=e.curve.getPoint(s);r&&r.x&&e.cloud.position.set(r.x,r.y,r.z)}}},J=()=>{const e=new g().load("/threejs-demo/demo3/images/login_human.png");e.colorSpace=G;const t=new F(154,190),o=new x({map:e,transparent:!0,alphaTest:.01}),n=new y(t,o);return n.position.set(150,150,0),a.add(n),()=>{const s=Date.now()*.001;n.position.y=Math.sin(s)*20+130}},K=()=>{const e=new we(16777215,1);a.add(e);const t=new ge(415229,5,0);t.position.set(0,100,-200),a.add(t);const o=new fe(t,20);o.visible=!1,a.add(o)},Q=()=>{v=new Se(15,i/m,1,3e4),v.position.set(0,0,u),v.lookAt(new M(0,0,0))},X=()=>{d=new be({antialias:!0,alpha:!0}),d.setSize(i,m),d.shadowMap.enabled=!0,d.shadowMap.type=Me,d.setPixelRatio(window.devicePixelRatio),d.setClearColor(0,.5),d.outputColorSpace=G,A.value.appendChild(d.domElement)},$=()=>{l=new ve(v,d.domElement),l.enableDamping=!0,l.dampingFactor=.05,l.screenSpacePanning=!1,l.maxPolarAngle=Math.PI,l.target.set(0,0,0),l.enabled=!1,l.update()},ee=()=>{const e=new ye(2e3);e.visible=!1,a.add(e)},te=()=>{$(),ee()},I=()=>{requestAnimationFrame(I),l!=null&&l.enableDamping&&l.update(),f&&f.rotateY(.001),Y(),R(),E(),D(),d.render(a,v)};return Pe(()=>{var e,t;i=(e=A.value)==null?void 0:e.clientWidth,m=(t=A.value)==null?void 0:t.clientHeight,V(),K(),Q(),X(),te(),I(),document.title="登录 - Three.js"}),(e,t)=>(He(),xe("div",{ref_key:"container",ref:A,class:"container"},null,512))}});export{Fe as default};
